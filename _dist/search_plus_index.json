{"./":{"url":"./","title":"前言","keywords":"","body":"个人主页 主页地址：[https://www.wdg.pub/](https://www.wdg.pub/) --> 主要是个人学习、工作经验的总结，不断完善中··· 如果存在错误，或者有好的建议还请多指教，提交反馈 个人GitHub地址：https://github.com/jekorx个人Npm地址：https://www.npmjs.com/~jekorx 1、[cnode-react](https://github.com/jekorx/cnode-react)，是CNodejs移动webapp react实现，可在[CNodejs社区](https://cnodejs.org)注册账号，使用AccessToken登录，[点此查看演示](https://jekorx.github.io/cnode-react)，请使用移动网页模式查看，由于路由是history模式（无法配置github web服务器），在非 / 根目录刷新会404 > 2、[vue-carousel-card](https://github.com/jekorx/vue-carousel-card)，vue轮播，[点此查看演示](https://jekorx.github.io/vue-carousel-card/) > 3、[particle-wave](https://github.com/jekorx/particle-wave)，WebGL粒子波浪效果，[点此查看演示](https://jekorx.github.io/particle-wave/) > 4、[bio](https://github.com/jekorx/bio)，vue个人简历模版，[点此查看演示](https://jekorx.github.io/bio/) > 5、gallery-by-react，react画廊，[点此查看演示](https://jekorx.github.io/gallery-by-react/) --> Thanks for © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-08-26 "},"index/nodejs.html":{"url":"index/nodejs.html","title":"Node.js","keywords":"","body":"Node.js 主要是基于Node.js一些常用工具的介绍，基本用法总结。 Npm Yarn PM2 Http-Server © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"nodejs/npm.html":{"url":"nodejs/npm.html","title":"Npm","keywords":"","body":"Npm 设置淘宝镜像源 # 解决npm或者某些依赖于npm的命令（gitbook等）安装依赖慢的问题 # 如果使用后gitbook安装慢，尝试删除该设置，使用上网工具 npm config set registry=http://registry.npm.taobao.org # 解决node-sass安装失败的问题 npm config set sass_binary_site=https://npm.taobao.org/mirrors/node-sass 版本 # 版本号 # .. x.y.z # 修复bug，小改动，增加z # 增加新特性，可向后兼容，增加y # 有很大的改动，无法向下兼容，增加x # 大于等于修补版本号 # 如：~1.2.3，表示从>=1.2.3到=2.3.4到1.1.2，表示必须大于1.1.2版 >version # 可大于或等于某个版本 # 如：>=1.1.2，表示可以等于1.1.2，也可以大于1.1.2版本 >=version # 必须小于某个版本 # 如：=0.0.0的任意版本 * # 大于等于version1，小于等于version2 # 如：1.1.2 - 1.3.1，表示包括1.1.2和1.3.1以及他们件的任意版本 version1 - version2 # 满足range1或者满足range2，可以多个范围 # 如：=2.3.1 =2.5.2 发布npm包 1、注册npm帐号，点击前往npm官网2、登录npm帐号 # 根据提示输入创建的账号、密码和邮箱 npm login 3、发布包，.gitignore或.npmignore中的文件将会被忽略版本更新时，需要提升版本号 npm publish 4、撤销发布删除npm市场的包同名的24小时后才能重新发布 # 删除某个版本 npm unpublish @ # 删除整个npm市场的包 npm unpublish --force # 不删除，安装时会提示，版本号可忽略 # 如：npm deprecate '这个包已经不再维护了' npm deprecate [@] linux npm 全局安装权限不足的问题 一般非root用户操作会出现该问题 Windows系统：1、通常是因为项目位置导致，如：电脑桌面的项目；2、需要以管理员身份运行命令行工具。 # 相关报错信息 error code EACCES error syscall access error path /usr/local/lib/nodejs/node-v12.16.2-linux-x64/lib/node_modules error errno -13 error Error: EACCES: permission denied, access '/usr/local/lib/nodejs/node-v12.16.2-linux-x64/lib/node_modules' error [Error: EACCES: permission denied, access '/usr/local/lib/nodejs/node-v12.16.2-linux-x64/lib/node_modules'] { error stack: \"Error: EACCES: permission denied, access '/usr/local/lib/nodejs/node-v12.16.2-linux-x64/lib/node_modules'\", error errno: -13, error code: 'EACCES', error syscall: 'access', error path: '/usr/local/lib/nodejs/node-v12.16.2-linux-x64/lib/node_modules' error } error The operation was rejected by your operating system. error It is likely you do not have the permissions to access this file as the current user error error If you believe this might be a permissions issue, please double-check the error permissions of the file and its containing directories, or try running error the command again as root/Administrator. 解决方法 # 1、在命令行的主目录中，为全局安装创建目录： mkdir ~/.npm-global # 2、配置npm以使用新的目录路径： npm config set prefix '~/.npm-global' # 3、打开或创建一个 ~/.bash_profile 文件并添加以下行： export PATH=$PATH:~/.npm-global/bin # 4、在命令行上，更新系统变量： source ~/.bash_profile # 5、要测试新配置，请在不使用的情况下全局安装软件包sudo： npm install -g yarn # 可以使用相应的ENV变量代替步骤1-3（例如，如果您不想修改~/.bash_profile NPM_CONFIG_PREFIX=~/.npm-global # npm 5.2或更高版本，则可能要考虑将npx作为运行全局命令的替代方法 npx node-sass安装失败的问题 win10环境 Error: Can't find Python executable \"python\", you can set the PYTHON env variable. 解决方法 # node-gyp npm install -g node-gyp # 用管理员权限打开命令行执行 npm install --global --production windows-build-tools # 该命令会安装 # 1、python(v2.7，3.x不支持) # 2、visual C++ Build Tools，或者 （vs2015以上（包含15）） # 3、.net framework 4.5.1 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"nodejs/yarn.html":{"url":"nodejs/yarn.html","title":"Yarn","keywords":"","body":"yarn 快速、可靠、安全的依赖管理工具。比npm好用 0_0 安装 # 使用npm安装 npm i -g yarn # 使用npm升级yarn npm update -g yarn 相关问题及解决方案 # 可能会安装失败，原因基本都是权限问题 # MacOS / Linux sudo npm i -g yarn # windows可以使用管理员权限启动的命令行 # 检查 yarn -v # 如果出现找不到该命令的问题，需要配置全局环境变量 # 该问题多出现在windows系统 # 环境变量中增加npm安装的全局工具的路径 # windows C:\\Users\\\\AppData\\Roaming\\npm # yarn安装的全局工具不能用的问题 # 该问题多出现在windows系统 # 环境变量中增加yarn安装的全局工具的bin路径 # windows C:\\Users\\\\AppData\\Local\\Yarn\\bin 设置淘宝镜像源 # 解决安装依赖慢的问题 # 如果使用后gitbook安装慢，尝试删除该设置，使用上网工具 yarn config set registry https://registry.npm.taobao.org # 解决node-sass安装失败的问题 yarn config set sass_binary_site https://npm.taobao.org/mirrors/node-sass 常用命令 以安装react和http-server为例 npm yarn npm i yarn npm i react -S yarn add react npm uninstall react -S yarn remove react npm i react -D yarn add react -D npm update react -S yarn upgrade react npm i -g http-server yarn global add http-server npm update -g http-server yarn global upgrade http-server 注意：yarn全局安装关键字global必须跟在yarn关键字后面，否则会安装global © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"nodejs/process-manager.html":{"url":"nodejs/process-manager.html","title":"PM2","keywords":"","body":"PM2（Process Manager 2） Node进程管理工具，简化Node App管理的繁琐任务，如性能监控、自动重启、负载均衡等。 常用命令 # 启动app pm2 start yarn --name AppName -- start # 查看所有app pm2 list # or pm2 ls # 启动，all表示全部app，CMD表示命令（如：yarn），-i max 表示cluster模式，数量为最大cpu核数，--watch表示当文件变化时自动重启应用，args表示参数 pm2 start [id | AppName | all | CMD] --name [AppName] -i max --watch -- [args] # 停止，all表示全部app pm2 stop [id | AppName | all] # 重启，相当于先 stop 再 start，会导致服务短时间内无法使用，all表示全部app pm2 restart [id | AppName | all] # 热重载，多用于cluster模式，逐个重新启动所有进程，始终保持至少一个进程在运行，实现不停机重载 pm2 reload [AppName] # 删除，all表示全部app pm2 delete [id | AppName | all] # 监控 pm2 monit [id | AppName] # 日志 pm2 logs 常见错误 windows系统常见错误（1） # 报错信息 C:\\USERS\\\\APPDATA\\ROAMING\\NPM\\YARN.CMD:1 (function (exports, require, module, __filename, __dirname) { @IF EXIST \"%~dp0\\node.exe\" ( ^ SyntaxError: Invalid or unexpected token at new Script (vm.js:79:7) at createScript (vm.js:251:10) at Object.runInThisContext (vm.js:303:10) at Module._compile (internal/modules/cjs/loader.js:656:28) at Object.Module._extensions..js (internal/modules/cjs/loader.js:699:10) at Module.load (internal/modules/cjs/loader.js:598:32) at tryModuleLoad (internal/modules/cjs/loader.js:537:12) at Function.Module._load (internal/modules/cjs/loader.js:529:3) at Object. (C:\\Users\\\\AppData\\Local\\Yarn\\Data\\global\\node_modules\\pm2\\lib\\ProcessContainerFork.js:27:21) at Module._compile (internal/modules/cjs/loader.js:688:30) C:\\USERS\\\\APPDATA\\ROAMING\\NPM\\YARN.CMD:1 (function (exports, require, module, __filename, __dirname) { @IF EXIST \"%~dp0\\node.exe\" ( # 错误分析 在Windows上，yarn.cmd它不是有效的，您必须直接运行Node.js命令 # 解决方法 pm2 start C:\\Users\\\\AppData\\Roaming\\npm\\node_modules\\yarn\\bin\\yarn.js --name nuxt -- start © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"nodejs/http-server.html":{"url":"nodejs/http-server.html","title":"Http-Server","keywords":"","body":"http-server http-server是一个简单的，零配置的命令行http服务器。 安装 npm install http-server -g # or yarn global add http-server 使用 http-server [path] [options] 可用选项 -p 要使用的端口（默认为8080） -a 要使用的地址（默认为0.0.0.0） -d 显示目录列表（默认为'True'） -i 显示autoIndex（默认为'True'） -g或者--gzip当启用时（默认为'False'），它将./public/some-file.js.gz代替./public/some-file.js当文件的gzip压缩版本存在且请求接受gzip编码时。 -e或者--ext如果没有提供默认文件扩展名（默认为'html'） -s或者--silent从输出中抑制日志消息 --cors通过Access-Control-Allow-Origin标头启用CORS -o 启动服务器后打开浏览器窗口 -c设置缓存控制max-age标头的缓存时间（以秒为单位），例如-c10为10秒（默认为“3600”）。要禁用缓存，请使用-c-1。 -U或--utc在日志消息中使用UTC时间格式。 -P或者将--proxy所有无法在本地解析的请求代理到给定的URL。例如：-P http://someurl.com -S或--ssl启用https。 -C或--certssl cert文件的路径（默认值：cert.pem）。 -K或--keyssl密钥文件的路径（默认值：key.pem）。 -r或--robots提供/robots.txt（其内容默认为'User-agent：* \\ nDisisis：/'） -h或--help打印此列表并退出。 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"index/frontend.html":{"url":"index/frontend.html","title":"前端","keywords":"","body":"Web前端 前端相关使用总结。 Axios Html Css 移动端vw适配方案 Vue.js Create React App Vue Cli Js Utils 正则表达式 TypeScript ESLint Less Canvas 防抖节流 Webpack Nuxt.js 高德vue地图选择器 VueQuillEditor Chrome文件下载 代码片段收藏 JavaScript原型链 JavaScript异步执行顺序 JavaScript宏任务&微任务执行流程 宏任务 浏览器 Node I/O ✅ ✅ setTimeout ✅ ✅ setInterval ✅ ✅ setImmediate ❌ ✅ requestAnimationFrame ✅ ❌ 微任务 浏览器 Node Promise.prototype.then catch finally ✅ ✅ process.nextTick ❌ ✅ MutationObserver ✅ ❌ © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/axios.html":{"url":"frontend/axios.html","title":"Axios","keywords":"","body":"Axios Axios 是一个基于promise的HTTP库，可以用在浏览器和node.js中。 安装 yarn add axios # or npm i axios -S 基本使用 /** * 1、基础使用1 * axios(config) * 2、基础使用2，url不在配置中指定 * axios(url[, config]) * 3、默认请求方法别名 * 使用别名方法时，url、method、data 这些属性都不必在配置中指定。 * axios.request(config) * axios.get(url[, config]) * axios.delete(url[, config]) * axios.head(url[, config]) * axios.post(url[, data[, config]]) * axios.put(url[, data[, config]]) * axios.patch(url[, data[, config]]) * 4、并发 * axios.all(iterable) * axios.spread(callback) * 例： * let axiosList=[ * axios.get('url1', { params: 'xxx' }), * axios.get('url2', { params: 'xxx' }) * ] * axios.all(axiosList).then(axios.spread((res1, res2) => { * console.log(res1, res2) // 分别是两个请求的返回值 * }) * 5、创建实例 * axios.create([config]) */ /** * promise方式 */ function get () { // GET请求参数名必须是params，URL参数，可参考详细配置 axios.get('/user', { params: { ID: '12345' } }) .then(res => { console.log(res) }) .catch(err => { console.log(err) }) } function post () { axios.post('/user', { firstName: 'Fred', lastName: 'Flintstone' }) .then(res => { console.log(res) }) .catch(err => { console.log(err) }) } /** * async/await方式 */ async function gets () { try { let data1 = await axios.get('url1', { params: 'xxx' }) let data2 = await axios.get('url2', { params: 'xxx' }) console.log(data1, data2) } catch (error) { console.log(error) } } 常用配置 import axios from 'axios' import qs from 'qs' /** * axios config */ // url 前缀 axios.defaults.baseURL = process.env.NODE_ENV === 'production' ? '/web/' : '/api/' // 跨域请求时携带cookie axios.defaults.withCredentials = true /** * axios 默认 Content-Type: application/json;charset=UTF-8 * 请求正文为Request Payload，格式是json格式的字符串，需要用 @RequestBody 方式接收参数 * * 如果后端使用 @RequestParam 方式接收，配置transformRequest，参数使用qs转换 * 请求头Content-Type会被设置为: Content-Type: application/x-www-form-urlencoded;charset=UTF-8 * 请求正文为Form Data，格式是key=value&key1=value2 * 后端接收对象参数，无需任何注解可自动转换接收 */ // 请求参数转转换，{ a: 123, b: 'str' } => a=123&b=str axios.defaults.transformRequest = [params => qs.stringify(params)] // 请求统一额外参数 axios.defaults.params = { apiuser: 'debug' } // 请求拦截器 axios.interceptors.request.use(config => { // 请求发出前，可以开始加载动画之类的操作 return config }, error => { // 请求发出错误处理 return Promise.reject(error) }) // 响应拦截器 axios.interceptors.response.use(response => { // 接收到响应处理，停止加载动画之类操作 // 只返回后端返回的结果，即：response.data return response.data }, error => { // 响应错误处理，统一异常处理 console.log(error.stack) return Promise.reject(error) }) 使用全局默认配置，特殊使用时配置 使用了上述全局配置之后，请求头Content-Type会被设置为: application/x-www-form-urlencoded 如果上传文件需要将Content-Type设置为multipart/form-data，具体使用如下所示 /** * 使用axios上传文件，ajax文件上传 */ // input(type=\"file\" onchange=\"fileChange\" multiple=\"multiple\") // 设置multiple可以选择多个文件 function fileChange (e) { // 获取文件对象数组 let files = e.target.files // 创建一个FormData，存储需要提交的表单数据，如果通过ajax方式上传文件，必须使用FormData let formData = new FormData() // 普通表单数据 formData.append('num', 123) formData.append('name', 'aa') // 文件数据 formData.append('file', files[0]) // 多个文件数据需要遍历放入 for (let f of files) { formData.append('files', f) } // 上传data必须转为formData axios.post('/upload', formData, { // 覆盖默认设置中的transformRequest设置 transformRequest: [(params, headers) => { // 请求头Content-Type 为multipart/form-data headers = { 'Content-Type': 'multipart/form-data' } // 取消qs参数转换 return params }], // 上传进度 onUploadProgress ({ loaded, total }) { let p = (loaded / total * 100).toFixed(0) + '%' console.log(p) } }).then(res => console.log(res)) } 详细配置 { // `url` 是用于请求的服务器 URL url: '/user', // `method` 是创建请求时使用的方法 method: 'get', // 默认是 get // `baseURL` 将自动加在 `url` 前面，除非 `url` 是一个绝对 URL。 // 它可以通过设置一个 `baseURL` 便于为 axios 实例的方法传递相对 URL baseURL: 'https://some-domain.com/api/', // `transformRequest` 允许在向服务器发送前，修改请求数据 // 只能用在 'PUT', 'POST' 和 'PATCH' 这几个请求方法 // 后面数组中的函数必须返回一个字符串，或 ArrayBuffer，或 Stream transformRequest: [function (data) { // 对 data 进行任意转换处理 return data; }], // `transformResponse` 在传递给 then/catch 前，允许修改响应数据 transformResponse: [function (data) { // 对 data 进行任意转换处理 return data; }], // `headers` 是即将被发送的自定义请求头 headers: {'X-Requested-With': 'XMLHttpRequest'}, // `params` 是即将与请求一起发送的 URL 参数 // 必须是一个无格式对象(plain object)或 URLSearchParams 对象 params: { ID: 12345 }, // `paramsSerializer` 是一个负责 `params` 序列化的函数 // (e.g. https://www.npmjs.com/package/qs, http://api.jquery.com/jquery.param/) paramsSerializer: function(params) { return Qs.stringify(params, {arrayFormat: 'brackets'}) }, // `data` 是作为请求主体被发送的数据 // 只适用于这些请求方法 'PUT', 'POST', 和 'PATCH' // 在没有设置 `transformRequest` 时，必须是以下类型之一： // - string, plain object, ArrayBuffer, ArrayBufferView, URLSearchParams // - 浏览器专属：FormData, File, Blob // - Node 专属： Stream data: { firstName: 'Fred' }, // `timeout` 指定请求超时的毫秒数(0 表示无超时时间) // 如果请求话费了超过 `timeout` 的时间，请求将被中断 timeout: 1000, // `withCredentials` 表示跨域请求时是否需要使用凭证 withCredentials: false, // 默认的 // `adapter` 允许自定义处理请求，以使测试更轻松 // 返回一个 promise 并应用一个有效的响应 adapter: function (config) { /* ... */ }, // `auth` 表示应该使用 HTTP 基础验证，并提供凭据 // 这将设置一个 `Authorization` 头，覆写掉现有的任意使用 `headers` 设置的自定义 `Authorization`头 auth: { username: 'janedoe', password: 's00pers3cret' }, // `responseType` 表示服务器响应的数据类型，可以是 'arraybuffer', 'blob', 'document', 'json', 'text', 'stream' responseType: 'json', // 默认的 // `xsrfCookieName` 是用作 xsrf token 的值的cookie的名称 xsrfCookieName: 'XSRF-TOKEN', // default // `xsrfHeaderName` 是承载 xsrf token 的值的 HTTP 头的名称 xsrfHeaderName: 'X-XSRF-TOKEN', // 默认的 // `onUploadProgress` 允许为上传处理进度事件 onUploadProgress: function (progressEvent) { // 对原生进度事件的处理 }, // `onDownloadProgress` 允许为下载处理进度事件 onDownloadProgress: function (progressEvent) { // 对原生进度事件的处理 }, // `maxContentLength` 定义允许的响应内容的最大尺寸 maxContentLength: 2000, // `validateStatus` 定义对于给定的HTTP 响应状态码是 resolve 或 reject promise 。如果 `validateStatus` 返回 `true` (或者设置为 `null` 或 `undefined`)，promise 将被 resolve; 否则，promise 将被 rejecte validateStatus: function (status) { return status >= 200 && status © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/html.html":{"url":"frontend/html.html","title":"Html","keywords":"","body":"HTML 禁用页面缓存 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/css.html":{"url":"frontend/css.html","title":"Css","keywords":"","body":"Css样式 文本域内容解析换行，解析换行符 网站全局黑白色 自定义光标 水平垂直居中 文本超出省略号 渐变色 div+css绘制六边形 div+css实现四角边框 固定宽高比的自适应矩形 根据兄弟元素的数量来设置样式 九宫格图片展示 输入框占位符交互 hover效果 background-image网格背景 steps步骤条 文本域内容解析换行，解析换行符 white-space: pre-wrap; 网站全局黑白色 /** * 全局黑白色 * 须在html上设置 */ html { -webkit-filter: grayscale(100%); -moz-filter: grayscale(100%); -ms-filter: grayscale(100%); -o-filter: grayscale(100%); filter: grayscale(100%); filter: progid:DXImageTransform.Microsoft.BasicImage(grayscale=1); } /** * 黑色主题 */ html { -webkit-filter: invert(1) hue-rotate(180deg); filter: invert(1) hue-rotate(180deg); } 自定义光标 光标移动到此处 /* 除浏览器默认支持的光标，还支持自定义图片，.ico 或 .cur格式 */ /* 建议：1、图片地址为绝对路径，2、图片大小最好是32*32 */ div { cursor: url(../gitbook/images/favicon.ico), auto; } 水平垂直居中 水平垂直居中 /* 默认初始化样式 */ body { height: 500px; } .center { height: 20%; border: 1px solid #666; } /* 1、flex水平垂直居中，&#x1F44D;推荐使用&#x1F525; */ /* 设为 Flex 布局以后，子元素的float、clear和vertical-align属性将失效 */ .center { display: flex; } .center >span { margin: auto; } /* 衍生写法，可直接居中容器中的文本 */ .center { justify-content: center; align-items: center; } /* 2、grid水平垂直居中 */ /* ❗ 注意兼容性要求浏览器版本较高 */ .center { display: grid; } .center >span { margin: auto; } /* 3、line-height水平垂直居中 */ /* 父节点固定px高度 */ .center { text-align: center; height: 100px; line-height: 100px; } /* 4、绝对定位水平垂直居中 */ /* 子节点固定px高度 .center { text-align: center; position: relative; } .center span { position: absolute; top: 0; left: 0; right: 0; bottom: 0; margin: auto; width: 200px; height: 21px; text-align: center; } */ /* 衍生写法，❗ 基于Chromium的浏览器中会导致文本的模糊问题 ❗ top、left偏移父容器的50%，通过transform: translate偏移自身-50%实现居中 可不设置子节点宽高 */ .center >span { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; } /* 5、伪类水平垂直居中 */ /* 容器before伪类生成一个行内节点，高100%，宽1px，margin-right: -1px，消除1px的占用 容器所有子节点都需要设置vertical-align: middle 容器通常情况下字体大小不为0，代码的换行符会占用一个字符的位置，此处应将容器字体大小设为0，内容节点中重新设置字体大小 */ .center { text-align: center; font-size: 0; } .center::before { content: \"\"; display: inline-block; height: 100%; width: 1px; margin-right: -1px; vertical-align: middle; } .center span { font-size: 16px; vertical-align: middle; } /* 6、table-cell水平垂直居中 */ /* 父容器宽度默认内容宽度 当display: table时，padding失效 当display: table-row时，margin、padding失效 当display: table-cell时，margin失效 */ .center { display: table; width: 100%; } .center span { display: table-cell; vertical-align: middle; text-align: center; } 文本超出省略号 /** * 单行文本 * 注意：固定宽度 */ .text { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; } /** * 多行文本 * 注意：固定宽度，容器padding属性会导致文本无法隐藏 * 只适用于WebKit内核的浏览器 */ .text { display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 2; overflow: hidden; text-overflow: ellipsis; } CSS 实现多行文本“展开收起” .line-clamp .wrapper { display: flex; width: 600px; overflow: hidden; border-radius: 8px; padding: 15px; box-shadow: 5px 5px 15px #BEBEBE, -5px -5px 15px #FFFFFF; } .line-clamp .text { font-size: 18px; overflow: hidden; text-overflow: ellipsis; text-align: justify; position: relative; line-height: 1.5; max-height: 3em; transition: .3s max-height; } .line-clamp .text::before { content: \"\"; height: 100%; margin-bottom: -26px; float: right; } .line-clamp .text::after { content: \"\"; width: 100%; height: 100%; position: absolute; background: #FFF; } .line-clamp .btn { position: relative; float: right; clear: both; margin-left: 20px; font-size: 14px; padding: 0 8px; background: #3F51B5; line-height: 24px; border-radius: 4px; color: #FFF; cursor: pointer; } .line-clamp .btn::after { content: \"展开\"; } .line-clamp .exp { display: none; } .line-clamp .exp:checked + .text { max-height: 180px; } .line-clamp .exp:checked + .text::after { visibility: hidden; } .line-clamp .exp:checked + .text .btn::before { visibility: hidden; } .line-clamp .exp:checked + .text .btn::after { content: \"收起\"; } .line-clamp .btn::before { content: \"...\"; position: absolute; left: -5px; color: #333; transform: translateX(-100%); } 原文链接：https://juejin.cn/post/6963904955262435336， 1、文本环绕效果首先考虑浮动 float； 2、flex 布局子元素可以通过百分比计算高度； 3、多行文本截断还可以结合文本环绕效果用max-height模拟实现； 4、状态切换可以借助 checkbox； 5、CSS 改变文本可以采用伪元素生成。 很长的文字内容 ... ... .wrapper { display: flex; width: 600px; overflow: hidden; border-radius: 8px; padding: 15px; box-shadow: 20px 20px 60px #BEBEBE, -20px -20px 60px #FFFFFF; } .text { font-size: 18px; overflow: hidden; text-overflow: ellipsis; text-align: justify; position: relative; line-height: 1.5; /* 最大高度（px） = 字体大小（px） x 行高 x 行数 */ /* 最大高度（em） = 行高 x 行数 */ max-height: 3em; transition: .3s max-height; } /* 控制按钮一直在最右下角 */ .text::before { content: \"\"; height: 100%; /* -(btn高度 + 2)，可通过调试获取 */ margin-bottom: -26px; float: right; } /* 在内容未发生截断时，遮盖btn，也可通过 el.scrollHeight > el.clientHeight 时判断文本超出 */ .text::after { content: \"\"; width: 100%; height: 100%; position: absolute; background: #FFF; } .btn { position: relative; float: right; clear: both; margin-left: 20px; font-size: 14px; padding: 0 8px; background: #3F51B5; line-height: 24px; border-radius: 4px; color: #FFF; cursor: pointer; } .btn::after { content: \"展开\"; } /* 用过checkbox的:checked状态控制按钮、省略号显示以及文本高度 */ .exp { display: none; } .exp:checked + .text { /* 展开后文本区域高度，直接设置最大高度为一个较大的值，或者直接设置为none，设置none后transition动画效果失效 */ max-height: none; } .exp:checked + .text::after { visibility: hidden; } .exp:checked + .text .btn::before { visibility: hidden; } .exp:checked + .text .btn::after { content: \"收起\"; } .btn::before { content: \"...\"; position: absolute; left: -5px; color: #333; transform: translateX(-100%); } 渐变色 线性渐变 径向渐变 圆锥渐变 /** * 线性就变 * background-image: linear-gradient(direction, color-stop1, color-stop2, ...); * * direction（可不写，默认：to bottom（从上到下））：渐变方向、角度 * 渐变方向：to right（从左到右），to bottom right（从左上角到右下角） * 角度：0deg 将创建一个从下到上的渐变，90deg 将创建一个从左到右的渐变 * * repeating-linear-gradient：重复渐变 */ .box { background-color: red; /* 浏览器不支持的时候显示 */ background-image: linear-gradient(to right, red, yellow, green); } .box { background-color: red; /* 浏览器不支持的时候显示 */ background-image: repeating-linear-gradient(red, yellow 10%, green 20%); } /** * 径向渐变 * background-image: radial-gradient(shape size at position, start-color, ..., last-color); * * shape size at position：（可不写，默认：渐变的中心是 center（表示在中心点），渐变的形状是 ellipse（表示椭圆形），渐变的大小是 farthest-corner（表示到最远的角落）） * shape：circle 表示圆形，ellipse 表示椭圆形（默认） * size： * closest-side：指定径向渐变的半径长度为从圆心到离圆心最近的边 * closest-corner：指定径向渐变的半径长度为从圆心到离圆心最近的角 * farthest-side：指定径向渐变的半径长度为从圆心到离圆心最远的边 * farthest-corner：指定径向渐变的半径长度为从圆心到离圆心最远的角 * * repeating-radial-gradient：重复渐变 */ .box { background-color: red; /* 浏览器不支持的时候显示 */ background-image: radial-gradient(red, green); } .box { background-color: red; /* 浏览器不支持的时候显示 */ background-image: repeating-radial-gradient(red, yellow 10%, green 15%); } /** * 圆锥渐变 * background-image: conic-gradient(from at , color-stop1, color-stop2, ...); * from at ：（可不写，默认：from 0deg at center） * * repeating-conic-gradient：重复渐变 */ .box { background-color: red; /* 浏览器不支持的时候显示 */ background-image: conic-gradient(from 45deg at 20% 40%, red, orange, yellow, green, blue, purple, red); } .box { background-color: red; /* 浏览器不支持的时候显示 */ background-image: repeating-conic-gradient(#fff 0 9deg, #000 9deg 18deg); } div+css绘制六边形 .corner { width: 0; height: 0; border-right: 20px solid #EEE; border-top: 20px solid red; border-bottom: 20px solid #CCC; border-left: 20px solid #EEE; } .hexagon { width: 40px; height: 64px; background-color: purple; position: relative; font-size: 14px; color: #FFF; border-radius: 0; border: 0; } .hexagon:before { content: ''; width: 0; height: 0; position: absolute; top: 0; left: -20px; border-right: 20px solid purple; border-top: 32px solid transparent; border-bottom: 32px solid transparent; } .hexagon:after { content: ''; width: 0; height: 0; position: absolute; top: 0; right: -20px; border-left: 20px solid purple; border-top: 32px solid transparent; border-bottom: 32px solid transparent; } /** * 关键点：使用border绘制三角形 * 箭头向上的三角形：border-bottom：颜色，border-left：透明色，border-right：透明色 * 箭头向右的三角形：border-left：颜色，border-top：透明色，border-bottom：透明色 * 箭头向下的三角形：border-top：颜色，border-left：透明色，border-right：透明色 * 箭头向左的三角形：border-right：颜色，border-top：透明色，border-bottom：透明色 */ .hexagon { width: 40px; height: 64px; background-color: purple; position: relative; font-size: 14px; color: #FFF; border-radius: 0; border: 0; } .hexagon:before { content: ''; width: 0; height: 0; position: absolute; top: 0; left: -20px; border-right: 20px solid purple; border-top: 32px solid transparent; border-bottom: 32px solid transparent; } .hexagon:after { content: ''; width: 0; height: 0; position: absolute; top: 0; right: -20px; border-left: 20px solid purple; border-top: 32px solid transparent; border-bottom: 32px solid transparent; } div+css实现四角边框 .qrcode-box1 { display: inline-block; border: 1px solid #3295D1; box-sizing: border-box; padding: 10px; width: 160px; height: 160px; background: linear-gradient(#3295D1, #3295D1) -155px -128px no-repeat, linear-gradient(#3295D1, #3295D1) -128px -155px no-repeat, linear-gradient(#3295D1, #3295D1) 128px -155px no-repeat, linear-gradient(#3295D1, #3295D1) 155px -128px no-repeat, linear-gradient(#3295D1, #3295D1) -155px 128px no-repeat, linear-gradient(#3295D1, #3295D1) -128px 155px no-repeat, linear-gradient(#3295D1, #3295D1) 128px 155px no-repeat, linear-gradient(#3295D1, #3295D1) 155px 128px no-repeat; } 方式一：通过:before :after伪类实现（也可使用4个div实现）原包裹div实现顶部两个角，增加一个div实现底部两个角，确保新增加div与原包裹div重合优点：可以根据图片大小自适应，易于理解；缺点：实现复杂，dom多、代码多 --> .qrcode-box { display: inline-block; border: 1px solid #3295D1; box-sizing: border-box; padding: 10px; position: relative; } .qrcode-box .qrcode-box-background { position: absolute; top: 0; right: 0; bottom: 0; left: 0; } .qrcode-box::before, .qrcode-box::after, .qrcode-box .qrcode-box-background::before, .qrcode-box .qrcode-box-background::after { content: \"\"; display: block; position: absolute; width: 30px; height: 30px; } .qrcode-box::before { top: 0; left: 0; border-top: 3px solid #3295D1; border-left: 3px solid #3295D1; } .qrcode-box::after { top: 0; right: 0; border-top: 3px solid #3295D1; border-right: 3px solid #3295D1; } .qrcode-box .qrcode-box-background::before { bottom: 0; left: 0; border-bottom: 3px solid #3295D1; border-left: 3px solid #3295D1; } .qrcode-box .qrcode-box-background::after { bottom: 0; right: 0; border-bottom: 3px solid #3295D1; border-right: 3px solid #3295D1; } 方式二：通过在background中使用8个linear-gradient渐变色，并将每个背景色偏移出div范围实现优点：dom少，代码少；缺点：固定宽高，计算位置复杂，不易理解注意：偏移量计算方式，内部img需限制宽高 --> .qrcode-box { display: inline-block; border: 1px solid #3295D1; box-sizing: border-box; padding: 10px; width: 160px; height: 160px; /* * 边角宽3px，高30px，偏移量计算方式 * box宽（160px）- border（1px）- 1px - 边角宽3px = 155px * box宽（160px）- border（1px）- 1px - 边角高30px = 128px */ background: linear-gradient(#3295D1, #3295D1) -155px -128px no-repeat, linear-gradient(#3295D1, #3295D1) -128px -155px no-repeat, linear-gradient(#3295D1, #3295D1) 128px -155px no-repeat, linear-gradient(#3295D1, #3295D1) 155px -128px no-repeat, linear-gradient(#3295D1, #3295D1) -155px 128px no-repeat, linear-gradient(#3295D1, #3295D1) -128px 155px no-repeat, linear-gradient(#3295D1, #3295D1) 128px 155px no-repeat, linear-gradient(#3295D1, #3295D1) 155px 128px no-repeat; } 固定宽高比的自适应矩形 .rect-item { overflow: hidden; position: relative; background-color: #CCC; width: 40%; display: inline-block; vertical-align: middle; } .rect-item:after { content: \"\"; display: block; padding-top: 100%; } .react:after { padding-top: 50%; } .rect-wrap { position: absolute; top: 0; right: 0; bottom: 0; left: 0; display: flex; align-items: center; text-align: center; justify-content: center; font-size: 12px; } .auto-resize-rect-wrap { resize: horizontal; overflow: auto; width: 540px; min-width: 300px; max-width: 700px; margin-bottom: 10px; background-color: #EEE; } 正方形 宽高比 2:1的矩形 核心：padding-top padding-bottom margin-top margin-bottom 为百分比是相对父元素 宽度使用伪元素的padding-top或padding-bottom或margin-top或margin-bottom为百分比撑起父元素高度实现使用margin-top margin-bottom时，父元素需触发BFC，常用触发方式：display: inline-block 或 overflow: hidden 正方形 /** * 1、通过padding-top * padding-top使用百分比，可以控制宽高比 */ .rect-item { position: relative; background-color: #EEE; width: 50%; } .rect-item:after { content: \"\"; display: block; padding-top: 100%; } .rect-wrap { position: absolute; top: 0; right: 0; bottom: 0; left: 0; } /** * 2、通过margin-bottom * margin-bottom使用百分比，可以控制宽高比 */ .rect-item { position: relative; display: inline-block; background-color: #EEE; width: 50%; } .rect-item:after { content: \"\"; display: block; margin-bottom: 50%; } .rect-wrap { position: absolute; top: 0; right: 0; bottom: 0; left: 0; } 根据兄弟元素的数量来设置样式 #count-selector ul { padding: 0 0 10px; margin: 0; list-style: none; font-size: 0; user-select: none; } #count-selector ul >li { display: inline-block; width: 36px; height: 36px; background-color: #CCC; border-radius: 6px; color: #FFF; text-align: center; line-height: 36px; font-size: 12px; margin-left: 10px; } #count-selector ul >li:only-child { color: #b30096; font-weight: 700; font-size: 16px; border-radius: 50%; } #count-selector ul >li:first-child:nth-last-child(2), #count-selector ul >li:first-child:nth-last-child(2) ~ li { color: #d89a00; font-weight: 700; font-size: 16px; border-radius: 50%; } #count-selector ul >li:nth-child(1):nth-last-child(3), #count-selector ul >li:nth-child(1):nth-last-child(3) ~ li { color: #4441f1; font-weight: 700; font-size: 16px; border-radius: 50%; } #count-selector ul >li:first-child:nth-last-child(n+8), #count-selector ul >li:first-child:nth-last-child(n+8) ~ li { background-color: brown; } #count-selector ul >li:first-child:nth-last-child(-n+2), #count-selector ul >li:first-child:nth-last-child(-n+2) ~ li { background-color: forestgreen; } #count-selector ul >li:first-child:nth-last-child(n+5):nth-last-child(-n+6), #count-selector ul >li:first-child:nth-last-child(n+5):nth-last-child(-n+6) ~ li { background-color: #008eff; } #count-selector { margin-top: -10px; padding-top: 10px; position: relative; min-width: 700px; overflow-x: auto; } #count-selector >div { position: absolute; font-size: 12px; } #count-selector pre { padding: 3px; border-radius: 3px; margin: 0; display: inline-block; font-size: 12px; background-color: #CCC; color: #FFF; font-family: Consolas, \"Liberation Mono\", Menlo, Courier, monospace; direction: ltr; font-weight: 600; user-select: all; vertical-align: middle; } ul >li:only-child 等价 ul >li:first-child:last-child 等价 ul >li:nth-child(1):nth-last-child(1) ul >li:first-child:nth-last-child(2), ul >li:first-child:nth-last-child(2) ~ li ul >li:nth-child(1):nth-last-child(3), ul >li:nth-child(1):nth-last-child(3) ~ li ul >li:first-child:nth-last-child(-n+2), ul >li:first-child:nth-last-child(-n+2) ~ li ul >li:first-child:nth-last-child(n+5):nth-last-child(-n+6), ul >li:first-child:nth-last-child(n+5):nth-last-child(-n+6) ~ li ul >li:first-child:nth-last-child(n+8), ul >li:first-child:nth-last-child(n+8) ~ li 1 12 123 1234 12345 123456 1234567 12345678 123456789 核心：1、CSS选择器 ~，表示某元素后所有同级的指定元素2、:nth-child（正数）:nth-last-child（倒数）：选择属于其父元素的指定第几个子元素的每个指定元素，常用使用如下：:nth-child(2)：正数第2个元素:nth-child(n)：正数 >= 1 的元素，即：全部指定元素:nth-child(n+2)：正数 >= 2 的元素，即：正数第2个以及后面全部指定元素:nth-child(-n+2)：正数 :nth-child(2n-1)：正数 奇数 的元素，等价于:nth-child(odd)，即：正数数第1、3、5、...个指定元素:nth-last-child(2)：倒数第2个元素:nth-last-child(n)：倒数 >= 1 的元素，即：全部指定元素:nth-last-child(n+2)：倒数 >= 2 的元素，即：倒数第2个以及前面全部指定元素:nth-last-child(-n+2)：倒数 :nth-last-child(2n)：倒数 偶数 的元素，等价于:nth-last-child(even)，即：倒数第2、4、6、...个指定元素注意：2 中涉及的选择器会选择其父级元素下所有指定子元素，具体可参照下图： /** * 只包含一个元素 * :only-child 等价于 :first-child:last-child 等价于 :nth-child(1):nth-last-child(1) * 只包含一个元素 */ ul >li:only-child { /* ul >li:first-child:last-child { */ /* ul >li:nth-child(1):nth-last-child(1) { */ } /** * 元素数 = 2 的全部元素 */ ul >li:first-child:nth-last-child(2), ul >li:first-child:nth-last-child(2) ~ li { } /** * 元素数 = 3 的全部元素 */ ul >li:nth-child(1):nth-last-child(3), ul >li:nth-child(1):nth-last-child(3) ~ li { } /** * 元素数 >= 8 的全部元素 */ ul >li:first-child:nth-last-child(n+8), ul >li:first-child:nth-last-child(n+8) ~ li { } /** * 元素数 li:first-child:nth-last-child(-n+2), ul >li:first-child:nth-last-child(-n+2) ~ li { } /** * 元素数 >= 5 && li:first-child:nth-last-child(n+5):nth-last-child(-n+6), ul >li:first-child:nth-last-child(n+5):nth-last-child(-n+6) ~ li { } 九宫格图片展示 .album-wrap { width: 540px; min-width: 200px; max-width: 700px; box-sizing: border-box; padding: 5px; background-color: #EEE; font-size: 0; margin-bottom: 10px; resize: horizontal; overflow: auto; } .album-wrap img { width: 100%; height: 100%; background-color: #CCC; -o-object-fit: cover; object-fit: cover; } .album-wrap .rect-item { width: calc(100% / 3); position: relative; display: inline-block; width: calc(100% / 3); min-width: initial; max-width: initial; background-color: #EEE; } .album-wrap .rect-wrap { padding: 5px; } .album-wrap .rect-item:first-child:last-child { width: 100%; } .album-wrap .rect-item:first-child:last-child:after { padding-top: 50%; } .album-wrap .rect-item:first-child:nth-last-child(2), .album-wrap .rect-item:first-child:nth-last-child(2) ~ .rect-item { width: 50%; } .album-wrap .rect-item:first-child:nth-last-child(4), .album-wrap .rect-item:first-child:nth-last-child(4) ~ .rect-item { width: 50%; } .album-wrap .rect-item:first-child:nth-last-child(4):after, .album-wrap .rect-item:first-child:nth-last-child(4) ~ .rect-item:after { padding-top: 70%; } Add a image Remove last image function addImageItem () { var div = document.createElement('div') div.className = 'rect-item' var wrap = document.createElement('div') wrap.className = 'rect-wrap' div.appendChild(wrap) var img = document.createElement('img') img.src = 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/wgALCABIAEgBAREA/8QAGgABAAIDAQAAAAAAAAAAAAAAAAMEAQIFBv/aAAgBAQAAAAH0AAEdLN7YOdx9PTTMQz8Wv2rBjz6pb7sgpcJ3rg1hoy220jXG4AB//8QAIhAAAgEDBAIDAAAAAAAAAAAAAQIDAAQQERITIDEzFDBA/9oACAEBAAEFAvtdgi/LjoXcZPnte+pmLYi9WUffi5mVxAm+RFcHpvMdxNOZcW6CRlG1ek8PICNCBqYIuNepXbUwD3M6qlaB64xSgaY80FC/g//EACoQAAECBAMGBwAAAAAAAAAAAAEAIQIRIFEQEkEDIjEycYEwQEKCkZKx/9oACAEBAAY/AvFmVwiUnrHVCejYQdKIm4GWAhhfWaYyk63tpm7UxEXVhbAg2QFqZjmUjopBPzVTGc+5Q5mZbOKxA7IF/ler7FN+0MAPIf/EACcQAQABAgYBAgcAAAAAAAAAAAERACEQIDFBUWGhcfAwQLHB0eHx/9oACAEBAAE/IfiqHgPNfyz80AgZdWLeaEEjI75va9NXBmEPTDxv0ycQn164W0Q/op4pYgxO9S6JGkTK8189k1EkQ+q+HK/jp5q+8wDKe0S3fVI1hUNIdxWCtvSusXOsqSJQwBZ0l92hlxTaJm+lWpi+cUhyxS0Irt97ugXVG8qcUBCSO1FQRwHyH//aAAgBAQAAABAAAwOMReAgWAAAf//EACQQAQACAgIBAwUBAAAAAAAAAAERIQAxQVEQIGFxMECBkfCh/9oACAEBAAE/EPqjvAtoKiYJ2+IFTvEIJcrwwyYEgsfV/h4cOXToaPH8fp5cf96ikX7b8UNIrEMJRPzOfPj1gcfLjGRwKl7k/r9DrFu4zB2Sx6zsnLHITMTzrwd3M72AQOpzu02ImCPS3qtNwB7Bt3hXSgSMM9lbMOaGCQlmiWt4YxWkSQNiZBPSbiwiUo/syCEUDe9giVrGn2HIl7jUzuc93viwSxHMR84msSUejZQnfjkT0ukPvKteXJgQqxxi8Mogn8fYf//Z' wrap.appendChild(img) document.getElementById('album-wrap').appendChild(div) } addImageItem() addImageItem() document.getElementById('add-img').onclick = function () { var imgs = document.getElementById('album-wrap').children if (imgs && imgs.length 1) { document.getElementById('album-wrap').removeChild(imgs[imgs.length - 1]) } } 图片展示根据数量不同而自动适配不同布局效果，主要针对仅有1个、2个、4个的情况布局根据 根据兄弟元素的数量来设置样式 实现自适应根据 固定宽高比的自适应矩形 实现 /* 仅有1个元素 */ .album-wrap .rect-item:first-child:last-child { width: 100%; } .album-wrap .rect-item:first-child:last-child:after { padding-top: 50%; } /* 仅有2个元素 */ .album-wrap .rect-item:first-child:nth-last-child(2), .album-wrap .rect-item:first-child:nth-last-child(2) ~ .rect-item { width: 50%; } /* 仅有4个元素 */ .album-wrap .rect-item:first-child:nth-last-child(4), .album-wrap .rect-item:first-child:nth-last-child(4) ~ .rect-item { width: 50%; } .album-wrap .rect-item:first-child:nth-last-child(4):after, .album-wrap .rect-item:first-child:nth-last-child(4) ~ .rect-item:after { padding-top: 70%; } 输入框占位符交互 .input-control { appearance: none; -webkit-appearance: none; background-color: #FFF; background-image: none; font-size: 14px; padding: 0 12px; height: 34px; line-height: 34px; box-sizing: border-box; border: 1px solid #DCDFE6; border-radius: 4px; outline: none; transition: border-color .2s cubic-bezier(.645, .045, .355, 1); } .input-control::placeholder { color: #C0C4CC } .input-control:hover { border-color: #C0C4CC } .input-control:focus { outline: none; border-color: #409EFF } .input-box { display: inline-block; position: relative; } .input-control:placeholder-shown::placeholder { color: transparent; } .input-label { color: #C0C4CC; font-size: 14px; position: absolute; left: 13px; top: 16px; pointer-events: none; line-height: 0; height: 2px; background-color: #FFF; transition: transform .2s cubic-bezier(.645, .045, .355, 1), color .2s cubic-bezier(.645, .045, .355, 1); } .input-control:not(:placeholder-shown) ~ .input-label, .input-control:focus ~ .input-label { color: #409EFF; transform: scale(0.84) translate(-1px, -20px); } 姓名 输入框聚焦时，输入框的占位符内容以动画形式移动到左上角作为标题借助:placeholder-shown伪类实现 姓名 /* 输入框美化 start */ .input-control { appearance: none; -webkit-appearance: none; background-color: #FFF; background-image: none; font-size: 14px; padding: 0 12px; height: 34px; line-height: 34px; box-sizing: border-box; border: 1px solid #DCDFE6; border-radius: 4px; outline: none; transition: border-color .2s cubic-bezier(.645, .045, .355, 1); } .input-control::placeholder { color: #C0C4CC; } .input-control:hover { border-color: #C0C4CC; } .input-control:focus { outline: none; border-color: #409EFF; } /* 输入框美化 end */ .input-box { display: inline-block; position: relative; } /* 使默认placeholder效果不可见 */ .input-control:placeholder-shown::placeholder { color: transparent; } /* 使用.input-label代替原来占位符 */ .input-label { color: #C0C4CC; font-size: 14px; position: absolute; left: 13px; top: 16px; pointer-events: none; line-height: 0; height: 2px; background-color: #FFF; transition: transform .2s cubic-bezier(.645, .045, .355, 1), color .2s cubic-bezier(.645, .045, .355, 1); } /* 输入框获取焦点 */ .input-control:not(:placeholder-shown) ~ .input-label, .input-control:focus ~ .input-label { color: #409EFF; transform: scale(0.84) translate(-1px, -20px); } hover效果 span.link1 { display: inline-block; color: #409EFF; cursor: pointer; padding-bottom: 4px; text-decoration: none; position: relative; } span.link1:after { content: \"\"; position: absolute; width: 100%; height: 2px; bottom: 0; left: 0; transform: scaleX(0); background-color: #409EFF; transform-origin: bottom right; transition: transform .3s ease-in-out; } span.link1:hover:after { transform: scaleX(1); transform-origin: bottom left; } hover效果 - 1，underline划过效果 /* hover效果 - 1，underline划过效果，核心：transform-origin 更改一个元素变形的原点 */ .link1 { display: inline-block; color: #409EFF; cursor: pointer; padding-bottom: 4px; text-decoration: none; position: relative; } .link1:after { content: \"\"; position: absolute; width: 100%; height: 2px; bottom: 0; left: 0; transform: scaleX(0); background-color: #409EFF; transform-origin: bottom right; transition: transform .3s ease-in-out; } .link1:hover:after { transform: scaleX(1); transform-origin: bottom left; } background-image网格背景 #grid-bg { height: 101px; width: 101px; background-image: linear-gradient(0deg, #EEE 1px, transparent 0%), linear-gradient(90deg, #EEE 1px, transparent 0%); background-size: 20px 20px; background-position: 0 1px; display: flex; justify-content: center; align-items: center; } 网格背景 /* 通过background-image: linear-gradient绘制网格背景 */ .box { background-image: linear-gradient(0deg, #EEE 1px, transparent 0%), linear-gradient(90deg, #EEE 1px, transparent 0%); background-size: 20px 20px; background-position: 0 1px; } steps步骤条 .steps-wrap { display: flex; } .steps-item { flex: 1; height: 40px; border-top: 1px solid transparent; border-bottom: 1px solid transparent; box-sizing: border-box; margin: 0 2px; position: relative; display: flex; align-items: center; justify-content: center; background-color: #EEE; color: #777; } .steps-item, .steps-item:before, .steps-item:after { transition: border-color .25s cubic-bezier(.71,-.46,.29,1.46), color .25s cubic-bezier(.71,-.46,.29,1.46), background-color .25s cubic-bezier(.71,-.46,.29,1.46); } .steps-item:first-child { border-left: 1px solid transparent; } .steps-item:last-child { border-right: 1px solid transparent; } .steps-item:last-child:before, .steps-item:not(:first-child):not(:last-child):before, .steps-item:first-child:after, .steps-item:not(:first-child):not(:last-child):after { content: \"\"; display: block; position: absolute; top: 0; width: 40px; height: 40px; box-sizing: border-box; border-top: 1px solid transparent; } .steps-item:last-child:before, .steps-item:not(:first-child):not(:last-child):before { left: 0; z-index: 0; background-color: #FFF; border-right: 1px solid transparent; transform: rotateZ(45deg) scale(0.707) translateX(-21px) translateY(19px); } .steps-item:first-child:after, .steps-item:not(:first-child):not(:last-child):after { right: 0; z-index: 1; background-color: #EEE; border-right: 1px solid transparent; transform: rotateZ(45deg) scale(0.707) translateX(19px) translateY(-21px); } .steps-item.actived.actived, .steps-item.actived.actived:before, .steps-item.actived.actived:after { border-color: #5898F7; color: #5898F7 } .steps-item.actived.actived, .steps-item.actived.actived:after { background-color: #E1EDFD; } .steps-item.finished.finished, .steps-item.finished.finished:before, .steps-item.finished.finished:after { border-color: #DDD; color: #999; background-color: #FFF; } 1 2 3 4 init steps next step document.getElementById('steps-init-btn').onclick = function () { const stepsDoms = document.querySelectorAll('.steps-wrap .steps-item') let activedStep = Array.from(stepsDoms).findIndex(({ classList }) => Array.from(classList).includes('actived')) document.getElementById('steps-next-btn').onclick = function () { if (++activedStep > 3) activedStep = 0 stepsDoms.forEach(function (dom, index) { const clazz = dom.classList if (clazz.contains('finished')) { clazz.remove('finished') } if (clazz.contains('actived')) { clazz.remove('actived') } if (index 1 2 3 4 .steps-wrap { display: flex; } .steps-item { flex: 1; height: 40px; border-top: 1px solid transparent; border-bottom: 1px solid transparent; box-sizing: border-box; margin: 0 2px; position: relative; display: flex; align-items: center; justify-content: center; background-color: #EEE; color: #777; } .steps-item, .steps-item:before, .steps-item:after { transition: border-color .25s cubic-bezier(.71,-.46,.29,1.46), color .25s cubic-bezier(.71,-.46,.29,1.46), background-color .25s cubic-bezier(.71,-.46,.29,1.46); } .steps-item:first-child { border-left: 1px solid transparent; } .steps-item:last-child { border-right: 1px solid transparent; } .steps-item:last-child:before, .steps-item:not(:first-child):not(:last-child):before, .steps-item:first-child:after, .steps-item:not(:first-child):not(:last-child):after { content: \"\"; display: block; position: absolute; top: 0; width: 40px; height: 40px; box-sizing: border-box; border-top: 1px solid transparent; } .steps-item:last-child:before, .steps-item:not(:first-child):not(:last-child):before { left: 0; z-index: 0; background-color: #FFF; border-right: 1px solid transparent; transform: rotateZ(45deg) scale(0.707) translateX(-21px) translateY(19px); } .steps-item:first-child:after, .steps-item:not(:first-child):not(:last-child):after { right: 0; z-index: 1; background-color: #EEE; border-right: 1px solid transparent; transform: rotateZ(45deg) scale(0.707) translateX(19px) translateY(-21px); } .steps-item.actived.actived, .steps-item.actived.actived:before, .steps-item.actived.actived:after { border-color: #5898F7; color: #5898F7 } .steps-item.actived.actived, .steps-item.actived.actived:after { background-color: #E1EDFD; } .steps-item.finished.finished, .steps-item.finished.finished:before, .steps-item.finished.finished:after { border-color: #DDD; color: #999; background-color: #FFF; } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-08-19 "},"frontend/vw.html":{"url":"frontend/vw.html","title":"移动端vw适配方案","keywords":"","body":"移动端vw适配方案 如果使用 create-react-app创建项目 可参照参照该文最后章节 该文测试所使用postcss版本为7.0.x注意PostCSS插件等依赖与postcss的版本匹配，否则会报错使用时也可根据报错信息调整各依赖版本 1、安装PostCSS插件 相关依赖 postcss-import 解决@import引入路径问题 postcss-url 用来处理文件，比如图片文件、字体文件等引用路径的处理 autoprefixer 自动处理浏览器前缀，一般脚手架会自带 # 安装依赖 yarn add postcss-import postcss-url autoprefixer -D /* 当前依赖版本 */ { \"devDependencies\": { \"autoprefixer\": \"^9.7.6\", \"postcss-import\": \"^12.0.1\", \"postcss-url\": \"^8.0.0\" } } 配置PostCSS，项目根目录.postcssrc.js文件 module.exports = { plugins: { autoprefixer: {}, 'postcss-import': {}, 'postcss-url': {} } } 2、其他插件 相关依赖 postcss-aspect-ratio-mini 处理元素容器宽高比 postcss-px-to-viewport 把px单位转换为vw、vh、vmin或者vmax这样的视窗单位，也是vw适配方案的核心插件之一 postcss-write-svg 处理移动端1px的解决方案 postcss-preset-env cssnext，使用CSS未来的特性 cssnano 压缩和清理CSS代码 cssnano-preset-advanced cssnano依赖，preset: 'advanced' postcss-viewport-units 给CSS的属性添加content的属性，配合viewport-units-buggyfill库给vw、vh、vmin和vmax做适配的操作 # 安装依赖 yarn add postcss-aspect-ratio-mini postcss-px-to-viewport postcss-write-svg postcss-preset-env cssnano cssnano-preset-advanced postcss-viewport-units -D /* 当前依赖版本 */ { \"devDependencies\": { \"cssnano\": \"^4.1.10\", \"cssnano-preset-advanced\": \"^4.0.7\", \"postcss-aspect-ratio-mini\": \"^1.0.1\", \"postcss-preset-env\": \"^6.7.0\", \"postcss-px-to-viewport\": \"^1.1.1\", \"postcss-viewport-units\": \"^0.1.6\", \"postcss-write-svg\": \"^3.0.1\" } } 增加PostCSS配置，项目根目录.postcssrc.js文件，以下为完整配置 module.exports = { plugins: { 'postcss-import': {}, 'postcss-url': {}, 'postcss-aspect-ratio-mini': {}, 'postcss-write-svg': { utf8: false // 使用base64编码 }, 'postcss-preset-env': { stage: 4 // 稳定阶段 }, 'postcss-px-to-viewport': { viewportWidth: 750, // (Number) 视窗的宽度，对应的是我们设计稿的宽度，一般是750 viewportHeight: 1334, // (Number) 视窗的高度，根据750设备的宽度来指定，一般指定1334，也可以不配置 unitPrecision: 3, // (Number) 指定`px`转换为视窗单位值的小数位数（很多时候无法整除） viewportUnit: 'vw', // (String) 指定需要转换成的视窗单位，建议使用vw selectorBlackList: ['.ignore', '.hairlines', '.markdown'], // (Array) 指定不转换为视窗单位的类，可以自定义，可以无限添加，建议定义一至两个通用的类名，注意：第三方UI库也要在此添加 minPixelValue: 1, // (Number) 小于或等于`1px`不转换为视窗单位，你也可以设置为你想要的值 mediaQuery: false // (Boolean) 允许在媒体查询中转换`px` }, 'postcss-viewport-units': { filterRule: rule => rule.nodes.findIndex(i => i.prop === 'content') === -1 // 过滤伪类content使用 }, 'cssnano': { 'cssnano-preset-advanced': { zindex: false, // 防止z-index的值重置为1 autoprefixer: false // 有重复调用，关闭 } } } } 关于兼容第三方UI库 const path = require('path') module.exports = ({ file }) => { // 解决UI框架与设计稿尺寸不一致的问题，如：vant有赞移动端web UI框架 //const designWidth = file.dirname.includes(path.join('node_modules', 'vant')) ? 375 : 750 // 默认设计稿宽度750 const designWidth = 750 return { plugins: { // ··· ··· 其他配置 'postcss-px-to-viewport': { viewportWidth: designWidth, // (Number) 视窗的宽度，对应的是我们设计稿的宽度，一般是750 viewportHeight: 1334, // (Number) 视窗的高度，根据750设备的宽度来指定，一般指定1334，也可以不配置 unitPrecision: 3, // (Number) 指定`px`转换为视窗单位值的小数位数（很多时候无法整除） viewportUnit: 'vw', // (String) 指定需要转换成的视窗单位，建议使用vw selectorBlackList: ['.ignore', '.hairlines', '.markdown'], // (Array) 指定不转换为视窗单位的类，可以自定义，可以无限添加，建议定义一至两个通用的类名，注意：第三方UI库也要在此添加 minPixelValue: 1, // (Number) 小于或等于`1px`不转换为视窗单位，你也可以设置为你想要的值 mediaQuery: false // (Boolean) 允许在媒体查询中转换`px` }, // ··· ··· 其他配置 } } } 注意：由于cssnext和cssnano都具有autoprefixer，事实上只需要一个，所以把默认的autoprefixer删除掉，然后把cssnano中的autoprefixer设置为false 3、index.html配置 修改meta viewport 增加viewport-units-buggyfill、fastclick配置在index.html中加入注意：fastclick可能引起一些点击问题，参照 FastClick 填坑及源码解析 if ('addEventListener' in document) { document.addEventListener('DOMContentLoaded', function () { FastClick.attach(document.body) }, false) } if (!window.Promise) { document.writeln('' + '') } window.onload = function () { window.viewportUnitsBuggyfill.init({ hacks: window.viewportUnitsBuggyfillHacks }) } 4、部分功能使用介绍 （1）postcss-aspect-ratio-mini 宽高比容器 使用 [aspectratio] { position: relative; } [aspectratio]:before { content: ''; display: block; width: 1px; margin-left: -1px; height: 0; } [aspectratio-content] { position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; } [w-188-246] { width: 188px; background-color: red; } [w-188-246] { aspect-ratio: '188:246'; } 编译后代码css [aspectratio] { position: relative; } [w-188-246] { width: 188px; background-color: red; } [w-188-246]:before { padding-top: 130.85106382978725%; } [aspectratio]:before { content: \"\"; display: block; width: 1px; margin-left: -1px; height: 0; } [aspectratio-content] { position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; } （2）postcss-write-svg 在retina屏绘制1px细线 使用 /* 注意：stylus 里面这样搞无效，less、scss可能会有warning，可以使用 */ @svg 1px-border { width: 4px; height: 4px; @rect { fill: transparent; width: 100%; height: 100%; stroke-width: 25%; stroke: var(--color, black); } } .hairlines { border: 0; border-top: 1px solid; border-image: svg(1px-border param(--color red)) 1 stretch; } 编译后代码css .hairlines { margin-bottom: 20px; border: 0; border-top: 1px solid; -o-border-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zd…IgaGVpZ2h0PSIxMDAlIiBzdHJva2Utd2lkdGg9IjI1JSIgc3Ryb2tlPSJyZWQiLz48L3N2Zz4=) 1 stretch; border-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zd…IgaGVpZ2h0PSIxMDAlIiBzdHJva2Utd2lkdGg9IjI1JSIgc3Ryb2tlPSJyZWQiLz48L3N2Zz4=) 1 stretch; } retina屏下放大效果对比展示，蓝色线class=\"line\"为未使用postcss-write-svg .line { border-top: 1px solid #00b1ff; } 在 create-react-app 中使用 create-react-app使用 可参照 1、依赖 参数文章开头 1、2 安装相关依赖 2、配置 在config-overrides.js文件中添加以下配置 const { // ··· ··· 其他方法引入 addPostcssPlugins // ··· ··· 其他方法引入 } = require('customize-cra') // postcss vw plugins const postCssPlugins = [ require('postcss-import'), require('postcss-url'), require('postcss-aspect-ratio-mini'), require('postcss-write-svg')({ utf8: false }), require('postcss-preset-env')({ stage: 4 // 稳定阶段 }), require('postcss-px-to-viewport')({ viewportWidth: 750, // (Number) 视窗的宽度，对应的是我们设计稿的宽度，一般是750 viewportHeight: 1334, // (Number) 视窗的高度，根据750设备的宽度来指定，一般指定1334，也可以不配置 unitPrecision: 3, // (Number) 指定`px`转换为视窗单位值的小数位数（很多时候无法整除） viewportUnit: 'vw', // (String) 指定需要转换成的视窗单位，建议使用vw selectorBlackList: ['.ignore', '.hairlines', '.markdown'], // (Array) 指定不转换为视窗单位的类，可以自定义，可以无限添加，建议定义一至两个通用的类名，注意：第三方UI库也要在此添加 minPixelValue: 1, // (Number) 小于或等于`1px`不转换为视窗单位，你也可以设置为你想要的值 mediaQuery: false // (Boolean) 允许在媒体查询中转换`px` }), require('postcss-viewport-units')({ filterRule: rule => rule.nodes.findIndex(i => i.prop === 'content') === -1 // 过滤伪类content使用 }), require('cssnano')({ 'cssnano-preset-advanced': { zindex: false, // 防止z-index的值重置为1 autoprefixer: false // 有重复调用，关闭 } }) ] /** * 修改默认配置 */ module.exports = function (config, env) { // ··· ··· 其他配置 // 添加postcss插件 addPostcssPlugins(postCssPlugins)(config) // ··· ··· 其他配置 // 返回config return config } 3、注意 react中不能使用空的自定义属性（如：），如需自定义属性样式，正确的使用方法如下 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/vuejs.html":{"url":"frontend/vuejs.html","title":"Vue.js","keywords":"","body":"Vue.js Vue水印指令 支持vue 2 / 3 const watermark = ({ container = document.body, content = '水印', color = 'rgba(0, 0, 0, .1)', fontSize = 16, fontFamily = '', zIndex = 1000, rotate = 30, width = 100, height = 100, repeat = true }) => { if (!content) return const canvas = document.createElement('canvas') canvas.setAttribute('width', `${width}px`) canvas.setAttribute('height', `${height}px`) const ctx = canvas.getContext('2d') ctx.textAlign = 'center' ctx.textBaseline = 'top' ctx.font = `${fontSize}px ${fontFamily}` ctx.fillStyle = color ctx.rotate(Math.PI / 180 * rotate) const strs = content.split('\\n') // 解析 \\n 换行 strs.forEach((str, index) => ctx.fillText(str, (strs.length + 3) * fontSize, index * fontSize)) const base64Url = canvas.toDataURL() const prevWatermarkDiv = container.firstChild let watermarkDiv if (prevWatermarkDiv && prevWatermarkDiv.className && prevWatermarkDiv.className.includes('watermark-container')) { watermarkDiv = prevWatermarkDiv } else { watermarkDiv = document.createElement('div') watermarkDiv.className = 'watermark-container' } watermarkDiv.setAttribute( 'style', ` position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: ${zIndex}; pointer-events: none; background-repeat: ${repeat ? 'repeat' : 'no-repeat'}; background-image: url('${base64Url}'); ` ) container.style.position = 'relative' if (!prevWatermarkDiv || !(prevWatermarkDiv.className && prevWatermarkDiv.className.includes('watermark-container'))) { container.insertBefore(watermarkDiv, container.firstChild) } } export default { install (Vue, config = {}) { Vue.directive('watermark', (el, binding) => { let options if (typeof binding.value === 'string') { options = { content: binding.value } } else { options = binding.value } watermark(Object.assign({ container: el }, config, options)) }) } } 使用 /* vue@2.x */ import Watermark from '@/directives/watermark' Vue.use(Watermark, { content: '支持换行的\\n水印文字', color: 'rgba(0, 0, 0, .06)', width: 150, height: 130 }) /* vue@3.x */ import Watermark from '@/directives/watermark' const app = createApp(/* ... */) app.use(Watermark) Vue@2.x 父子组件生命周期顺序 /* 加载渲染过程 */ parent beforeCreate ↓ parent created ↓ parent beforeMount ↓ child beforeCreate ↓ child created ↓ child beforeMount ↓ child mounted ↓ parent mounted /* 更新过程 */ // 子组件更新 child beforeUpdate ↓ child updated // 子组件影响父组件（$emit）、父组件影响子组件（props） parent beforeUpdate ↓ child beforeUpdate ↓ child updated ↓ parent updated // 父组件更新 parent beforeUpdate ↓ parent updated /* 销毁过程 */ parent beforeDestroy ↓ child beforeDestroy ↓ child destroyed ↓ parent destroyed © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/cra.html":{"url":"frontend/cra.html","title":"Create React App","keywords":"","body":"Create React App 创建项目 TypeScript模版增加配置请查看 # 默认创建项目 yarn create react-app # 使用typescript创建项目 yarn create react-app --template typescript 优化package.json 将原来的dependencies、scripts改为以下 { \"scripts\": { \"dev\": \"react-scripts start\", \"build\": \"react-scripts build\", \"test\": \"react-scripts test\", \"eject\": \"react-scripts eject\" }, \"dependencies\": { \"react\": \"^16.13.1\", \"react-dom\": \"^16.13.1\" }, \"devDependencies\": { \"@testing-library/jest-dom\": \"^4.2.4\", \"@testing-library/react\": \"^9.3.2\", \"@testing-library/user-event\": \"^7.1.2\", \"react-scripts\": \"3.4.1\" } } 跨域代理 在package.json中添加 { \"proxy\": \"http://192.168.0.11\" } 环境变量配置 开发环境，项目根目录创建.env.development文件 # 运行时不自动在浏览器中打开 BROWSER=none # 修改端口 PORT=8009 生产环境，项目根目录创建.env.production文件 # 打包后子路径，/ 为默认根目录，如需修改为 /app/xxx，则 PUBLIC_URL=/app PUBLIC_URL=/app # 打包不生成sourcemap GENERATE_SOURCEMAP=false 常用依赖 axios 基于Promise的HTTP客户端，用于浏览器和node.js qs 查询字符串解析和字符串化库 mobx 状态管理 mobx-react mobx在react使用支持 prop-types 检查 react props，TypeScript模版不需要 react-router-dom 路由，会自动添加react-router依赖 @types/react-router-dom 路由类型定义（TypeScript模版），会自动添加@types/react-router依赖 react-app-rewired 在不eject也不创建额外react-scripts的情况下修改create-react-app内置的webpack配置 （1）安装依赖 相关依赖 react-app-rewired 修改create-react-app内置的webpack配置 customize-cra 提供了一些实用程序，通过react-app-rewired来自定义配置create-react-app核心功能 eslint js校验 eslint-config-standard eslint的standard校验规则 eslint-plugin-import eslint插件 eslint-plugin-node eslint插件 eslint-plugin-promise eslint插件 eslint-plugin-standard eslint插件 node-sass scss支持，自带scss配置，默认支持scss module react-hot-loader 热加载 @hot-loader/react-dom hot loader支持hooks，安装时需与react版本一致 # 安装依赖 yarn add react-app-rewired customize-cra -D # eslint yarn add eslint eslint-config-standard eslint-plugin-import eslint-plugin-node eslint-plugin-promise eslint-plugin-standard -D # scss yarn add node-sass -D # 热加载依赖 yarn add react-hot-loader @hot-loader/react-dom -D /* 当前依赖版本 */ { \"devDependencies\": { \"@hot-loader/react-dom\": \"^16.13.0\", \"customize-cra\": \"^0.9.1\", \"eslint\": \"^6.8.0\", \"eslint-config-standard\": \"^14.1.1\", \"eslint-plugin-import\": \"^2.20.2\", \"eslint-plugin-node\": \"^11.1.0\", \"eslint-plugin-promise\": \"^4.2.1\", \"eslint-plugin-standard\": \"^4.0.1\", \"node-sass\": \"^4.13.1\", \"react-app-rewired\": \"^2.1.5\", \"react-hot-loader\": \"^4.12.20\" } } （2）配置 项目根目录创建config-overrides.js文件，配置为以下 const path = require('path') const { addBabelPlugin, addDecoratorsLegacy, addWebpackAlias, useEslintRc } = require('customize-cra') const resolve = dir => path.resolve(__dirname, 'src', dir) // hot-loader配置 const rewireHotLoader = (config, env) => { if (env === 'production') { return config } // Find a rule which contains eslint-loader const condition = u => typeof u === 'object' && u.loader && u.loader.includes('eslint-loader') const rule = config.module.rules.find(rule => rule.use && rule.use.some(condition)) if (rule) { const use = rule.use.find(condition) if (use) { // Inject the option for eslint-loader use.options.emitWarning = true } } // If in development, add 'react-hot-loader/babel' to babel plugins. return addBabelPlugin('react-hot-loader/babel')(config) } // 别名 const alias = env => Object.assign(env === 'production' ? {} : { 'react-dom': '@hot-loader/react-dom' }, { '@src': resolve(''), '@api': resolve('api'), '@store': resolve('store'), '@routes': resolve('routes'), '@pages': resolve('pages'), '@layouts': resolve('layouts'), '@components': resolve('components'), '@styles': resolve('assets/styles'), '@images': resolve('assets/images') }) /** * 修改默认配置 */ module.exports = function (config, env) { // 开发模式使用react-hot-loader rewireHotLoader(config, env) // 使用自定义.eslintrc useEslintRc('./.eslintrc')(config) // 装饰器，主要用于mobx addDecoratorsLegacy()(config) // 别名 addWebpackAlias(alias(env))(config) // 返回config return config } 修改package.json文件中scripts为以下 { \"scripts\": { \"dev\": \"react-app-rewired start\", \"build\": \"react-app-rewired build\", \"test\": \"react-app-rewired test\", \"eject\": \"react-scripts eject\" } } ESLint配置 删除package.json文件中eslintConfig根目录创建.eslintrc文件，配置eslint，当前使用standard校验规则注意：需要与相关开发工具设置配合 { \"extends\": [ \"standard\", \"plugin:react/recommended\" ], \"env\": { \"browser\": true, \"commonjs\": true, \"node\": true, \"es6\": true }, \"parser\": \"babel-eslint\", \"parserOptions\": { \"ecmaVersion\": 7, \"sourceType\": \"module\", \"ecmaFeatures\": { \"jsx\": true, \"legacyDecorators\": true } }, \"settings\": { \"react\": { \"version\": \"detect\" } }, \"plugins\": [ \"react\" ], \"rules\": { \"arrow-parens\": [ \"error\", \"as-needed\" ], \"object-curly-spacing\": [ 1, \"always\" ] } } 部分组件使用 scss、scss module使用 创建style.scss文件，直接在需要的页面或者组件中引入即可 import './style.scss' 创建style.module.scss文件，直接在需要的组件中引入，然后className引用里面的样式即可 import styles from './style.module.scss' 输出样式 .___ { } react-hot-loader使用 相关配置参照上方的配置说明，配置主要针对开发模式（1）react-hot-loader/babel（2）webpack配置别名'react-dom': '@hot-loader/react-dom'支持hooks import { hot } from 'react-hot-loader/root' // 处理入口文件引入的 App 组件，开发模式需要使用 react-hot-loader 处理 const AppComponent = process.env.NODE_ENV === 'development' ? hot(App) : App ReactDOM.render( , document.getElementById('root') ) TypeScript模版增加配置 eslint 此处eslint有版本要求 eslint-plugin-react eslint react组件 @typescript-eslint/parser typescript eslint解析器 @typescript-eslint/eslint-plugin typescript eslint插件 # 安装依赖 yarn add @typescript-eslint/parser @typescript-eslint/eslint-plugin eslint-plugin-react -D # 此处eslint版本要求^6.6.0，版本不符会提示安装eslint@^6.6.0，后续版本可根据相关提示安装对应版本的eslint yarn add eslint@^6.6.0 -D /* 当前依赖版本 */ { \"devDependencies\": { \"@typescript-eslint/eslint-plugin\": \"^2.31.0\", \"@typescript-eslint/parser\": \"^2.31.0\", \"eslint\": \"^6.6.0\", \"eslint-plugin-react\": \"^7.19.0\" } } 增加.eslintignore，添加以下内容 config-overrides.js node_modules .eslintrc修改为以下@typescript-eslint/explicit-function-return-type：强制函数返回类型有声明，关闭@typescript-eslint/no-non-null-assertion：非空断言，关闭 { \"extends\": [ \"standard\", \"plugin:react/recommended\", \"plugin:@typescript-eslint/recommended\" ], \"env\": { \"browser\": true, \"commonjs\": true, \"node\": true, \"es6\": true }, \"parser\": \"@typescript-eslint/parser\", \"parserOptions\": { \"ecmaVersion\": 7, \"sourceType\": \"module\", \"ecmaFeatures\": { \"jsx\": true, \"legacyDecorators\": true } }, \"settings\": { \"react\": { \"version\": \"detect\" } }, \"plugins\": [ \"@typescript-eslint\", \"react\" ], \"rules\": { \"arrow-parens\": [ \"error\", \"as-needed\" ], \"object-curly-spacing\": [ 1, \"always\" ], \"@typescript-eslint/explicit-function-return-type\": [ \"off\" ], \"@typescript-eslint/no-non-null-assertion\": [ \"off\" ] } } 根目录创建paths.json增加别名（paths） { \"compilerOptions\": { \"baseUrl\": \"./\", \"paths\": { \"@/*\": [ \"src/*\" ] } } } 继承paths.json，识别定义别名paths直接写在tsconfig.json，项目启动会被重置装饰器（experimentalDecorators）支持tsconfig.json添加以下属性 { \"extends\": \"./paths.json\", \"compilerOptions\": { ··· \"experimentalDecorators\": true, ··· } ··· } 部分代码示例 // test.tsx，test组件 import React, { Component } from 'react' import { inject, observer } from 'mobx-react' interface Props { // mobx给count赋值，引用组件不用给count传值 count?: { num: number; add: Function; }; } @inject('count') @observer // 如果包含state，则需定义interface State，Component export default class Test extends Component { render () { // 使用非空断言（mobx一定会给count赋值） const { num, add } = this.props.count! return ( num -- {num} add()}>add ) } } // ---------------------------------------------------------- // App.tsx，App页面，使用test组件 import React, { Component } from 'react' import Test from '@/test' interface StateType { name: string; } export default class App extends Component { // 如果Props为{}，可不定义interface，直接Component，此时constructor (props: {}) {} constructor (props: {}) { super(props) // 定义state this.state = { name: 'name' } } render () { return ( {/* test组件可不传值 */} ) } } 相关问题 // eslint warning // Warning: React version not specified in eslint-plugin-react settings. // 在.eslintrc中添加以下内容，指定react版本即可 \"settings\": { \"react\": { \"version\": \"detect\" } } # 控制台警告 React-Hot-Loader: react-&#x1F525;-dom patch is not detected. React 16.6+ features may not work. # 同时配置了 react-hot-loader、@hot-loader/react-dom 不会出现该警告 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/vue-cli.html":{"url":"frontend/vue-cli.html","title":"Vue Cli","keywords":"","body":"Vue Cli 根据提示完成初始化项目后可以使用vue ui命令使用GUI界面管理项目默认配置可以满足绝大多数项目，非常方便如需进一步了解可参考vue-cli官方文档 配置 在项目根目录下添加vue.config.js文件，内容如下webpack-chain配置文档说明 const path = require('path') const resolve = dir => path.join(__dirname, dir) // 项目部署基础 // 默认情况下，我们假设你的应用将被部署在域的根目录下, // 例如：https://www.my-app.com/ // 默认：'/' // 如果您的应用程序部署在子路径中，则需要在这指定子路径 // 例如：https://www.foobar.com/my-app/ // 需要将它改为'/my-app/' const BASE_URL = process.env.NODE_ENV === 'production' ? '/' : '/' module.exports = { // Project deployment base // By default we assume your app will be deployed at the root of a domain, // e.g. https://www.my-app.com/ // If your app is deployed at a sub-path, you will need to specify that // sub-path here. For example, if your app is deployed at // https://www.foobar.com/my-app/ // then change this to '/my-app/' publicPath: BASE_URL, // tweak internal webpack configuration. // see https://github.com/vuejs/vue-cli/blob/dev/docs/webpack.md // 如果你不需要使用eslint，把lintOnSave设为false即可 lintOnSave: true, // 修改webpack配置 chainWebpack: config => { // 移除 prefetch 插件 config.plugins.delete('prefetch') // 别名 config.resolve.alias .set('@', resolve('src')) // key, value自行定义，比如.set('@@', resolve('src/components')) .set('_c', resolve('src/components')) }, // 设为false打包时不生成.map文件 productionSourceMap: false, // 这里写你调用接口的基础路径，来解决跨域，如果设置了代理，那你本地开发环境的axios的baseUrl要写为 '' ，即空字符串 devServer: { // 进度显示，关闭后可增加启动速度 progress: false, // 启动后打开浏览器 open: false, // 端口 port: 8009, // 跨域 proxy: { '/api/': { target: 'http://127.0.0.1:8008/', changeOrigin: true } } } } Eslint 在项目根目录下修改.eslintrc.js文件，内容如下 module.exports = { root: true, parserOptions: { parser: 'babel-eslint' }, env: { node: true }, extends: [ 'plugin:vue/essential', '@vue/standard' ], rules: { 'no-console': process.env.NODE_ENV === 'production' ? 'warn' : 'off', 'no-debugger': process.env.NODE_ENV === 'production' ? 'warn' : 'off', // 允许obj['key']的使用 'dot-notation': 'off', // 允许object key一个字符事使用引号 'quote-props': 'off' } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/js-utils.html":{"url":"frontend/js-utils.html","title":"Js Utils","keywords":"","body":"JS 常用工具方法 类型判断 日期格式化 秒格式化 时间转换为xx时间前 顺序执行Promise 隐藏手机号中间四位 限制数据框内容仅为数字 七牛上传 滚动条滚动动画 base64转file base64转blob blob转file blob转json 绑定事件 解绑事件 连字符转驼峰 驼峰转连字符 文件尺寸格式化 获取指定范围内的随机数 打乱数组 获取Url参数 切分数组 两数组差集 四舍五入到指定小数位 防抖 生成uuid Object合并 深拷贝 大文件切片上传 类型判断 // 以下为更精确的判断方式，某些场景下比使用 typeof & instanceof 更高效、准确 // 判断变量是注意非undefined，Object.prototype.toString.call(person) // person is not defined Object.prototype.toString.call(123) // '[object Number]' Object.prototype.toString.call('str') // '[object String]' Object.prototype.toString.call(true) // '[object Boolean]' Object.prototype.toString.call(null) // '[object Null]' Object.prototype.toString.call(undefined) // '[object Undefined]' Object.prototype.toString.call({}) // '[object Object]' Object.prototype.toString.call([]) // '[object Array]' Object.prototype.toString.call(() => {}) // '[object Function]' Object.prototype.toString.call(/reg/g) // '[object RegExp]' Object.prototype.toString.call(new Date()) // '[object Date]' Object.prototype.toString.call(Math) // '[object Math]' Object.prototype.toString.call(window) // '[object Window]' Object.prototype.toString.call(document) // '[object HTMLDocument]' Object.prototype.toString.call(10n) // '[object BigInt]' Object.prototype.toString.call(Symbol()) // '[object Symbol]' 日期格式化 /** * @description 日期格式化 * @description dateFormat(new Date(), 'yyyy-MM-dd EEE HH:mm:ss') // 2020-01-02 星期四 12:12:12 * @description dateFormat(new Date(), 'yyyy-MM-dd EE HH:mm:ss') // 2020-01-02 周四 12:12:12 * * @param {Date|String|Number} date 日期 * @param {String} fmt 格式 * @returns {String} 如：2020-01-02 12:12:12 */ export const dateFormat = (date, fmt = 'yyyy-MM-dd HH:mm:ss') => { if (!date) return '' // 不为Date类型进行处理 if (Object.prototype.toString.call(date) !== '[object Date]') { // 判断数字时间戳 if (!isNaN(date)) { // 10位时间戳转13位 date = date + '' if (date.length === 10) { date = +date * 1000 } else if (date.length === 13) { // 字符串时间戳转数字时间戳 date = +date } else { // 时间戳格式错误返回'' return '' } } else if (Object.prototype.toString.call(date) === '[object String]') { // ios无法使用yyyy-MM-dd HH:mm:ss转换为Date，需将 - 替换为 / date = date.replace(/-/g, '/') } date = new Date(date) if (isNaN(date)) return '' } const o = { 'M+': date.getMonth() + 1, // 月份 'd+': date.getDate(), // 日 'h+': date.getHours() % 12 === 0 ? 12 : date.getHours() % 12, // 小时 'H+': date.getHours(), // 小时 'm+': date.getMinutes(), // 分 's+': date.getSeconds(), // 秒 'q+': Math.floor((date.getMonth() + 3) / 3), // 季度 'S': date.getMilliseconds() // 毫秒 } // 星期 const week = ['日', '一', '二', '三', '四', '五', '六'] if (/(y+)/.test(fmt)) { fmt = fmt.replace(RegExp.$1, (date.getFullYear() + '').substr(4 - RegExp.$1.length)) } if (/(E+)/.test(fmt)) { fmt = fmt.replace(RegExp.$1, ((RegExp.$1.length > 1) ? (RegExp.$1.length > 2 ? '星期' : '周') : '') + week[+date.getDay()]) } for (const k in o) { if (new RegExp('(' + k + ')').test(fmt)) { fmt = fmt.replace(RegExp.$1, (RegExp.$1.length === 1) ? (o[k]) : (('00' + o[k]).substr(('' + o[k]).length))) } } return fmt } 秒格式化 /** * @description 秒格式化 * @description secondFormat(100000) // 1天3小时46分钟40秒 * * @param {Number} second 秒 * @param {String} format 格式化类型，'dhms'中一个或多个，不分先后顺序，如：ms: 分钟 秒，dms: 天 分钟 秒 * @returns {String} 如：1天3小时46分钟40秒 */ export const secondFormat = (second, format = 'dhms') => { if (!/d|h|m|s/.test(format)) { throw new Error('\\'format\\' argument must a string contains one or more of \\'dhms\\'.') } return [ { f: 'd', u: '天', p: 86400 }, { f: 'h', u: '小时', p: 3600 }, { f: 'm', u: '分钟', p: 60 }, { f: 's', u: '秒', p: 1 } ].reduce((strs, { f, u, p }) => { if (format.includes(f)) { const cur = Math.floor(second / p) if (cur > 0) { second = second % p strs.push(`${cur}${u}`) } } return strs }, []).join('') } 时间转换为xx时间前 /** * @description 时间转换为xx时间前 * @description getTimeInfo('2020-01-02 12:12:12') // 2月前 * * @param {Date|String|Number} date 时间 * @returns {String} 如：5天前 */ export const getTimeInfo = date => { if (!date) return '' // 不为Date类型进行处理 if (Object.prototype.toString.call(date) !== '[object Date]') { // 判断数字时间戳 if (!isNaN(date)) { // 10位时间戳转13位 date = date + '' if (date.length === 10) { date = +date * 1000 } else if (date.length === 13) { // 字符串时间戳转数字时间戳 date = +date } else { // 时间戳格式错误返回'' return '' } } else if (Object.prototype.toString.call(date) === '[object String]') { // ios无法使用yyyy-MM-dd HH:mm:ss转换为Date，需将 - 替换为 / date = date.replace(/-/g, '/') } date = new Date(date) if (isNaN(date)) return '' } const now = new Date() const diff = now.getTime() - date.getTime() // 现在的时间-传入的时间 = 相差的时间（单位 = 毫秒） if (diff 顺序执行Promise /** * @description 顺序执行 Promise * * function p1(){return new Promise((n,o)=>{setTimeout(()=>{console.warn(\"测试错误 1\"),o({msg:\"测试错误 1\"})},500)})} // 测试错误 1 * function p2(){return new Promise((n,o)=>{setTimeout(()=>{console.log(\"成功 2\"),n({msg:\"成功 2\"})},600)})} // 成功 2 * function p3(){return new Promise((n,o)=>{setTimeout(()=>{console.warn(\"测试错误 3\"),o({msg:\"测试错误 3\"})},300)})} // 测试错误 3 * function p4(){return new Promise((n,o)=>{setTimeout(()=>{console.log(\"成功 4\"),n({msg:\"成功 4\"})},400)})} // 成功 4 * function p5(){return new Promise((n,o)=>{setTimeout(()=>{console.warn(\"测试错误 5\"),o({msg:\"测试错误 5\"})},200)})} // 测试错误 5 * * const promises = [p1, p2, p3, p4, p5] * * promiseQueue(promises).then(console.log) * // 一次性返回结构数组 * // 0: {msg: \"测试错误 1\"} * // 1: {msg: \"成功 2\"} * // 2: {msg: \"测试错误 3\"} * // 3: {msg: \"成功 4\"} * // 4: {msg: \"测试错误 5\"} * * @param {Array} 返回Promise对象的待执行方法数组 * @returns {Array} 返回Promise对象，通过resolve获取顺序执行的结果（包含reject） */ export const promiseQueue = async promises => { const result = [] for (const promise of promises) { try { result.push(await promise()) } catch (error) { result.push(error) } } return Promise.resolve(result) } 隐藏手机号中间四位 /** * @description 手机号中间四位 * * * @param {String} phone 手机号 * @returns {String} 如：188****8888 */ export const hidePhone = phone => { if (!phone) return '' const arr = phone.split('') arr.splice(3, 4, '****') return arr.join('') } 限制数据框内容仅为数字 /** * @description 限制数据框内容仅为数字 * @description 校验、匹配规则可根据需求自定义，当前为保留正整数字符串 * * 某些情况下input[type=number]、InputNumber不能完全限制输入非数字字符使用 * * 以Element-ui Input为例，num可能为数组表单中的值，所以使用传值修改 * * inputCheck(val, formData)\" /> * * inputCheck (val, formData) { * formData.num = inputFilter(val) * } * * @param {String} val 输入字符 * @returns {String|Number} 过滤后数字字符串（正整数） */ export const inputFilter = val => { if (val) { const valArr = val.match(/[1-9]\\d*/g) if (valArr && valArr.length > 0) { val = valArr[0] } else { val = '' } } return val } /** * 整数，保留2位小数，最大100，最小0.01 * * arrangeValue (e) { * let { value } = e.target * // 此处对0 和 未输入完的小数不作处理 * if (+value === 0 || value.endsWith('.')) { * return * } * value = +inputFilter(value) * e.target.value = value * } */ const inputFilter = val => { if (+val >= 100) return 100 if (+val 0) { val = +valArr[0] } else { val = 1 } } return val } 七牛上传 import * as qiniu from 'qiniu-js' import Cookies from 'js-cookie' import uuid from 'uuid' import $http from '@/libs/request' /** * 七牛上传 * dependencies: { * qiniu-js, * uuid, * js-cookie * } * 图片处理（裁剪大小、缩略图等）https://developer.qiniu.com/dora/manual/3683/img-directions-for-use * * @param file 上传的文件 * @param next 上传中处理（进度条等） * * @param then 上传完成处理 * @param catch 上传错误处理 * * @return Promise */ // 相关参数 const UPTOKEN = '_UPTOKEN_' const REQUEST_URL = '/upload/v1/uptoken' const REGION = qiniu.region.z0 // 上传处理 const uploadHandler = (token, file, next, complete, error) => { // 文件类型 const typeArr = file.type.split('/') // uuid + .文件类型 const fileName = `${uuid()}.${typeArr[1]}` const observable = qiniu.upload(file, fileName, token, {}, { region: REGION }) observable.subscribe({ next ({ total }) { next && next(total) }, error (err) { error && error(err) }, complete (res) { complete && complete(res) } }) } // 获取token，上传 export default (file, next) => { let token = Cookies.get(UPTOKEN) return new Promise((resolve, reject) => { if (!token) { $http.request({ url: REQUEST_URL, method: 'post' }).then(({ code, data }) => { if (code === 1) { const date = new Date() date.setSeconds(date.getSeconds() + 3500) // uptoken失效前缓存 Cookies.set(UPTOKEN, data, { expires: date }) token = data uploadHandler(token, file, next, res => resolve(res), err => reject(err)) } else { reject(new Error('获取uptoken失败')) } }) } else { uploadHandler(token, file, next, res => resolve(res), err => reject(err)) } }) } 滚动条滚动动画 /** * @description 滚动条滚动动画 * @description scrollTo(window, 0, 1000) * * @param {HTMLDOM | window} el 滚动对象 * @param {Number} from 滚动开始位置 * @param {Number} to 滚动结束位置 * @param {Number} duration 间隔时间 * @param {Function} endCallback 动画结束回调 */ export const scrollTo = (el, from, to = 0, duration = 500, endCallback) => { if (!window.requestAnimationFrame) { window.requestAnimationFrame = ( window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame || function (callback) { return window.setTimeout(callback, 1000 / 60) } ) } const difference = Math.abs(from - to) const step = Math.ceil(difference / duration * 50) const scroll = (start, end, step) => { if (start === end) { endCallback && endCallback() return } let d = (start + step > end) ? end : start + step if (start > end) { d = (start - step scroll(d, end, step)) } scroll(from, to, step) } base64转file /** * @description base64转file * * @param {String} dataURL base64 * @param {String} filename 文件名（不带后缀），默认：当前时间戳 * @returns {File} 返回File对象 */ export const dataURLtoFile = (dataURL, filename = Date.now()) => { const arr = dataURL.split(',') const mime = arr[0].match(/:(.*?);/)[1] const typeArr = mime.split('/') if (typeArr && typeArr.length > 1) { filename = `${filename}.${typeArr[1]}` } const bstr = atob(arr[1]) let n = bstr.length const u8arr = new Uint8Array(n) while (n--) { u8arr[n] = bstr.charCodeAt(n) } return new File([u8arr], filename, { type: mime }) } base64转blob /** * @description base64转blob * * @param {String} dataURL base64 * @returns {Blob} 返回Blob对象 */ export const dataURLToBlob = dataURL => { const arr = dataURL.split(',') const mime = arr[0].match(/:(.*?);/)[1] const bstr = atob(arr[1]) let n = bstr.length const u8arr = new Uint8Array(n) while (n--) { u8arr[n] = bstr.charCodeAt(n) } return new Blob([u8arr], { type: mime }) } blob转file /** * @description blob转file * * @param {Blob} blob Blob对象 * @param {String} filename 文件名（不带后缀），默认：当前时间戳 * @returns {File} 返回File对象 */ export const blobToFile = (blob, filename = Date.now()) => { const typeArr = blob.type.split('/') if (typeArr && typeArr.length > 1) { filename = `${filename}.${typeArr[1]}` } return new File([blob], filename, { type: blob.type }) } blob转json /** * @description blob转json * * @param {Blob} blob Blob对象，type为 text/xml 或 application/json * @returns {Promise} 返回Promise对象，then(json => {}) */ export const blobToJson = blob => { return new Promise((resolve, reject) => { if (blob.size { try { resolve(JSON.parse(reader.result)) } catch (e) { reject(e) } } reader.readAsText(blob) } else { reject(new Error('blob type is not text/xml or application/json')) } }) } 绑定事件 /** * @description 绑定事件 eventOn(element, event, handler) * @description eventOn(window, 'scroll', this.scroll) * * @param {HTMLDOM | window} element 绑定对象 * @param {String} event 事件名称，如：scroll * @param {Function} handler 事件方法 */ export const eventOn = (function () { // ssr中使用注意服务端无效 if (typeof window === 'undefined') return if (document.addEventListener) { return function (element, event, handler) { if (element && event && handler) { element.addEventListener(event, handler, false) } } } else { return function (element, event, handler) { if (element && event && handler) { element.attachEvent('on' + event, handler) } } } })() 解绑事件 /** * @description 解绑事件 eventOff(element, event, handler) * @description eventOff(window, 'scroll', this.scroll) * * @param {HTMLDOM | window} element 解绑对象 * @param {String} event 事件名称，如：scroll * @param {Function} handler 事件方法 */ export const eventOff = (function () { // ssr中使用注意服务端无效 if (typeof window === 'undefined') return if (document.removeEventListener) { return function (element, event, handler) { if (element && event) { element.removeEventListener(event, handler, false) } } } else { return function (element, event, handler) { if (element && event) { element.detachEvent('on' + event, handler) } } } })() 连字符转驼峰 /** * @description 连字符转驼峰 * @description toCamelCase('hello_world', '_') // helloWorld * * @param {String} str 连字符字符串 * @param {String} separator 分隔符，默认为'-'，可不传 * @returns {String} 如：helloWorld */ export const toCamelCase = (str = '', separator = '-') => { if (Object.prototype.toString.call(str) !== '[object String]') { throw new Error('Argument must be a string') } if (str === '') { return str } const regExp = new RegExp(`\\\\${separator}(\\\\w)`, 'g') return str.replace(regExp, (matched, $1) => $1.toUpperCase()) } 驼峰转连字符 /** * @description 驼峰转连字符 * @description fromCamelCase('helloWorld', '_') // hello_world * * @param {String} str 驼峰字符串 * @param {String} separator 分隔符，默认为'-'，可不传 * @returns {String} 如：hello_world */ export const fromCamelCase = (str = '', separator = '-') => { if (Object.prototype.toString.call(str) !== '[object String]') { throw new Error('Argument must be a string') } if (str === '') { return str } return str.replace(/([A-Z])/g, `${separator}$1`).toLowerCase() } 文件尺寸格式化 /** * @description 文件尺寸格式化 * @description formatSize(10240000) // 9.77MB * * @param {String | Number} size 字节数 * @returns {String} 如：9.77MB */ export const formatSize = size => { if (Object.prototype.toString.call(size) !== '[object Number]') { throw new Error('Argument(s) is illegal !') } const unitsHash = 'B,KB,MB,GB,TB,PB,EB,ZB,YB'.split(',') let index = 0 while (size > 1024 && index 获取指定范围内的随机数 /** * @description 获取指定范围内的随机数 * @description getRandom(0, 10) // 9 * * @param {Number} min 最小范围，包含 * @param {Number} max 最大范围，包含 * @returns {Number} 如：9 */ export const getRandom = (min = 0, max = 100) => { if (Object.prototype.toString.call(min) !== '[object Number]' || Object.prototype.toString.call(max) !== '[object Number]') { throw new Error('Argument(s) is illegal !') } if (min > max) { [min, max] = [max, min] } return Math.floor(Math.random() * (max - min + 1) + min) } 打乱数组 /** * @description 打乱数组 * @description arrayShuffle([1, 2, 3]) // [2, 1, 3] * * @param {Array} array 待乱序数组 * @returns {Array} 如：[2, 1, 3] */ export const arrayShuffle = array => { if (!Array.isArray(array)) { throw new Error('Argument must be an array') } let end = array.length if (!end) { return array } while (end) { const start = Math.floor(Math.random() * end--); [array[start], array[end]] = [array[end], array[start]] } return array } 获取Url参数 /** * @description 获取Url参数，注意：获取的参数值均为String类型 * @description getUrlParam('f', 'https://www.baidu.com/s?ie=utf-8&f=8') // '8' * * @param {String} variable 需要获取的参数名，传空值或者null会获取参数Object * @param {String} url url，默认为当前url * @returns {Object | String | Null} 如：variable为空值或null：{ ie: 'utf-8', f: '8' }，未查找到的参数或url无参数返：null，variable有值查询具体参数返回String类型值 */ export const getUrlParam = (variable = '', url = window.location.href) => { if (url === '' || !url.includes('=')) return null const query = url.substr(url.lastIndexOf('?') + 1) const vars = query.split('&') if (!variable) { return vars.reduce((params, v) => { const pair = v.split('=') params[pair[0]] = pair[1] return params }, {}) } for (const v of vars) { const pair = v.split('=') if (pair[0] === variable) return pair[1] } return null } 切分数组 /** * @description 切分数组 * * const arr = [1, 2, 3, 4, 5, 6, 7, 8, 9] * splitArray(arr, 4) // [[1, 2, 3, 4], [5, 6, 7, 8], [9]] * * @param {Array} arr 带切分数组 * @param {Number} size 切分大小 * @returns {Array} 切分后数组 */ export const splitArray = (arr, size = 10) => Array.from({ length: Math.ceil(arr.length / size) }, (v, i) => arr.slice(i * size, i * size + size) ) 两数组差集 /** * @description 切分数组 * * arrayDiffSet([1, 2, 3], [1, 2, 4]) // [3, 4] * * @param {Array} arr1 * @param {Array} arr2 * @returns {Array} 两数组差集数组 */ export const arrayDiffSet = (a, b) => [...a, ...b].filter(x => !a.includes(x) || !b.includes(x)) 四舍五入到指定小数位 /** * @description 四舍五入到指定小数位 * * @param {Number} number 待转换数字 * @param {Number} decimals 小数位数 */ export const round = (number, decimals = 0) => Number(`${Math.round(`${number}e${decimals}`)}e-${decimals}`) 防抖 更多防抖、节流介绍可参照 /** * @description 防抖 * @param {Function} fn 具体执行方法 * @param {Number} delay 间隔时间，默认500毫秒 */ export const debounce = (fn, delay = 500) => { let timer return () => { timer && clearTimeout(timer) timer = setTimeout(() => fn && fn(), delay) } } 生成uuid /** * @description 生成uuid * @returns {String} uuid */ export const uuid = () => { const tmpUrl = URL.createObjectURL(new Blob()) const tmpUrlStr = tmpUrl.toString() URL.revokeObjectURL(tmpUrl) return tmpUrlStr.substring(tmpUrlStr.lastIndexOf('/') + 1) } Object合并 /** * @description Object合并 * @description 后面的Object覆盖合并到前面的Object * * @param {Object} target 合并目标对象 * @param {...Object} args 任意个待合并对象 */ export const merge = (target, ...args) => { return args.reduce((acc, cur) => Object.keys(cur).reduce((subAcc, key) => { const srcVal = cur[key] if (Object.prototype.toString.call(srcVal) === '[object Object]') { subAcc[key] = merge(subAcc[key] ? subAcc[key] : {}, srcVal) } else if (Array.isArray(srcVal)) { subAcc[key] = srcVal.map((item, idx) => { if (Object.prototype.toString.call(item) === '[object Object]') { const curAccVal = subAcc[key] ? subAcc[key] : [] return merge(curAccVal[idx] ? curAccVal[idx] : {}, item) } else { return item } }) } else { subAcc[key] = srcVal } return subAcc }, acc), target) } 深拷贝 /** * @description 深拷贝 * * @param {any} target 需要拷贝目标，任何值 * @param cache 使用WeakSet处理循环引用，默认即可，无需传值 * @returns {any} 新拷贝结果 */ export const deepClone = (target, cache = new WeakSet()) => { const type = typeof target // 拷贝基本类型值 if (!(target !== null && (type === 'object' || type === 'function'))) return target // 如果之前已经拷贝过该对象，直接返回该对象 if (cache.has(target)) return target // 将对象添加缓存 cache.add(target) const arrayTag = '[object Array]' const objectTag = '[object Object]' const mapTag = '[object Map]' const setTag = '[object Set]' const functionTag = '[object Function]' const boolTag = '[object Boolean]' const dateTag = '[object Date]' const numberTag = '[object Number]' const stringTag = '[object String]' const errorTag = '[object Error]' const symbolTag = '[object Symbol]' const regexpTag = '[object RegExp]' const tag = Object.prototype.toString.call(target) const Ctor = target.constructor let cloneTarget switch (tag) { case boolTag: case dateTag: cloneTarget = new Ctor(+target) break case numberTag: case stringTag: case errorTag: cloneTarget = new Ctor(target) break case objectTag: case mapTag: case setTag: cloneTarget = new Ctor() break case arrayTag: { const { length } = target const result = new target.constructor(length) if (length && typeof target[0] === 'string' && Object.hasOwnProperty.call(target, 'index')) { result.index = target.index result.input = target.input } cloneTarget = result } break case symbolTag: cloneTarget = Object(Symbol.prototype.valueOf.call(target)) break case regexpTag: { const result = new target.constructor(target.source, /\\w*$/.exec(target)) result.lastIndex = target.lastIndex cloneTarget = result } break } if (tag === mapTag) { target.forEach((value, key) => { cloneTarget.set(key, deepClone(value, cache)) }) return cloneTarget } if (tag === setTag) { target.forEach(value => { cloneTarget.add(deepClone(value, cache)) }) return cloneTarget } if (tag === functionTag) return target Reflect.ownKeys(target).forEach(key => { // 递归拷贝属性 cloneTarget[key] = deepClone(target[key], cache) }) return cloneTarget } 大文件切片上传 过程：1、实例化ChunkUpload对象2、使用load()方法加载文件并切片3、切片完成后自动开始上传切片文件4、切片文件上传完成后自动合并切片文件，合并后后端最好对新文件进行md5校验，后端对完整的文件进行后续处理5、完成上传 依赖spark-md5计算文件md5使用axios封装$http，可参照后端切片文件合并，可参照以下提供ts版本和js版本 //////////////////// ///TypeScript版本/// //////////////////// import SparkMD5 from 'spark-md5' import $http from './http' /** * 大文件切片上传 * * 注意：复合后缀，如：.tar.gz，需对fileSuffix变量初始化时进行判断 * * ------------------------------------------------------------------ * * // 实例化ChunkUpload对象 * const chunkUpload = new ChunkUpload(file, { * // uploadIndex: 0, * // chunkSize: 4 * 1024 * 1024, * next: (state: { loading: number, uploading: number, merging: number, uploadIndex: number, status: string }) => { * const { loading, uploading, merging, uploadIndex, status } = state * console.log(loading, uploading, merging, uploadIndex, status) * }, * success: (data: string, md5: string) => { * console.log(md5) * }, * error: (code: number, msg: string) => { * console.log(msg) * } * }) * // 调用load方法开始切片并上传 * chunkUpload.load() * * ------------------------------------------------------------------ * * @param file 上传的文件 * @param options.chunkSize 切片大小，默认：4 * 1024 * 1024 * @param options.uploadIndex 上传索引，用于初始化时的断点续传，默认：0 * @param options.next ({ loading, uploading, merging, uploadIndex, status }) => {} 上传进度， * loading：加载切片进度 * uploading：上传进度 * merging：合并进度 * uploadIndex：已上传索引，只有uploading状态才会改变 * status：状态'pending' | 'loading' | 'uploading' | 'merging' | 'finished' * @param options.success: (data, md5) => {} 上传成功回调，data：文件上传文件名，md5：文件md5 * @param options.error: (code, msg) => {} 上传错误回调，code：状态码，msg：错误信息 * * @function load 初始化之后，调用load开始上传 * @function stop 暂停上传，返回当前上传的切片索引 * @function proceed 继续上传 * * ------------------------------------------------------------------ * * @backend 后端上传切片参数 * @PathVariable(\"part\") String part, * @RequestParam(\"file\") MultipartFile file, * @RequestParam(\"md5\") String md5 * @backend 后端检查文件数量参数 * @PathVariable(\"md5\") String md5 * @backend 后端文件合并参数 * @PathVariable(\"md5\") String md5, * @RequestParam(\"chunks\") int chunks, * @RequestParam(\"suffix\") String suffix */ type StatusEnum = 'pending' | 'loading' | 'uploading' | 'merging' | 'finished' type NextFunction = (state: { loading: number, uploading: number, merging: number, uploadIndex: number, status: StatusEnum }) => void const CHECK_URL = (md5: string): string => `upload/v1/file/check/${md5}` const UPLOAD_URL = (i: number): string => `upload/v1/upload/chunk/${i}` const MERGE_URL = (md5: string): string => `upload/v1/file/merge/${md5}` export default class ChunkUpload { // 待处理文件 private file: File // 文件尺寸 private fileSize: number // 文件后缀 private fileSuffix: string // 切片大小 chunkSize: number // 切片数量 chunkCount: number // 取消上传标记 private isStop: boolean // 切片文件数组 private chunkList: Blob[] // MD5 md5: string // 实例化spark用于计算文件md5 private spark: SparkMD5.ArrayBuffer // 通过FileReader读取文件进行切分、计算文件md5 private fileReader: FileReader // 加载切片索引 private loadIndex: number // 上传切片索引 private uploadIndex: number // 上传状态 private status: StatusEnum // 上传进度 private next: NextFunction // 成功 private success: (data: string, md5: string) => void // 错误 private error: (code: number, msg: string) => void constructor (file: File, options?: { chunkSize?: number, uploadIndex?: number, next?: NextFunction, success?: (data: string, md: string) => void, error?: (code: number, msg: string) => void }) { const { name, size } = file this.file = file this.fileSize = size this.fileSuffix = name.substring(name.lastIndexOf('.')) this.chunkSize = +(options?.chunkSize || 4 * 1024 * 1024) this.chunkCount = Math.ceil(size / this.chunkSize) this.isStop = false this.chunkList = [] this.md5 = '' this.uploadIndex = +(options?.uploadIndex || 0) this.loadIndex = 0 this.spark = new SparkMD5.ArrayBuffer() this.fileReader = new FileReader() this.status = 'pending' this.next = options?.next || (() => null) this.success = options?.success || (() => null) this.error = options?.error || (() => null) // 初始化 this.init() } // 读取文件并进行切片 private init (): void { const { chunkCount, spark, fileReader, uploadIndex, status, next } = this // 设置进度 next({ loading: 0, uploading: 0, merging: 0, uploadIndex, status }) fileReader.onload = ({ target }) => { const { loadIndex, uploadIndex, status } = this let i: number = loadIndex // spark-md5读取当前片 spark.append(target?.result as ArrayBuffer) // 读取完之后，切片索引+1 i++ // 设置进度 next({ loading: +(i / chunkCount * 100).toFixed(1), uploading: 0, merging: 0, uploadIndex, status }) // 递归切片 if (i 0) { // 检查服务器临时目录已上传切片 this.check() } else { // 开始上传 this.upload() } } } } // 检查切片 private check (): void { const { md5, uploadIndex, error } = this axios.post(CHECK_URL(md5)).then(({ data, code, msg }) => { if (code === 1) { // 当前索引不大于存在数量 if (data >= uploadIndex) { this.upload() } else { this.uploadIndex = 0 this.upload() } } else { error(code, msg) } }).catch(err => error(-1, err.message)) } // 文件切片 load (): void { const { chunkSize, fileSize, file, loadIndex, fileReader, isStop } = this // 设置上传状态 this.status = 'loading' if (isStop) return const start: number = loadIndex * chunkSize const end: number = ((start + chunkSize) >= fileSize) ? fileSize : start + chunkSize const blob: Blob = file.slice(start, end) this.chunkList.push(blob) fileReader.readAsArrayBuffer(blob) } // 上传切片 private upload (): void { const { md5, chunkList, chunkCount, uploadIndex, isStop, status, next, error } = this // 取消上传 if (isStop) return // 当前上传切片索引 let i: number = uploadIndex // 拼装FormData对象，上传文件 const formData = new FormData() formData.append('file', chunkList[i]) formData.append('md5', md5) // 上传切片 axios.post(UPLOAD_URL(i), formData, { transformRequest: [(params: FormData, headers: { [key: string]: string }) => { headers = { // eslint-disable-line 'Content-Type': 'multipart/form-data' } return params }], onUploadProgress (e: { loaded: number, total: number }) { const { loaded, total } = e // 设置进度 next({ loading: 100, uploading: +((loaded / total + i) * 100 / chunkCount).toFixed(1), merging: 0, uploadIndex: i, status }) } }).then(({ code, msg }) => { if (code === 1) { i++ if (i error(-1, err.message)) } // 合并文件 private merge (): void { const { md5, chunkCount, uploadIndex, fileSuffix, isStop, status, next, success, error } = this // 取消上传 if (isStop) return next({ loading: 100, uploading: 100, merging: 0, uploadIndex, status }) axios.post(MERGE_URL(md5), { chunks: chunkCount, suffix: fileSuffix }).then(({ data, code, msg }) => { if (code === 1) { // 设置状态 this.status = 'finished' // 设置进度 next({ loading: 100, uploading: 100, merging: 100, uploadIndex, status: this.status }) // 上传完成回调，返回md5值 success(data, md5) } else { error(code, msg) } }).catch(err => error(-1, err.message)) } // 取消操作，返回当前已上传索引 stop (): number { this.isStop = true return this.uploadIndex } // 继续操作 proceed (): void { this.isStop = false const { chunkCount, status, loadIndex, uploadIndex } = this // 继续切片 if (status === 'loading' && loadIndex //////////////////// ///JavaScript版本/// //////////////////// import SparkMD5 from 'spark-md5' import $http from './http' /** * 大文件切片上传 * * 注意：复合后缀，如：.tar.gz，需对fileSuffix变量初始化时进行判断 * * ------------------------------------------------------------------ * * // 实例化ChunkUpload对象 * const chunkUpload = new ChunkUpload(file, { * // uploadIndex: 0, * // chunkSize: 4 * 1024 * 1024, * next: ({ loading, uploading, merging, uploadIndex, status }) => { * console.log(loading, uploading, merging, uploadIndex, status) * }, * success: (data, md5) => { * console.log(md5) * }, * error: (code, msg) => { * console.log(msg) * } * }) * // 调用load方法开始切片并上传 * chunkUpload.load() * * ------------------------------------------------------------------ * * @param file 上传的文件 * @param options.chunkSize 切片大小，默认：4 * 1024 * 1024 * @param options.uploadIndex 上传索引，用于初始化时的断点续传，默认：0 * @param options.next ({ loading, uploading, merging, uploadIndex, status }) => {} 上传进度， * loading：加载切片进度 * uploading：上传进度 * merging：合并进度 * uploadIndex：已上传索引，只有uploading状态才会改变 * status：状态'pending' | 'loading' | 'uploading' | 'merging' | 'finished' * @param options.success: (data, md5) => {} 上传成功回调，data：文件上传文件名，md5：文件md5 * @param options.error: (code, msg) => {} 上传错误回调，code：状态码，msg：错误信息 * * @function load 初始化之后，调用load开始上传 * @function stop 暂停上传，返回当前上传的切片索引 * @function proceed 继续上传 * * ------------------------------------------------------------------ * * @backend 后端上传切片参数 * @PathVariable(\"part\") String part, * @RequestParam(\"file\") MultipartFile file, * @RequestParam(\"md5\") String md5 * @backend 后端检查文件数量参数 * @PathVariable(\"md5\") String md5 * @backend 后端文件合并参数 * @PathVariable(\"md5\") String md5, * @RequestParam(\"chunks\") int chunks, * @RequestParam(\"suffix\") String suffix */ const CHECK_URL = md5 => `upload/v1/file/check/${md5}` const UPLOAD_URL = i => `upload/v1/upload/chunk/${i}` const MERGE_URL = md5 => `upload/v1/file/merge/${md5}` export default class ChunkUpload { constructor (file, options) { const { name, size } = file // 待处理文件 this.file = file // 文件尺寸 this.fileSize = size // 文件后缀 this.fileSuffix = name.substring(name.lastIndexOf('.')) // 切片大小 this.chunkSize = +(options && options.chunkSize ? options.chunkSize : 4 * 1024 * 1024) // 切片数量 this.chunkCount = Math.ceil(size / this.chunkSize) // 取消上传标记 this.isStop = false // 切片文件数组 this.chunkList = [] // MD5 this.md5 = '' // 加载切片索引 this.uploadIndex = +(options && options.uploadIndex ? options.uploadIndex : 0) // 上传切片索引 this.loadIndex = 0 // 实例化spark用于计算文件md5 this.spark = new SparkMD5.ArrayBuffer() // 通过FileReader读取文件进行切分、计算文件md5 this.fileReader = new FileReader() // 上传状态 'pending' | 'loading' | 'uploading' | 'merging' | 'finished' this.status = 'pending' // 上传进度 this.next = options && options.next ? options.next : () => null // (data, md5) => {} 上传成功回调，data：文件上传文件名，md5：文件md5 this.success = options && options.success ? options.success : () => null // (msg) => {} 上传错误回调，msg：错误信息 this.error = options && options.error ? options.error : () => null // 初始化 this.init() } // 读取文件并进行切片 init () { const { chunkCount, spark, fileReader, uploadIndex, status, next } = this // 设置进度 next({ loading: 0, uploading: 0, merging: 0, uploadIndex, status }) fileReader.onload = ({ target }) => { const { loadIndex, status } = this let i = loadIndex // spark-md5读取当前片 spark.append(target.result) // 读取完之后，切片索引+1 i++ // 设置进度 next({ loading: +(i / chunkCount * 100).toFixed(1), uploading: 0, merging: 0, uploadIndex, status }) // 递归切片 if (i 0) { // 检查服务器临时目录已上传切片 this.check() } else { // 开始上传 this.upload() } } } } // 检查切片 check () { const { md5, uploadIndex, error } = this $http.post(CHECK_URL(md5)).then(({ data, code, msg }) => { if (code === 1) { // 当前索引不大于存在数量 if (data >= uploadIndex) { this.upload() } else { this.uploadIndex = 0 this.upload() } } else { error(code, msg) } }).catch(err => error(-1, err.message)) } // 文件切片 load () { const { chunkSize, fileSize, file, loadIndex, fileReader, isStop } = this // 设置上传状态 this.status = 'loading' if (isStop) return const start = loadIndex * chunkSize const end = ((start + chunkSize) >= fileSize) ? fileSize : start + chunkSize const blob = file.slice(start, end) this.chunkList.push(blob) fileReader.readAsArrayBuffer(blob) } // 上传切片 upload () { const { md5, chunkList, chunkCount, uploadIndex, isStop, status, next, error } = this // 取消上传 if (isStop) return // 当前上传切片索引 let i = uploadIndex // 拼装FormData对象，上传文件 const formData = new FormData() formData.append('file', chunkList[i]) formData.append('md5', md5) // 上传切片 $http.post(UPLOAD_URL(i), formData, { transformRequest: [(params, headers) => { headers = { // eslint-disable-line 'Content-Type': 'multipart/form-data' } return params }], onUploadProgress ({ loaded, total }) { // 设置进度 next({ loading: 100, uploading: +((loaded / total + i) * 100 / chunkCount).toFixed(1), merging: 0, uploadIndex: i, status }) } }).then(({ code, msg }) => { if (code === 1) { i++ if (i error(-1, err.message)) } // 合并文件 merge () { const { md5, chunkCount, uploadIndex, fileSuffix, isStop, status, next, success, error } = this // 取消上传 if (isStop) return next({ loading: 100, uploading: 100, merging: 0, uploadIndex, status }) $http.post(MERGE_URL(md5), { chunks: chunkCount, suffix: fileSuffix }).then(({ data, code, msg }) => { if (code === 1) { // 设置状态 this.status = 'finished' // 设置进度 next({ loading: 100, uploading: 100, merging: 100, uploadIndex, status: this.status }) // 上传完成回调，返回md5值 success(data, md5) } else { error(msg) } }).catch(err => error(err.message)) } // 取消操作，返回当前已上传索引 stop () { this.isStop = true return this.uploadIndex } // 继续操作 proceed () { this.isStop = false const { chunkCount, status, loadIndex, uploadIndex } = this // 继续切片 if (status === 'loading' && loadIndex © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-09-09 "},"frontend/regular.html":{"url":"frontend/regular.html","title":"正则表达式","keywords":"","body":"正则表达式 常用正则表达式 // 手机号校验 /^1[3456789]\\d{9}$/ // 邮箱校验 /^\\w+((-\\w+)|(\\.\\w+))*@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z0-9]+$/ // 身份证号校验 /^[1-9]\\d{5}(18|19|20)\\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\\d{3}[0-9Xx]$/ // URL验证 /^(((ht|f)tps?):\\/\\/)?[\\w-]+(\\.[\\w-]+)+([\\w.,@?^=%&:/~+#-]*[\\w@?^=%&/~+#-])?$/ // 非负数 /^[+]?\\d+(\\.\\d+)?$/ // emoji表情验证 /(\\ud83c[\\udf00-\\udfff])|(\\ud83d[\\udc00-\\ude4f\\ude80-\\udeff])|[\\u2600-\\u2B55]/g // 密码校验，8-20位，字母、数字、特殊字符至少包含两种 /(?!^\\d+$)(?!^[A-Za-z]+$)(?!^[^A-Za-z0-9]+$)(?!^.*[\\u4E00-\\u9FA5].*$)^\\S{8,20}$/ // 密码校验，8-20位，必须包含大写字母、小写字母、数字、特殊符号(!@#$%&?*,.) /^(?=.*[0-9])(?=.*[A-Z])(?=.*[a-z])(?=.*[!@#$%&?*,.])[0-9a-zA-Z!@#$%&?*,.]{8,20}$/ © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/typescript.html":{"url":"frontend/typescript.html","title":"TypeScript","keywords":"","body":"TypeScript 部分错误解决方式 TS2683: 'this' implicitly has type 'any' because it does not have a type annotation using apply原文件中存在this的值是any的时候报错 // 报错代码 function rafThrottle> (fn: T): AnyFunction { let locked = false return function (...args: any[]) { if (locked) return locked = true window.requestAnimationFrame(() => { fn.apply(this, args) // TS2683: 'this' implicitly has type 'any' because it does not have a type annotation. locked = false }) } } // 将this指定为 any 或 unknown function rafThrottle> (fn: T): AnyFunction { let locked = false return function (this: any, ...args: any[]) { // 指定this类型为 any 或者 unknown if (locked) return locked = true window.requestAnimationFrame(() => { fn.apply(this, args) locked = false }) } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/eslint.html":{"url":"frontend/eslint.html","title":"ESLint","keywords":"","body":"ESLint ESLint是一个语法规则和代码风格的检查工具。项目中使用ESLint可以避免一些低级错误、格式错误，统一项目代码风格，更有利于团队协作等。开发工具中需添加ESLint扩展，如：VSCode中ESLint插件。个人更倾向于使用standard规范，以standard规范为例。 vite中使用ESLint vite版本为2.x，编辑器需要安装ESLint插件更多配置可参照 [掘金] 从 0 开始手把手带你搭建一套规范的 Vue3.x 项目工程环境 // 1、安装 ESLint yarn add eslint -D // 2、配置 ESLint，建议使用系统命令行执行该命令 yarn eslint --init // or npx eslint --init // 3、根据提示进行配置 // // (1) How would you like to use ESLint? （你想如何使用 ESLint?） // 选择 To check syntax, find problems, and enforce code style（检查语法、发现问题并强制执行代码风格） // (2) What type of modules does your project use?（你的项目使用哪种类型的模块?） // 选择 JavaScript modules (import/export) // (3) Which framework does your project use? （你的项目使用哪种框架?） // 选择 Vue.js // (4) Does your project use TypeScript?（你的项目是否使用 TypeScript?） // 选择 Yes // (5) Where does your code run?（你的代码在哪里运行?） // 选择 Browser 和 Node（按空格键进行选择，选完按回车键确定 // (6) How would you like to define a style for your project?（你想怎样为你的项目定义风格？） // 选择 Use a popular style guide（使用一种流行的风格指南） // (7) Which style guide do you want to follow?（你想遵循哪一种风格指南?） // 选择 Standard: https://github.com/standard/standard（根据个人喜好） // (8) What format do you want your config file to be in?（你希望你的配置文件是什么格式?） // 选择 JavaScript // (9) Would you like to install them now with npm?（你想现在就用 NPM 安装它们吗?） // 选择 No（稍后使用yarn自行安装） // // 会自动生成.eslintrc.js文件 // 4、安装其它依赖 // 使用TypeScript yarn add eslint-plugin-vue @typescript-eslint/eslint-plugin eslint-config-standard eslint-plugin-import eslint-plugin-node eslint-plugin-promise @typescript-eslint/parser -D // 不使用TypeScript // yarn add eslint-plugin-vue eslint-config-standard eslint-plugin-import eslint-plugin-node eslint-plugin-promise -D // 5、修改.eslintrc.js // 中编译器宏如defineProps和defineEmits被no-undef规则警告，需要配置globals // https://eslint.vuejs.org/user-guide/#compiler-macros-such-as-defineprops-and-defineemits-are-warned-by-no-undef-rule // 使用TypeScript module.exports = { env: { browser: true, es2021: true, node: true }, globals: { defineProps: 'readonly', defineEmits: 'readonly', defineExpose: 'readonly', withDefaults: 'readonly' }, extends: [ 'plugin:vue/vue3-essential', 'standard' ], parserOptions: { ecmaVersion: 2021, parser: '@typescript-eslint/parser', sourceType: 'module' }, plugins: [ 'vue', '@typescript-eslint' ], rules: { 'vue/no-multiple-template-root': 'off', 'vue/comment-directive': 'off', // 允许obj['key']的使用 'dot-notation': 'off', // 允许object key使用引号 'quote-props': 'off' }, settings: {} } // 不使用TypeScript /* module.exports = { env: { browser: true, es2021: true, node: true }, globals: { defineProps: 'readonly', defineEmits: 'readonly', defineExpose: 'readonly', withDefaults: 'readonly' }, extends: [ 'plugin:vue/vue3-essential', 'standard' ], parserOptions: { ecmaVersion: 2021, sourceType: 'module' }, plugins: [ 'vue' ], rules: { 'vue/no-multiple-template-root': 'off', 'vue/comment-directive': 'off', // 允许obj['key']的使用 'dot-notation': 'off', // 允许object key使用引号 'quote-props': 'off' }, settings: {} } */ create-react-app中使用ESLint create-react-app中使用ESLint，可参照 在Vuejs脚手架vue-cli@2.x.x 3.x.x 4.x.x中使用ESLint /** * 只需在构建项目时根据提示操作即可 */ // 1、构建项目时，Use ESLint to lint your code? Y // 2、Pick an ESLint preset，选择上下箭头选择Standard (https://github.com/standard/standard) 在Nuxtjs脚手架create-nuxt-app@2.x.x中使用ESLint // 1、构建项目时，Choose features to install，上下箭头+空格勾选Linter / Formatter这一项 // 2、去除不必要的依赖 yarn remove @nuxtjs/eslint-config -D // 3、安装依赖 yarn add eslint eslint-config-standard eslint-plugin-import eslint-plugin-node eslint-plugin-promise eslint-plugin-standard -D // 4、修改.eslintrc.js，添加、注释以下内容 module.exports = { ··· extends: [ // '@nuxtjs', ··· 'standard' ], ··· rules: { ··· // allow async-await 'generator-star-spacing': 'off', // allow debugger during development 'no-debugger': process.env.NODE_ENV === 'production' ? 'error' : 'off' } } Taro@1.3.0中使用报错 taro+typescript+mobx新版本会有解决 # 报错信息 54:22 error Parsing error: Unexpected token, expected \";\" 52 | } 53 | 54 | export default Index as ComponentType | ^ 解决方法 # 安装依赖 yarn add @typescript-eslint/eslint-plugin -D // .eslintrc中添加overrides { ··· \"overrides\": [ { \"files\": [\"**/*.ts?(x)\"], \"parser\": \"@typescript-eslint/parser\", \"parserOptions\": { \"ecmaVersion\": 2018, \"sourceType\": \"module\", \"ecmaFeatures\": { \"jsx\": true }, // typescript-eslint specific options \"warnOnUnsupportedTypeScriptVersion\": true }, \"plugins\": [\"@typescript-eslint\"], // If adding a typescript-eslint version of an existing ESLint rule, // make sure to disable the ESLint rule here. \"rules\": { // TypeScript\"s `noFallthroughCasesInSwitch` option is more robust (#6906) \"default-case\": \"off\", // \"tsc\" already handles this (https://github.com/typescript-eslint/typescript-eslint/issues/291) \"no-dupe-class-members\": \"off\", // \"tsc\" already handles this (https://github.com/typescript-eslint/typescript-eslint/issues/477) \"no-undef\": \"off\", // Add TypeScript specific rules (and turn off ESLint equivalents) \"@typescript-eslint/no-angle-bracket-type-assertion\": \"warn\", \"no-array-constructor\": \"off\", \"@typescript-eslint/no-array-constructor\": \"warn\", \"@typescript-eslint/no-namespace\": \"error\", \"no-use-before-define\": \"off\", \"@typescript-eslint/no-use-before-define\": [ \"warn\", { \"functions\": false, \"classes\": false, \"variables\": false, \"typedefs\": false } ], \"no-unused-vars\": \"off\", \"@typescript-eslint/no-unused-vars\": [ \"warn\", { \"args\": \"none\", \"ignoreRestSiblings\": true } ], \"no-useless-constructor\": \"off\", \"@typescript-eslint/no-useless-constructor\": \"warn\" } } ] } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/less.html":{"url":"frontend/less.html","title":"Less","keywords":"","body":"LESS css预处理语言 相关问题 1、less@3.x.x之后的版本，less中使用javascript报错 升级less到3.x.x的版本之后报错 // https://github.com/ant-design/ant-motion/issues/44 .bezierEasingMixin(); ^ Inline JavaScript is not enabled. Is it set in your options? in D:\\vscode\\iview-admin\\node_modules\\iview\\src\\styles\\color\\bezierEasing.less (line 110, column 0) 解决方法：开启javascript即可 { loader: \"less-loader\", options: { javascriptEnabled: true } } /** * vue-cli@3.x.x中解决方法，vue.config.js文件 */ module.exports = { css: { loaderOptions: { less: { javascriptEnabled: true } } } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/canvas.html":{"url":"frontend/canvas.html","title":"Canvas","keywords":"","body":"Canvas Canvas签名 提供原生js版本和vue版本 #canvasBox, #signImage { border: 1px solid #EEE; width: 300px; height: 200px; } 初始化 生成图片 清空画布 function drawCanvas(args) { this.el = 'canvas' this.saveEl = 'saveBtn' this.clearEl = 'clearBtn' this.width = document.documentElement.clientWidth || document.body.clientWidth this.height = 200 this.lineWidth = 2 this.color = '#000' this.backgroundColor = 'rgba(255, 255, 255, 0)' this.borderWidth = 1 this.borderColor = '#333' this.imageType = 'image/png' this.imageQual = 0.92 this.saveCallback = function (imgBase64, clearCanvas) { } this.clearCallback = function () { } for (var k in args) { this[k] = args[k] } // 获取canvas var canvas = document.getElementById(this.el) if (!canvas) { return } // 设置边框 if (this.borderWidth > 0 && this.width > this.borderWidth * 2) { this.width = this.width - this.borderWidth * 2 canvas.style.border = this.borderWidth + 'px solid' + this.borderColor } // 设置宽高 canvas.width = this.width canvas.height = this.height // 获取canvas context var cxt = canvas.getContext('2d') // canvas context相关设置 cxt.fillStyle = this.backgroundColor cxt.fillRect(0, 0, this.width, this.height) cxt.strokeStyle = this.color cxt.lineWidth = this.lineWidth cxt.lineCap = 'round' // 线条末端添加圆形线帽，减少线条的生硬感 cxt.lineJoin = 'round' // 线条交汇时为原型边角 // 利用阴影，消除锯齿 cxt.shadowBlur = 1 cxt.shadowColor = this.color cxt.font = 'bold 20px Arial' cxt.fillStyle = '#000' cxt.fillText('Canvas签名，在此处绘制', 30, 100) var isDraw = false // 是否绘制中，用于mousemove // 开始绘制 canvas.ontouchstart = function (e) { var touch = e.changedTouches[0] if (touch.target.tagName === 'CANVAS') { var rect = canvas.getBoundingClientRect() var offsetTop = rect.top var offsetLeft = rect.left cxt.beginPath() cxt.moveTo(touch.clientX - offsetLeft, touch.clientY - offsetTop) } } canvas.onmousedown = function (e) { if (e.target.tagName === 'CANVAS') { var rect = canvas.getBoundingClientRect() var offsetTop = rect.top var offsetLeft = rect.left isDraw = true cxt.beginPath() cxt.moveTo(e.clientX - offsetLeft, e.clientY - offsetTop) } } // 绘制中 canvas.ontouchmove = function (e) { e.stopPropagation() e.preventDefault() var touch = e.changedTouches[0] if (touch.target.tagName === 'CANVAS') { var rect = canvas.getBoundingClientRect() var offsetTop = rect.top var offsetLeft = rect.left cxt.lineTo(touch.clientX - offsetLeft, touch.clientY - offsetTop) cxt.stroke() } } canvas.onmousemove = function (e) { e.stopPropagation() e.preventDefault() if (isDraw) { if (e.target.tagName === 'CANVAS') { var rect = canvas.getBoundingClientRect() var offsetTop = rect.top var offsetLeft = rect.left cxt.lineTo(e.clientX - offsetLeft, e.clientY - offsetTop) cxt.stroke() if (e.clientX - offsetLeft = canvas.width - this.borderWidth * 2 || e.clientY - offsetTop = canvas.height - this.borderWidth * 2) { isDraw = false } } } }.bind(this) // 结束绘制 canvas.ontouchend = function () { cxt.closePath() } canvas.onmouseup = function mouseupHandle () { isDraw = false cxt.closePath() } // 清除画布 var clearBtn = document.getElementById(this.clearEl) if (clearBtn) { clearBtn.onclick = function () { cxt.clearRect(0, 0, canvas.width, canvas.height) cxt.fillStyle = this.backgroundColor cxt.fillRect(0, 0, this.width, this.height) this.clearCallback() }.bind(this) } // 保存图片 var saveBtn = document.getElementById(this.saveEl) if (saveBtn) { saveBtn.onclick = function () { var imgBase64 if (this.imageType === 'image/jpeg') { imgBase64 = canvas.toDataURL('image/jpeg', this.imageQual) } else { imgBase64 = canvas.toDataURL() } this.saveCallback(imgBase64, function () { cxt.clearRect(0, 0, canvas.width, canvas.height) }) }.bind(this) } } document.getElementById('initBtn').onclick = function () { new drawCanvas({ el: 'canvasBox', width: 300, height: 200, borderColor: '#EEE', saveCallback: function (imgBase64, clearCanvas) { document.getElementById('signImage').src = imgBase64 // 清空canvas // clearCanvas() }, clearCallback: function () { document.getElementById('signImage').src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=' } }) } window.onload = function () { setTimeout(function () { document.getElementById('initBtn').click() }, 300) } 1、原生JavaScript版本 利用canvas画布实现签名效果 /** * Canvas 签名 * * 使用： * new drawCanvas({ * saveCallback: function (imgBase64, clearCallback) { * document.getElementById('signImage').src = imgBase64 * // 清空canvas * // clearCallback() * } * }) * el：canvas容器id，默认：'canvas' * saveEl：保存按钮id，默认：'saveBtn' * clearEl：清除按钮id，默认：'clearBtn' * width：容器宽度，默认：浏览器宽度 * height：容器高度，默认：200 * color：画线颜色，默认：'#000' * backgroundColor：容器背景颜色颜色，默认：'rgba(255, 255, 255, 0)' * borderWidth：容器边框宽度，默认：1 * borderColor：容器边框颜色颜色，默认：'#333' * imageType：图片类型，默认：image/png（推荐），可选：image/jpeg（注意修改background；不推荐：清空画布再次绘制可能无法正常生成base64），image/webp（Chrome支持），其他类型均为image/png * imageQual：图片质量，当imageType为image/jpeg时生效，默认值：0.92，可选0~1之间，超出范围使用默认0.92 * saveCallback(imgBase64, clearCanvas)：保存回调(base64图片，清空画布) * clearCallback()：清空画布回调 */ function drawCanvas(args) { this.el = 'canvas' this.saveEl = 'saveBtn' this.clearEl = 'clearBtn' this.width = document.documentElement.clientWidth || document.body.clientWidth this.height = 200 this.lineWidth = 2 this.color = '#000' this.backgroundColor = 'rgba(255, 255, 255, 0)' this.borderWidth = 1 this.borderColor = '#333' this.imageType = 'image/png' this.imageQual = 0.92 this.saveCallback = function (imgBase64, clearCanvas) { } this.clearCallback = function () { } for (var k in args) { this[k] = args[k] } // 获取canvas var canvas = document.getElementById(this.el) if (!canvas) { return } // 设置边框 if (this.borderWidth > 0 && this.width > this.borderWidth * 2) { this.width = this.width - this.borderWidth * 2 canvas.style.border = this.borderWidth + 'px solid' + this.borderColor } // 设置宽高 canvas.width = this.width canvas.height = this.height // 获取canvas context var cxt = canvas.getContext('2d') // canvas context相关设置 cxt.fillStyle = this.backgroundColor cxt.fillRect(0, 0, this.width, this.height) cxt.strokeStyle = this.color cxt.lineWidth = this.lineWidth cxt.lineCap = 'round' // 线条末端添加圆形线帽，减少线条的生硬感 cxt.lineJoin = 'round' // 线条交汇时为原型边角 // 利用阴影，消除锯齿 cxt.shadowBlur = 1 cxt.shadowColor = this.color var isDraw = false // 是否绘制中，用于mousemove // 开始绘制 canvas.ontouchstart = function (e) { var touch = e.changedTouches[0] if (touch.target.tagName === 'CANVAS') { var rect = canvas.getBoundingClientRect() var offsetTop = rect.top var offsetLeft = rect.left cxt.beginPath() cxt.moveTo(touch.clientX - offsetLeft, touch.clientY - offsetTop) } } canvas.onmousedown = function (e) { if (e.target.tagName === 'CANVAS') { var rect = canvas.getBoundingClientRect() var offsetTop = rect.top var offsetLeft = rect.left isDraw = true cxt.beginPath() cxt.moveTo(e.clientX - offsetLeft, e.clientY - offsetTop) } } // 绘制中 canvas.ontouchmove = function (e) { e.stopPropagation() e.preventDefault() var touch = e.changedTouches[0] if (touch.target.tagName === 'CANVAS') { var rect = canvas.getBoundingClientRect() var offsetTop = rect.top var offsetLeft = rect.left cxt.lineTo(touch.clientX - offsetLeft, touch.clientY - offsetTop) cxt.stroke() } } canvas.onmousemove = function (e) { e.stopPropagation() e.preventDefault() if (isDraw) { if (e.target.tagName === 'CANVAS') { var rect = canvas.getBoundingClientRect() var offsetTop = rect.top var offsetLeft = rect.left cxt.lineTo(e.clientX - offsetLeft, e.clientY - offsetTop) cxt.stroke() if (e.clientX - offsetLeft = canvas.width - this.borderWidth * 2 || e.clientY - offsetTop = canvas.height - this.borderWidth * 2) { isDraw = false } } } }.bind(this) // 结束绘制 canvas.ontouchend = function () { cxt.closePath() } canvas.onmouseup = function mouseupHandle () { isDraw = false cxt.closePath() } // 清除画布 var clearBtn = document.getElementById(this.clearEl) if (clearBtn) { clearBtn.onclick = function () { cxt.clearRect(0, 0, canvas.width, canvas.height) cxt.fillStyle = this.backgroundColor cxt.fillRect(0, 0, this.width, this.height) this.clearCallback() }.bind(this) } // 保存图片 var saveBtn = document.getElementById(this.saveEl) if (saveBtn) { saveBtn.onclick = function () { var imgBase64 if (this.imageType === 'image/jpeg') { imgBase64 = canvas.toDataURL('image/jpeg', this.imageQual) } else { imgBase64 = canvas.toDataURL() } this.saveCallback(imgBase64, function () { cxt.clearRect(0, 0, canvas.width, canvas.height) }) }.bind(this) } } 使用 生成图片 清空画布 window.onload = function () { new drawCanvas({ el: 'canvasBox', saveEl: 'saveBtn', clearEl: 'clearBtn', width: 300, height: 200, saveCallback: function (imgBase64, clearCanvas) { document.getElementById('signImage').src = imgBase64 // 清空canvas // clearCanvas() }, clearCallback: function () { document.getElementById('signImage').src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=' } }) } 2、Vue.js版本 vue组件直接使用npm组件yarn add vue-canvas-sign or npm i vue-canvas-sign输出base64图片，如需转为file文件，可参照 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/debounce-throttle.html":{"url":"frontend/debounce-throttle.html","title":"防抖节流","keywords":"","body":"函数防抖(debounce)、函数节流(throttle) 函数防抖(debounce) 介绍：当调用动作n毫秒后，才会执行该动作，若在这n毫秒内又调用此动作则将重新计算执行时间场景：实时搜索（keyup）、拖拽（mousemove） /** * 未防抖 * ------------------------- * ^^^^^^^^^^^^^^^^^^^^^^^^^ * 防抖 * ------------------------- * ^ */ // ES6常用实现 const debounce = (fn, delay = 1000) => { let timer return () => { timer && clearTimeout(timer) timer = setTimeout(() => { fn && fn() }, delay) } } // 使用 window.onscroll = debounce(() => { console.log(document.documentElement.scrollTop) }, 500) 特殊使用 原理：JavaScript异步执行顺序场景：同步数据收集后统一处理其它：除了使用setTimeout宏任务达到异步效果，也可以使用Promise.resolve().then微任务 /** * @param {Function} completeFn 完成执行方法 * @returns {Function} * @param {Function} processFn 中间处理过程 */ const debounceCurrying = completeFn => { let processing = false return processFn => { if (!processing) { processing = true setTimeout(() => { processing = false completeFn && completeFn() }) } processFn && processFn() } } // 使用 const ids = [] const processHandle = debounceCurrying(() => { // 最终数据处理 console.log(ids) }) for (let i = 0; i { // 中间收集数据 ids.push(i) }) } 函数节流(throttle) 介绍：预先设定一个执行周期，当调用动作的时刻大于等于执行周期则执行该动作，然后进入下一个新周期窗口调整（resize）、页面滚动（scroll）、抢购疯狂点击（mousedown） /** * 未节流 * ------------------------- * ^^^^^^^^^^^^^^^^^^^^^^^^^ * 节流 * ------------------------- * ^ ^ ^ ^ ^ ^ ^ */ /** * ES6常用实现（1） -- 基于时间间隔 * 触发第一次，如需触发结束后时间间隔需加else setTimeout */ // 基础版 const throttle = (fn, delay = 100) => { let last = 0 return () => { const now = Date.now() if (now - last >= delay) { fn && fn() last = now } } } // 触发结束后时间间隔 const throttle = (fn, delay = 100) => { let last = 0 let timer return () => { const now = Date.now() timer && clearTimeout(timer) if (now - last >= delay) { fn && fn() last = now } else { timer = setTimeout(() => { fn && fn() }, delay) } } } /** * ES6常用实现（2） -- 基于setTimeout * 不会触发第一次 */ const throttle = (fn, delay = 100) => { let timer return () => { if (!!timer) { return false } else { timer = setTimeout(() => { fn && fn() timer && clearTimeout(timer) timer = null }, delay) } } } // 使用 window.onscroll = throttle(() => { console.log(document.documentElement.scrollTop) }, 1000) © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-08-23 "},"frontend/webpack.html":{"url":"frontend/webpack.html","title":"Webpack","keywords":"","body":"webpack webpack@^4.29.6为例，详细文档可以参考webpack中文文档 依赖 # babel，可以使用新版语法 @babel/core@^7.3.4 babel-loader@^8.0.5 html-webpack-plugin@^3.2.0 # webpack webpack@^4.29.6 # webpack4之前的版本webpack-cli在webpack里面，4开始，单独一个模块 webpack-cli@^3.2.3 # 开发，用于页面自动刷新 webpack-dev-server@^3.2.1 # webpack配置覆盖合并 webpack-merge@^4.2.1 webpack配置文件 const path = require('path') const HTMLWebpackPlugin = require('html-webpack-plugin') // 路径转换 function resolve(dir) { return path.join(__dirname, '.', dir) } // webpack配置 module.exports = { // webpack4必须指定模式 // 会将 process.env.NODE_ENV 的值设为 development。 // 启用 NamedChunksPlugin 和 NamedModulesPlugin mode: 'development', // 会将 process.env.NODE_ENV 的值设为 production。 // 启用 FlagDependencyUsagePlugin, FlagIncludedChunksPlugin, ModuleConcatenationPlugin, // NoEmitOnErrorsPlugin, OccurrenceOrderPlugin, SideEffectsFlagPlugin 和 UglifyJsPlugin // mode: 'production', // 入口文件 entry: resolve('src/index.js'), // 输出文件 output: { // 文件名 filename: '[name].js', // 文件目录 path: resolve('dist') }, // 模块 module: { // 处理规则 rules: [ { // 匹配js文件 test: /\\.js$/, // 使用babel处理，可以写新版js语法 use: 'babel-loader', // 匹配目录，只匹配根目录下src目录 include: resolve('src') } ] }, // 插件 plugins: [ // 用于处理html，将打包的js和css引用插入到index.html new HTMLWebpackPlugin({ // 标题 title: 'Webpack', // 模版 template: resolve('src/index.html'), // 给定的图标路径，可将其添加到输出html中 favicon: resolve('src/assets/favicon.ico') }) ], // webpack dev server 配置 devServer: { // 热替换 hot: true, // 指定使用一个 host。默认是 localhost // 如果希望服务器外部可访问\"0.0.0.0\"，但是在浏览器中会自动打开http://0.0.0.0:7890/ host: '127.0.0.1', // 端口 port: 7890, // 启动后自动在浏览器中打开 open: true } } package.json中配置相关命令 // --progress显示打包进度 --colors颜色高亮 --config制定配置文件 \"scripts\": { // 打包 \"build\": \"webpack --progress --colors --config webpack.prod.conf.js\", // 开发 \"dev\": \"webpack-dev-server --progress --colors --config webpack.dev.conf.js\" }, 运行 # 安装依赖 npm i # or cnpm i # or fast yarn # 开发运行 npm run dev # or yarn dev # 生产打包 npm run build # or yarn build 相关问题 1、使用域名访问开发阶段项目提示，如：微信公众号开发使用cpolar、natapp工具内网穿透访问Invalid Host header // 设置不检查hostname为true devServer: { disableHostCheck: true } // webpack-chain方式配置 config .devServer .disableHostCheck(true) © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/nuxtjs.html":{"url":"frontend/nuxtjs.html","title":"Nuxt.js","keywords":"","body":"Nuxt.js vue服务端渲染框架 相关问题 1、染服务器内容和客户端虚拟DOM不匹配 使用Nuxtjs时遇到的问题 [Vue warn]: The client-side rendered virtual DOM tree is not matching server-rendered content. This is likely caused by incorrect HTML markup, for example nesting block-level elements inside , or missing . Bailing hydration and performing full client-side render. /** * plugins/vue-carousel-card.js */ import Vue from 'vue' export default () => { if (!process.browser) return false // 只有在客户端渲染时引入组件并注册，问题出在此处，服务端和客户端不一致 const { CarouselCard, CarouselCardItem } = require('vue-carousel-card') Vue.component(CarouselCard.name, CarouselCard) Vue.component(CarouselCardItem.name, CarouselCardItem) } 解决方法（1） 使用包裹该组件 // Nuxt.js版本v2.9.0起使用标签 // no-ssr client-only CarouselCard(:interval=\"7000\" height=\"300px\" type=\"card\" arrow=\"always\") CarouselCardItem(v-for=\"i in 6\" :key=\"i\") h1(v-text=\"i\") 优点：方便快捷起效快，不需要对dependencies的vue组件，有特殊需求缺点：真的不会SSR 解决方法（2） 不区分服务端渲染还是客户端，直接引入并注册组件，以Nuxtjs为例 /** * @/plugins/vue-carousel-card.js */ import Vue from 'vue' import { CarouselCard, CarouselCardItem } from 'vue-carousel-card' export default () => { Vue.component(CarouselCard.name, CarouselCard) Vue.component(CarouselCardItem.name, CarouselCardItem) } /** * nuxt.config.js */ css: [ // 引入样式 'vue-carousel-card/styles/index.css' ], plugins: [ '@/plugins/vue-carousel-card' ] 但这样又会出现新的问题如：window is not defined、document is not defined 等问题需要进行判断，如果在服务端的情况下不去执行使用window或者document的代码 // 部分代码示例（1） import ResizeObserver from 'resize-observer-polyfill' const isServer = typeof window === 'undefined' const addResizeListener = el => { // 由于ResizeObserver中用到了document，此处直接跳过 if (isServer) return el.__ro__ = new ResizeObserver(resizeHandler) } // 部分代码示例（2） if(process && process.browser){ // 判断是客户端再执行 var FastClick = require('fastclick'); FastClick.attach(document.body); } 坑点在.vue文件中的样式最后经过webpack打包成js文件，会用到document（作用是将样式插入到文档） // 编译后的部分代码示例 function addStyle (obj /* StyleObjectPart */) { var update, remove var styleElement = document.querySelector('style[' + ssrIdKey + '~=\"' + obj.id + '\"]') if (styleElement) { if (isProduction) { // has SSR styles and in production mode. // simply do nothing. 解决方法，将样式分离，单独引入 优点：照样SSR缺点：对dependencies的vue组件有特殊要求 2、组件命名冲突导致内存溢出 错误信息 RangeError: Maximum call stack size exceeded at RegExp.[Symbol.replace] () at String.replace () at classify (commons.app.js:13279) at formatComponentName (commons.app.js:13317) at VueComponent.Vue._init (commons.app.js:17610) at new VueComponent (commons.app.js:17752) at createComponentInstanceForVnode (commons.app.js:15923) at init (commons.app.js:15754) at createComponent (commons.app.js:18576) at createElm (commons.app.js:18523) 相关vue组件代码，nuxt.js pages目录（相当于路由） // 引入组件 import List from '~/views/course/list' export default { name: 'List', // （1）该组件名称为List components: { List } // （2）注册于该组件同名的组件 } 因为（1）为该组件名称，引入并注册（2）使用的组件与之同名，导致（3）处使用时，会默认获取当前组件，导致服务端渲染时内存溢出 解决方法：该组件name属性和引用组件注册名称不能重名 tips: vue spa中不会导致内存溢出，如果注册组件和该组件name属性同名，优先调用该组件vue文档-name属性 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/amap-selector.html":{"url":"frontend/amap-selector.html","title":"高德vue地图选择器","keywords":"","body":"高德vue版地图选择器 UI 框架结合 iview@^3.3.0支持地址检索提示 地图配置 // 版本 // \"vue-amap\": \"^0.5.9\" // 引入 import VueAMap from 'vue-amap' // 注册 Vue.use(VueAMap) // 配置 VueAMap.initAMapApiLoader({ key: 'your key', plugin: [ 'Geocoder', 'Autocomplete', 'MarkerClusterer' ], // 默认高德 sdk 版本为 1.4.4 v: '1.4.4' }) map-selector 地图选择组件 组件使用 import MapSelector from './main' export default { components: { MapSelector }, data () { return { addr: { lng: '', lat: '', address: '' } } }, methods: { locationChange ({ address, areaCode, lat, lng }) { // 获取地图选择信息 } } } 实现代码 const dftLng = '116.403951' const dftLat = '39.913444' const dftAddr = '点击地图选择坐标' export default { name: 'mapSelector', props: { addr: Object }, data () { return { zoom: 13, center: [this.addr.lng || dftLng, this.addr.lat || dftLat], geocoder: null, autocomplete: null, placeSearch: null, keyword: '', infoVisible: true, marker: { position: [this.addr.lng || dftLng, this.addr.lat || dftLat], address: this.addr.address || dftAddr, events: { click: e => { this.infoVisible = true }, dragend: e => { this.codeToAdd([e.lnglat.lng, e.lnglat.lat], true) } } } } }, computed: { map () { return { events: { click: e => { this.codeToAdd([e.lnglat.lng, e.lnglat.lat]) } } } }, info () { let _this = this return { events: { close () { _this.infoVisible = false } } } } }, mounted () { this.$nextTick(() => { setTimeout(() => { this.geocoder = new window.AMap.Geocoder({ radius: 1000, extensions: 'all' }) this.autocomplete = new window.AMap.Autocomplete({ input: this.$refs.searchInput }) window.AMap.event.addListener(this.autocomplete, 'select', e => { this.codeToAdd([e.poi.location.lng, e.poi.location.lat]) }) }, 100) }) }, watch: { addr: { handler (val) { setTimeout(() => { if (val && !val.areaCode && val.lng && val.lat) { this.codeToAdd([val.lng, val.lat]) } }, 100) }, deep: true } }, methods: { codeToAdd (lnglat, isOffset) { this.geocoder && this.geocoder.getAddress(lnglat, (status, result) => { if (status === 'complete' && result.info === 'OK') { const rr = result.regeocode const add = rr.formattedAddress this.marker.position = [lnglat[0], lnglat[1]] this.marker.address = add this.$emit('location-info', { address: add, areaCode: rr.addressComponent.adcode, lat: lnglat[1], lng: lnglat[0] }) } }) } } } .map-container { width: 770px !important; height: 460px; padding-top: 40px; position: relative; .ivu-input-wrapper.ivu-input-type { position: absolute; top: 0 } } .amap-box { width: 100%; height: 100% } map-selector-modal 地图选择组件弹出框 组件使用 import { MapModal } from '@components/map-selector' export default { components: { MapModal }, data () { return { mapModal: false, addr: { lng: '', lat: '', address: '' } } }, methods: { locationChange ({ address, areaCode, lat, lng }) { // 获取地图选择信息 } } } 代码实现，基于上述组件 map-selector 确定 import MapSelector from './main' export default { name: 'mapModal', components: { MapSelector }, props: { value: Boolean, addr: Object }, data () { return { mapModal: this.value, location: this.addr } }, watch: { value (val) { this.mapModal = val }, mapModal (val) { this.$emit('input', val) } }, methods: { locationChange (val) { this.location = val }, confirm () { this.$emit('location-confirm', this.location) } } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/vue-quill-editor.html":{"url":"frontend/vue-quill-editor.html","title":"VueQuillEditor","keywords":"","body":"Vue-Quill-Editor（自定义使用） 基于Vue的Quill富文本编辑器自定义toolbar1、图片拖拽上传服务器后，在文本区域内添加图片2、图片弹窗上传选择，在文本区域内添加图片3、将样式默认使用class的替换为内联样式 div quillEditor( ref=\"editorRef\" v-model=\"content\" :options=\"editorOption\" @change=\"onContentChange\") div(:id=\"[toolbar]\" slot=\"toolbar\") span.ql-formats button.ql-bold(type=\"button\") span.ql-formats button.ql-italic(type=\"button\") span.ql-formats button.ql-underline(type=\"button\") span.ql-formats button.ql-strike(type=\"button\") span.ql-formats button.ql-blockquote(type=\"button\") span.ql-formats button.ql-code-block(type=\"button\") span.ql-formats button.ql-header(value=\"1\" type=\"button\") span.ql-formats button.ql-header(value=\"2\" type=\"button\") span.ql-formats button.ql-list(value=\"ordered\" type=\"button\") span.ql-formats button.ql-list(value=\"bullet\" type=\"button\") span.ql-formats button.ql-script(value=\"sub\" type=\"button\") span.ql-formats button.ql-script(value=\"super\" type=\"button\") //- 缩进无法使用内联样式代替class样式 //span.ql-formats button.ql-indent(value=\"-1\" type=\"button\") //span.ql-formats button.ql-indent(value=\"+1\" type=\"button\") //span.ql-formats button.ql-direction(value=\"rtl\" type=\"button\") span.ql-formats //- 默认字体大小 //select.ql-size option(value=\"small\") option(selected) option(value=\"large\") option(value=\"huge\") //- 自定义字体大小，需对应修改js中SizeStyle.whitelist，以及相关样式 select.ql-size option(value=\"12px\") 12px option(selected) 14px option(value=\"16px\") 16px option(value=\"18px\") 18px option(value=\"20px\") 20px option(value=\"22px\") 22px option(value=\"24px\") 24px option(value=\"26px\") 26px option(value=\"28px\") 28px option(value=\"30px\") 30px option(value=\"32px\") 32px span.ql-formats select.ql-header option(value=\"1\") option(value=\"2\") option(value=\"3\") option(value=\"4\") option(value=\"5\") option(value=\"6\") option(selected=\"selected\") span.ql-formats select.ql-color option(selected=\"selected\") option(value=\"#e60000\") option(value=\"#ff9900\") option(value=\"#ffff00\") option(value=\"#008a00\") option(value=\"#0066cc\") option(value=\"#9933ff\") option(value=\"#ffffff\") option(value=\"#facccc\") option(value=\"#ffebcc\") option(value=\"#ffffcc\") option(value=\"#cce8cc\") option(value=\"#cce0f5\") option(value=\"#ebd6ff\") option(value=\"#bbbbbb\") option(value=\"#f06666\") option(value=\"#ffc266\") option(value=\"#ffff66\") option(value=\"#66b966\") option(value=\"#66a3e0\") option(value=\"#c285ff\") option(value=\"#888888\") option(value=\"#a10000\") option(value=\"#b26b00\") option(value=\"#b2b200\") option(value=\"#006100\") option(value=\"#0047b2\") option(value=\"#6b24b2\") option(value=\"#444444\") option(value=\"#5c0000\") option(value=\"#663d00\") option(value=\"#666600\") option(value=\"#003700\") option(value=\"#002966\") option(value=\"#3d1466\") span.ql-formats select.ql-background option(value=\"#000000\") option(value=\"#e60000\") option(value=\"#ff9900\") option(value=\"#ffff00\") option(value=\"#008a00\") option(value=\"#0066cc\") option(value=\"#9933ff\") option(selected=\"selected\") option(value=\"#facccc\") option(value=\"#ffebcc\") option(value=\"#ffffcc\") option(value=\"#cce8cc\") option(value=\"#cce0f5\") option(value=\"#ebd6ff\") option(value=\"#bbbbbb\") option(value=\"#f06666\") option(value=\"#ffc266\") option(value=\"#ffff66\") option(value=\"#66b966\") option(value=\"#66a3e0\") option(value=\"#c285ff\") option(value=\"#888888\") option(value=\"#a10000\") option(value=\"#b26b00\") option(value=\"#b2b200\") option(value=\"#006100\") option(value=\"#0047b2\") option(value=\"#6b24b2\") option(value=\"#444444\") option(value=\"#5c0000\") option(value=\"#663d00\") option(value=\"#666600\") option(value=\"#003700\") option(value=\"#002966\") option(value=\"#3d1466\") span.ql-formats //- 默认字体 //select.ql-font option(selected=\"selected\") option(value=\"serif\") option(value=\"monospace\") //- 自定义字体，需对应修改js中FontStyle.whitelist，以及相关样式 select.ql-font option(selected=\"selected\") option(value=\"宋体\") 宋体 option(value=\"黑体\") 黑体 option(value=\"楷体\") 楷体 option(value=\"微软雅黑\") 微软雅黑 option(value=\"Arial\") Arial option(value=\"Verdana\") Verdana option(value=\"Georgia\") Georgia option(value=\"Times New Roman\") Times New Roman option(value=\"Microsoft JhengHei\") Microsoft JhengHei option(value=\"Trebuchet MS\") Trebuchet MS option(value=\"Courier New\") Courier New option(value=\"Impact\") Impact option(value=\"Comic Sans MS\") Comic Sans MS option(value=\"Consolas\") Consolas span.ql-formats select.ql-align option(selected=\"selected\") option(value=\"center\") option(value=\"right\") option(value=\"justify\") span.ql-formats button.ql-clean(type=\"button\") span.ql-formats button.ql-link(type=\"button\") span.ql-formats //- 自定义图片选择器 button(type=\"button\" @click=\"imgModal = true\") svg(viewBox=\"0 0 18 18\") rect.ql-stroke(height=\"10\" width=\"12\" x=\"3\" y=\"4\") circle.ql-fill(cx=\"6\" cy=\"7\" r=\"1\") polyline.ql-even.ql-fill(points=\"5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12\") span.ql-formats button.ql-video(type=\"button\") //- 使用iview modal Modal( v-model=\"imgModal\" title=\"选择图片\" :mask-closable=\"false\") div div(style=\"text-align: center\") input( ref=\"imgFileRef\" type=\"file\" style=\"display: none !important\" :accept=\"accept\" @change=\"imgFileChange\") div( ref=\"imgRef\" :style=\"`display: inline-block; width: 300px; height: 180px; border: 2px dashed; position: relative; border-color: ${ isDropImgOver ? '#666' : '#CCC' }`\" @click=\"$refs.imgFileRef.click()\") Progress( v-if=\"percent > 0 && percent import 'quill/dist/quill.core.css' import 'quill/dist/quill.snow.css' import 'quill/dist/quill.bubble.css' import _Quill from 'quill' import { quillEditor } from 'vue-quill-editor' // 默认图片类型 const allowType = { '.png': 'image/png', '.jpg': 'image/jpeg'/* , '.jpeg': 'image/jpeg', '.bmp': 'image/bmp', '.gif': 'image/gif', '.svg': 'image/svg+xml', '.tif': 'image/tiff' */ } /** * 对Quill的自定义修改 */ const Quill = window.Quill || _Quill // 将样式默认使用class的替换为内联样式 let SizeStyle = Quill.import('attributors/style/size') let FontStyle = Quill.import('attributors/style/font') let AlignStyle = Quill.import('attributors/style/align') // 自定义字体大小尺寸，需对应修改html中下拉框，以及相关样式 SizeStyle.whitelist = ['12px', '16px', '18px', '20px', '22px', '24px', '26px', '28px', '30px', '32px'] // 自定义字体类型，需对应修改html中下拉框，以及相关样式 FontStyle.whitelist = ['宋体', '黑体', '楷体', '微软雅黑', 'Arial', 'Verdana', 'Georgia', 'Times New Roman', 'Microsoft JhengHei', 'Trebuchet MS', 'Courier New', 'Impact', 'Comic Sans MS', 'Consolas'] Quill.register(SizeStyle, true) Quill.register(FontStyle, true) Quill.register(AlignStyle, true) export default { name: 'Editor', components: { quillEditor }, props: { value: String, placeholder: String }, data () { return { content: this.value, toolbar: '', imgModal: false, imgUrl: '', netImgUrl: '', isDropImgOver: false } }, computed: { editor () { return this.$refs.editorRef.quill }, accept () { return Object.keys(allowType).join(',') }, editorOption () { // 解决同一个组件中出现多个富文本id冲突的问题 let id = 'toolbar-' + Math.random().toString(16).substring(2) this.toolbar = id // eslint-disable-line return { placeholder: this.placeholder, modules: { toolbar: '#' + id } } } }, watch: { value (val) { if (this.editor && val !== this.content) this.content = val }, modal (val) { if (!val) { this.imgUrl = '' this.netImgUrl = '' } } }, mounted () { this.$nextTick(() => { /** * 拖拽上传图片并插入富文本 */ // 获取quillEditor中的editor let editor = this.$refs.editorRef.$refs.editor editor.ondragenter = e => this.dropInsertHandler(e) editor.ondragover = e => this.dropInsertHandler(e) editor.ondragleave = e => this.dropInsertHandler(e) editor.ondrop = e => { const files = e.dataTransfer.files if (files && files.length > 0) { this.fileUpload(files[0], this.insertImg) } this.dropInsertHandler(e) } /** * 图片选择器拖拽上传 */ let imgRef = this.$refs.imgRef imgRef.ondragenter = e => this.imgDropHandler(e) imgRef.ondragover = e => this.imgDropHandler(e) imgRef.ondragleave = e => this.imgDropHandler(e, false) imgRef.ondrop = (e) => { const files = e.dataTransfer.files if (files && files.length > 0) { this.fileUpload(files[0]) } this.imgDropHandler(e, false) } }) }, methods: { fileUpload (file, callback) { // 判断格式 // 判断大小 // ... // 上传图片并返回图片访问url // this.imgUrl = imgUrl // callback && callback() }, insertImg () { if (this.imgUrl) { this.editor.focus() this.editor.insertEmbed(this.editor.getSelection().index, 'image', this.imgUrl) this.modal = false } else alert('没有可用的图片！') }, onContentChange () { this.$emit('input', this.content) }, imgFileChange ({ target: { files } }) { if (files && files.length > 0) { this.fileUpload(files[0]) } }, imgDropHandler (e, isOver = true) { this.dropInsertHandler() this.isDropImgOver = isOver } dropInsertHandler (e) { e.preventDefault() // 阻止离开时的浏览器默认行为 e.stopPropagation() // 阻止冒泡 } } } .ql-container font-size 14px .ql-snow .ql-picker &.ql-size .ql-picker-item &[data-value=\"12px\"]::before font-size 12px &[data-value=\"16px\"]::before font-size 16px &[data-value=\"18px\"]::before font-size 18px &[data-value=\"20px\"]::before font-size 20px &[data-value=\"22px\"]::before font-size 22px &[data-value=\"24px\"]::before font-size 24px &[data-value=\"26px\"]::before font-size 26px &[data-value=\"28px\"]::before font-size 28px &[data-value=\"30px\"]::before font-size 30px &[data-value=\"32px\"]::before font-size 32px &.ql-font .ql-picker-item &[data-value=\"宋体\"]::before font-family '宋体' &[data-value=\"黑体\"]::before font-family '黑体' &[data-value=\"楷体\"]::before font-family '楷体' &[data-value=\"微软雅黑\"]::before font-family '微软雅黑' &[data-value=\"Arial\"]::before font-family 'Arial' &[data-value=\"Verdana\"]::before font-family 'Verdana' &[data-value=\"Georgia\"]::before font-family 'Georgia' &[data-value=\"Times New Roman\"]::before font-family 'Times New Roman' &[data-value=\"Microsoft JhengHei\"]::before font-family 'Microsoft JhengHei' &[data-value=\"Trebuchet MS\"]::before font-family 'Trebuchet MS' &[data-value=\"Courier New\"]::before font-family 'Courier New' &[data-value=\"Impact\"]::before font-family 'Impact' &[data-value=\"Comic Sans MS\"]::before font-family 'Comic Sans MS' &[data-value=\"Consolas\"]::before font-family 'Consolas' © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/chrome-download.html":{"url":"frontend/chrome-download.html","title":"Chrome文件下载","keywords":"","body":"Chrome浏览器文件下载 图片下载 /** * src 图片链接 * filename 下载图片命名 * ext 图片格式，png jpg */ function downloadImg (src, filename, ext) { const img = new Image() const canvas = document.createElement('canvas') const ctx = canvas.getContext('2d') const link = document.createElement('a') img.setAttribute('crossOrigin', 'anonymous') // 设置允许跨域访问 img.onload = () => { canvas.width = img.width canvas.height = img.height ctx.drawImage(img, 0, 0, img.width, img.height) link.setAttribute('href', canvas.toDataURL('image/' + ext)) link.setAttribute('target', '_blank') link.setAttribute('download', filename + '.' + ext) link.click() } img.src = src } Excel下载 后端通过输出流导出Excel，前端下载文件，后端Java代码可参照。 xlsx类型 // 以 axios 为例，需要设置响应参数类型为 blob axios.get('/v1/export', { responseType: 'blob' }).then(({ status, data, headers }) => { if (status === 200) { const url = window.URL.createObjectURL(new Blob([data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8' })) let [, filename] = (headers['content-disposition'] || '').split('filename=') filename = decodeURIComponent(filename || '') || 'export.xlsx' const link = document.createElement('a') link.href = url link.setAttribute('download', filename) link.click() // 回收URL window.URL.revokeObjectURL(url) } }) xls类型 // 以 axios 为例，需要设置响应参数类型为 blob axios.get('/v1/export', { responseType: 'blob' }).then(({ status, data, headers }) => { if (status === 200) { const url = window.URL.createObjectURL(new Blob([data], { type: 'application/vnd.ms-excel;charset=UTF-8' })) let [, filename] = (headers['content-disposition'] || '').split('filename=') filename = decodeURIComponent(filename || '') || 'export.xls' const link = document.createElement('a') link.href = url link.setAttribute('download', filename) link.click() // 回收URL window.URL.revokeObjectURL(url) } }) © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"frontend/snippet.html":{"url":"frontend/snippet.html","title":"代码片段收藏","keywords":"","body":"前端代码片段收藏 1、同时生成条码二维码2、批量下载图片3、导出Excel4、解析Excel，修改后导出5、vue-router@3.x部署更新提示6、vue指令，右键打开数字软键盘7、ElementUI-Table，列拖拽排序8、ElementUI-Table，自定义列组件9、ElementUI-Table，嵌套表格10、Echarts地图下钻 1、同时生成条码二维码 使用jsbarcode生成条形码，qrcode生成二维码使用canvas合并生成的条形码、二维码 import JsBarCode from 'jsbarcode' import QRCode from 'qrcode' /** * 生成条码Promise，仅条形码可以生成内容 */ const getBarCodePromise = code => { return new Promise((resolve, reject) => { try { const canvas = document.createElement('canvas') // 根据字符长度计算条码高度 let h = code.length * 80 if (h > 360) h = 360 else if (h { // 图片加载完之后resolve resolve(img) } img.src = canvas.toDataURL('image/png') } catch (error) { reject(error) } }) } /** * 生成二维码Promise */ const getQrCodePromise = code => { return new Promise((resolve, reject) => { try { // 生成base64 QRCode.toDataURL(code, { errorCorrectionLevel: 'H', version: 4, maskPattern: 7, margin: 1, width: 500 }, (e, url) => { // 生成图片对象 const img = new Image() img.setAttribute('crossOrigin', 'anonymous') // 设置允许跨域访问 img.onload = () => { // 图片加载完之后resolve resolve(img) } img.src = url }) } catch (error) { reject(error) } }) } /** * 合并生成条码二维码图片并返回base64图片 * @param {String} code * @return {String} base64 */ export default code => { // 生成条码，并加载到Image对象中resolve const barCodePromise = getBarCodePromise(code) // 生成二维码，并加载到Image对象中resolve const qrCodePromise = getQrCodePromise(code) // 合并图片 return new Promise((resolve, reject) => { Promise.allSettled([barCodePromise, qrCodePromise]).then(([{ value: barImg }, { value: qrImg }]) => { try { if (barImg && qrImg) { // 使用canvas合并图片 const canvas = document.createElement('canvas') const ctx = canvas.getContext('2d') canvas.width = barImg.width canvas.height = barImg.height + barImg.width // 竖向排列条码、二维码 ctx.drawImage(barImg, 0, 0, barImg.width, barImg.height) ctx.drawImage(qrImg, 0, barImg.height, barImg.width, barImg.width) // 生成图片url const url = canvas.toDataURL('image/png') // resolve合并后base64 resolve(url) } else { reject(new Error(`生成二维码失败：${code}`)) } } catch (error) { reject(error) } }).catch(reject) }) } 2、批量下载图片 使用jszip批量下载图片zip文件 import ZIP from 'jszip' import drawCode from './draw-code' // 1 中生成图片base64的方法 export default = codeArr => { // loading start const zip = new ZIP() const promises = codeArr.map(code => new Promise((resolve, reject) => { // 图片生成base64，此处使用 1 中方法，也可通过canvas的toDataURL将图片转为base64 drawCode(code).then(url => { const [, data] = url.split(',') // zip.file第一个参数为key，不能重复 zip.file(`条码二维码/${code}_条形码_二维码.png`, data, { base64: true }) resolve() }).catch(reject) })) Promise.all(promises).then(() => { zip.generateAsync({ type: 'blob' }).then(data => { const url = window.URL.createObjectURL(data) const link = document.createElement('a') link.href = url link.setAttribute('download', '批量生成条码二维码.zip') link.click() // 回收URL window.URL.revokeObjectURL(url) }) }).finally(() => { // loading end }) } 3、导出Excel 使用xlsx导出excel并将数据每60000条切分，单独生成一个sheet页splitArray切分数组可参照 import XLSX from 'xlsx' /** * 导出Excel */ export const exportExcel = (data, name) => { if (!name) name = `${Date.now()}.xlsx` const wb = XLSX.utils.book_new() const ws = XLSX.utils.aoa_to_sheet(data) XLSX.utils.book_append_sheet(wb, ws, 'SheetJS') XLSX.writeFile(wb, name) } /** * 导出Excel，多sheet页 */ export const exportExcel = (datas, name) => { if (!name) name = `${Date.now()}.xlsx` const wb = XLSX.utils.book_new() const sheets = Object.keys(datas) for (const s of sheets) { const ws = XLSX.utils.aoa_to_sheet(datas[s]) XLSX.utils.book_append_sheet(wb, ws, s) } XLSX.writeFile(wb, name) } /** * 导出excel，超过60000条自动分sheet页 * @param {*} data * @param {*} name */ export const exportExcel = (data, name) => { if (!name) name = `${Date.now()}.xlsx` const wb = XLSX.utils.book_new() const header = data[0] const arr = splitArray(data, 60000) for (let i = 0; i 0) { d.unshift(header) } const ws = XLSX.utils.aoa_to_sheet(d) XLSX.utils.book_append_sheet(wb, ws, `Sheet${i + 1}`) } XLSX.writeFile(wb, name) } 4、解析Excel，修改后导出 使用excel公式 { t:'n', f: 'excel公式' }使用excel公式导出后需要启用编辑公式才能生效 /* */ import XLSX from 'xlsx' const formWrap = document.getElementById('formWrap') const keys = ['id', 'productCode', 'printePrice', 'paperPrice', 'totalPrice', 'totalTechfee', '误差'] function dataArrange (items, arr) { arr.forEach((item, index) => { try { const reqinfo = JSON.parse(item.reqinfo) const resinfo = JSON.parse(item.resinfo) const { productCode } = reqinfo.data const { printePrice, paperPrice, totalPrice, totalTechfee } = resinfo.data items.push([ item.id, productCode, printePrice, paperPrice, totalPrice, totalTechfee, { t:'n', f: `=ROUND(E${index + 2}-C${index + 2}-D${index + 2}-F${index + 2}, 2)` } // 使用excel公式 ]) } catch (error) { } }) } document.getElementById('fileInput').onchange = e => { const [file] = e.target.files if (!file) return const reader = new FileReader() reader.onload = ({ target }) => { const data = new Uint8Array(target.result) const workbook = XLSX.read(data, { type: 'array' }) // 读取excel文件 const worksheet = workbook.Sheets[workbook.SheetNames[0]] // 取第一个sheet页 const dataArr = XLSX.utils.sheet_to_json(worksheet) // 将数据转为json const items = [keys] dataArrange(items, dataArr) exportExcel(items, file.name) // 上面 3 中导出excel setTimeout(() => formWrap.reset(), 1) // 重置表单情况input file } reader.readAsArrayBuffer(file) } 5、vue-router@3.x部署更新提示 vue-router@3.x中检测网络异常提示加载资源失败时，提示重新加载（结合Element-UI） this.$router.push({ name, params, query }).catch(e => { if (!navigator.onLine) { this.$msg.warning('网络异常，请检查网络连接！') return } /^Loading.*?failed./i.test(e.message) && this.$confirm('系统已更新，需要刷新重新加载页面！', '提示', { type: 'warning', confirmButtonText: '刷新', showCancelButton: false, closeOnHashChange: false }).then(() => { location.reload() }).catch(() => {}) }) 6、vue指令，右键打开数字软键盘 数字软键盘指令，配合ElementUI InputNumber、Input组件使用注册指令：Vue.directive('num-input', NumInput)使用指令： import Vue from 'vue' import NumBox from './main.vue' const NumBoxConstructor = Vue.extend(NumBox) // 软键盘实例，只生成一个到body let instance const initInstance = () => { instance = new NumBoxConstructor({ el: document.createElement('div') }) document.body.appendChild(instance.$el) } export default { bind (el, binding, vnode) { if (!instance) { initInstance() } // 右键打开数字软键盘，触摸设备长按激活 el.addEventListener('contextmenu', e => { e.preventDefault() const { top, left, height } = el.getBoundingClientRect() instance.position = { top: top + height, left } instance.vnode = vnode.child instance.value = vnode.child.value || '' setTimeout(() => { instance.visible = true }, 1) }) } } inputHandle(s)\"> import store from '@/store' export default { name: 'NumBox', computed: { positionStyle ({ position }) { const { allWidth } = store.state.app.screen let { top, left } = position if (allWidth - left 1) { this.value = val.substring(0, val.length - 1) } else { // 如果仅剩一个字符摁退格键时直接清空 this.value = '' } }, // 关闭数字软键盘 closeHandle () { this.visible = false if (!this.vnode) return const { blur, focus, setCurrentValue } = this.vnode if (!setCurrentValue) { focus && focus() setTimeout(() => { blur && blur() this.vnode = null }, 100) } else { this.vnode = null } }, // esc 关闭软键盘 escapeHandle (e) { if (e.code === 'Escape') { this.closeHandle() } }, // 数字软键盘点击时阻止冒泡，防止触发body事件关闭 clickHandle (e) { e.stopPropagation() } } } .num-box-container { position: fixed; z-index: 5000; padding: 6px; background-color: #FFF; border-radius: 4px; box-shadow: 1px 2px 4px 2px rgba(0, 0, 0, .2); .show-box { height: 34px; line-height: 34px; margin-bottom: 6px; overflow: hidden; font-size: 16px; font-weight: 600; width: 192px; display: flex; justify-content: flex-end; border: 1px solid #EEE; box-sizing: border-box; padding: 0 6px; user-select: none; span { text-align: right; } } .input-box { display: grid; grid-template-columns: repeat(3, 60px); grid-template-rows: repeat(4, 40px); grid-gap: 6px; } .operate-box { margin-top: 6px; display: grid; grid-template-columns: repeat(2, 93px); grid-template-rows: repeat(1, 32px); grid-gap: 6px; button { padding: 0; } } button { margin: 0; font-size: 18px; font-weight: 600; } } .num-box-fade-enter-active { -webkit-animation: num-box-fade-in .3s; animation: num-box-fade-in .3s; } .num-box-fade-leave-active { -webkit-animation: num-box-fade-out .3s; animation: num-box-fade-out .3s; } @-webkit-keyframes num-box-fade-in { 0% { opacity: 0; } 100% { opacity: 1; } } @keyframes num-box-fade-in { 0% { opacity: 0; } 100% { opacity: 1; } } @-webkit-keyframes num-box-fade-out { 0% { opacity: 1; } 100% { opacity: 0; } } @keyframes num-box-fade-out { 0% { opacity: 1; } 100% { opacity: 0; } } 7、ElementUI-Table，列拖拽排序 handleMouseDown(e, column)\" @mousemove=\"e => handleMouseMove(e, column)\"> /** * slot=\"before\" header渲染位置之前 * slot=\"after\" header渲染位置之后 * @drag-complete=\"dragComplete\" 返回新的header数据，可在页面初始化时赋值给header */ /* const columns = [ { prop: 'a', label: 'AA', width: '130' }, { prop: 'b', label: 'BB', className: 'user-select-all', width: '120' }, { prop: 'c', label: 'CC', width: '130' } ] detail(scope)\">查看 */ // 初始化拖拽状态对象 const dragState = { start: NaN, // 起始元素的 index end: NaN, // 移动鼠标时所覆盖的元素 index dragging: false, // 是否正在拖动 direction: undefined // 拖动方向 } export default { name: 'DragTable', computed: { // before插槽数量 beforeLength ({ $slots }) { return ($slots.before && $slots.before.length) || 0 } }, props: { // 表格数据 data: { type: Array, default: () => [] }, // colums数据[{ width: 150, prop: '', label: '', className: '' }] // width -> TableColumn min-width // className -> TableColumn class-name // indexHandle -> TableColumn type=\"index\" 索引生成方法 header: { type: Array, default: () => [] }, // 数据loading状态 loading: { type: Boolean, default: false }, // 是否显示表格边框，默认显示 border: { type: Boolean, default: true }, // 表格高度 height: { type: Number, default: 100 }, // 是否显示汇总行，默认false不显示 showSummary: { type: Boolean, default: false }, // 汇总方法，showSummary 为true，需设置 summaryMethod: { type: Function, default: ({ columns }) => columns.map(() => '') }, // 行样式 rowClassName: { type: Function, default: () => '' } }, data () { return { tableHeader: this.header, dragState: { ...dragState } } }, watch: { header (val) { // 传入的header数据同步到当前tableHeader，解决不定列的问题 this.tableHeader = val } }, methods: { // 触发表格doLayout，可以直接通过DragTable的ref属性获取组件后调用 doLayout () { this.$refs.tableRef.doLayout && this.$refs.tableRef.doLayout() }, // 表格双击事件 tableDbClickHandle (row, column) { this.$emit('cell-dblclick', { row, column }) }, // 右键菜单事件 rowContextmenuHandle (row, column, e) { this.$emit('row-contextmenu', { row, column, e }) }, // 按下鼠标开始拖动 handleMouseDown (e, { columnKey }) { this.dragState.dragging = true this.dragState.start = +columnKey // 给拖动时的虚拟容器添加宽高 const table = this.$refs.tableRef.$el const virtual = table.querySelectorAll('.table-virtual') // 计算滚动条向右滑动，左侧滚动量 const { scrollLeft } = table.querySelector('.el-table__header-wrapper') for (const item of virtual) { item.style.height = `${table.clientHeight - 1}px` item.style.width = `${item.parentElement.parentElement.clientWidth}px` item.style.marginLeft = `${-scrollLeft - 1}px` } document.addEventListener('mouseup', this.handleMouseUp) }, // 鼠标放开结束拖动 handleMouseUp () { this.dragColumn(this.dragState) // 初始化拖动状态 this.dragState = { ...dragState } document.removeEventListener('mouseup', this.handleMouseUp) }, // 拖动中 handleMouseMove (e, { columnKey }) { if (this.dragState.dragging) { // 记录起始列 const index = +columnKey if (index - this.dragState.start !== 0) { // 判断拖动方向 this.dragState.direction = index - this.dragState.start min && i .drag-table { .el-table .drag-start { background-color: #f3f3f3; } .el-table .el-table__header-wrapper { th { padding: 0; .table-header-label { padding: 8px 0; } .table-virtual{ position: fixed; display: block; width: 0; height: 0; background: none; border: none; } &.drag-active-left { .table-virtual { border-left: 2px dotted #666; z-index: 99; } } &.drag-active-right { .table-virtual { border-right: 2px dotted #666; z-index: 99; } } } div.cell { padding: 0 !important; position: relative; } .thead-cell { padding: 0; display: flex; flex-direction: column; align-items: left; cursor: pointer; overflow: initial; &:before { content: \"\"; position: absolute; top: 0; left: 0; bottom: 0; right: 0; } } } /* .el-table__fixed, .el-table__fixed-right { z-index: 101; background-color: #FFF; } */ &.drag-table_moving { .el-table th .thead-cell{ cursor: move !important; } .el-table__fixed, .el-table__fixed-right { cursor: not-allowed; } } } 8、ElementUI-Table，自定义列组件 自定义列 勾选需要显示的列，上下拖动 图标行排序。 重置 保存 关闭 import Draggable from 'vuedraggable' export default { name: 'CustomTableColumns', components: { Draggable }, computed: { commitDisabled () { return !this.columns.some(({ show }) => show === '1') } }, props: { onSave: Function }, data () { return { // 当前列数据 columns: [], // 原始列数据 originColumns: [], // 弹出层显示标识 visible: false, // 保存loading loading: false } }, methods: { // 保存 commit () { // 调用onSave方法，columns数据 复制并设置新的sort值，同时回调函数提供close和loading方法 this.onSave && this.onSave(this.columns.map((item, index) => ({ ...item, sort: index })), { close: () => { this.visible = false }, loading: loading => { this.loading = loading } }) }, // 重置列表，完全复制原始数据到当前列数据中 reset () { this.columns = this.originColumns.map(item => ({ ...item })) } } } .custom-table-columns-title { font-size: 16px; span, small { display: inline-block; margin-top: -4px; } span { margin-right: 15px; } small { font-size: 12px; color: #777; } i { font-weight: 600; } } .custom-table-columns-wrap { max-height: 450px; overflow-y: auto; margin: -13px -7px 0 -5px; .sort-drag-handle { cursor: move; font-size: 18px; padding: 7px 10px; } .columns-item { display: flex; justify-content: space-between; align-items: center; box-sizing: border-box; padding: 0 10px 0 20px; background-color: #F5F5F5; border-left: 1px solid #DDD; border-right: 1px solid #DDD; border-top: 1px solid #DDD; &:last-child { border-bottom: 1px solid #DDD; } &.unselected { color: #AAA; background-color: #FCFCFC; } .columns-item-label { display: inline-block; padding: 0 10px; } &.ghost-column { background-color: #E2E2E2; } } .flip-list-move { transition: transform 0.5s; } } /* custom-table-columns/index.js */ import Vue from 'vue' import CustomTableColumns from './main.vue' const CustomTableColumnsConstructor = Vue.extend(CustomTableColumns) let instance const initInstance = () => { instance = new CustomTableColumnsConstructor({ el: document.createElement('div') }) document.body.appendChild(instance.$el) } export default options => { if (Vue.prototype.$isServer) return if (!instance) { initInstance() } // 复制当前列数据到columns instance.columns = options.columns ? options.columns.map(item => ({ ...item })) : [] // 复制原始列数据到columns instance.originColumns = options.originColumns ? options.originColumns.map(item => ({ ...item })) : [] // 为onSave方法赋值 instance.onSave = options.onSave || (() => {}) // 打开弹出层 setTimeout(() => { instance.visible = true }, 1) } /* mixins/custom-table.js */ import setTableColumns from '_c/custom-table-columns' /* 自定义表格列 1、Table需要有ref=\"tableRef\" 2、列数据COLUMNS_DATA 3、混入import MixinsCustomTable from '_m/custom-table' 4、初始化或者工序发生改变的位置调用getCustomTableColumns获取保存的列数据 5、有统计行的Table，操作TableColumn要有prop=\"_operation\" [{ prop: 'id', // TableColumn prop属性 label: 'id标识', // TableColumn label属性 width: '120', // min-width className: 'user-select-all', // 【可选】TableColumn class-name属性 formatter: 'stateFormatter', // 【可选】TableColumn formatter方法key值 sortable: '1', // 【可选】TableColumn中是否排序字段，1：排序，0：不排序，默认：0 sort: 1, // 排序 show: '1', // 是否显示字段，0：不显示，1：显示，默认：1 filter: true // 【可选】是否需要过滤，根据业务控制该字段是否存在于当前列表 }] 一、默认方式，推荐 二、需自定义内容，:formatter无效，需手动调用转换 后端代码 // id，32位uuid @Id private String id; // 所在菜单，路由地址 private String menu; // 车间 private String workshop; // 工序 private String gxName; // 工号，empCode private String empCode; // TableColumn中prop属性 private String prop; // TableColumn中label属性 private String label; // TableColumn中min-width属性 private String width; // TableColumn中class-name属性 private String className; // TableColumn中formatter方法key private String formatter; // TableColumn中是否排序字段，1：排序，0：不排序，默认：0 private String sortable; // 字段排序 private Integer sort; // 是否显示，1：显示，0：不显示，默认：1 private String show; @Override @Transactional @ServiceExceptionHandler public boolean updateCustomTableBatch(String workshop, String gxName, String menu, List ctList, HttpServletRequest request) { // 获取当前用户empCode String empCode = getUserIdByRequest(request); // 创建条件 CustomTable condition = new CustomTable(); condition.setEmpCode(empCode); condition.setWorkshop(workshop); condition.setGxName(gxName); condition.setMenu(menu); // 删除原有数据 delete(condition); // 重新插入新数据 ctList.stream().forEach(item -> { // 添加id item.setId(IdUtil.simpleUUID()); // 设置当前用户empCode item.setEmpCode(empCode); // 设置车间 item.setWorkshop(workshop); // 设置工序 item.setGxName(gxName); // 设置菜单 item.setMenu(menu); // 是否排序标识 if (StrUtil.isNullOrUndefined(item.getSortable())) { item.setSortable(Constants.GLOBAL_DISABLE); } // 是否显示标识 if (StrUtil.isNullOrUndefined(item.getShow())) { item.setShow(Constants.GLOBAL_ENABLE); } // 保存 insert(item); }); return true; } @Override @ServiceExceptionHandler public List selectCustomTable(String workshop, String gxName, String menu, HttpServletRequest request) { // 获取当前用户empCode String empCode = getUserIdByRequest(request); Example example = new Example(CustomTable.class); Example.Criteria criteria = example.createCriteria(); criteria.andEqualTo(\"empCode\", empCode); criteria.andEqualTo(\"workshop\", workshop); criteria.andEqualTo(\"gxName\", gxName); criteria.andEqualTo(\"menu\", menu); example.setOrderByClause(\"sort ASC\"); // 查询当前已保存的数据 List currentList = selectExample(example); // 返回结果 return currentList; } */ export default { computed: { // 展示的列 showColumns () { return this.currentColumns.filter(({ show }) => show === '1') }, // 当前实际使用的列数据 currentColumns ({ customColumnsData }) { if (customColumnsData.length) return customColumnsData return this.originColumns }, // 原始列数据 originColumns ({ condition: { gxName } }) { // 根据业务，此处字段过滤是根据GX_WITH_XM工序字段 return this.COLUMNS_DATA.filter(({ filter }) => !(filter && (this.GX_WITH_XM || []).includes(gxName))) } }, data () { return { // 自定义列数据，查询得到 customColumnsData: [], // 自定义列弹框 customTableVisible: false } }, methods: { /** * 获取自定义表格列数据，调用位置：初始化或者工序发生改变的位置 */ getCustomTableColumns (workshop, gxName) { this.$http.request({ url: '/admin/sys/v1/table/columns', method: 'get', params: { workshop, gxName, menu: this.$route.path } }).then(({ result, data }) => { if (result === 'success' && data && data.length) { // 数据校验，针对prop、label const currentColumns = data.map(({ prop, label }) => ({ prop, label })).sort((a, b) => { if (a.prop > b.prop) return 1 if (a.prop ({ prop, label })).sort((a, b) => { if (a.prop > b.prop) return 1 if (a.prop { this.customColumnsData = [] }) }, /** * 自定义按钮调用 * * 操作 * * customTableHandle(currentWorkshop.workshop, condition.gxName)\"> * * */ customTableHandle (workshop, gxName) { setTableColumns({ columns: this.currentColumns, originColumns: this.originColumns, onSave: (columns, { close, loading }) => { // loading start loading(true) this.$http.request({ url: '/admin/sys/v1/table/columns', data: { workshop, gxName, menu: this.$route.path, list: JSON.stringify(columns) } }).then(({ message, result }) => { this.$msg({ message, type: result === 'success' ? 'success' : 'error' }) this.customColumnsData = columns close() if (this.$refs.tableRef) { setTimeout(() => { this.$refs.tableRef.doLayout && this.$refs.tableRef.doLayout() }, 1) } }).finally(() => { // loading end loading(false) }) } }) } } } 9、ElementUI-Table，嵌套表格 .table-column-no-padding { padding: 0 !important; >.cell { padding: 0 !important; } } B1 B2 B3 B4 table.inner-table { width: 100%; border-spacing: 0; tr { td, th { text-align: center; box-sizing: border-box; &:last-child { border-right: 0; margin-left: -1px; } } &:last-child { td, th { border-bottom: 0; } } } } 10、Echarts地图下钻 返回 import Mixins from '_m/mixins-chart-common' const levelTree = { province: { prev: '', next: 'city', cityNext: 'district' }, city: { prev: 'province', next: 'district' }, district: { prev: 'city', next: '', cityPrev: 'province' } } const rootCode = '100000' const cityMark = name => (name.endsWith('市') || name.endsWith('特别行政区')) const NO_DATA_IGNORE = ['台湾省'] export default { name: 'Map', mixins: [Mixins], data () { return { loading: false, mapData: null, provinceCode: '', provinceName: '', cityCode: '', cityName: '', districtCode: '', districtName: '', currentLevel: '', clickTimer: null } }, methods: { goBack () { const { prev } = levelTree[this.currentLevel] this.currentLevel = prev const code = this[`${prev}Code`] this.loadMap(code) }, init () { const chart = this.$echarts.init(this.$refs.mapRef) chart.setOption({ grid: { top: 0, left: 0, right: 0, bottom: 0 }, tooltip: { trigger: 'item', formatter: '{b}{c}' } }) this.chart = chart this.loadMap(rootCode) // 单击事件 chart.on('click', ({ name }) => { this.clickTimer && clearTimeout(this.clickTimer) this.clickTimer = setTimeout(() => { console.log(name) }, 250) }) // 双击下钻 chart.on('dblclick', ({ name }) => { this.clickTimer && clearTimeout(this.clickTimer) if (NO_DATA_IGNORE.includes(name) || !this.mapData) return const { next, cityNext } = this.currentLevel ? levelTree[this.currentLevel] : { next: 'province', cityNext: 'city' } const n = cityMark(this.provinceName) ? cityNext : next if (!n || n === 'district') return const { properties } = this.mapData.features.find(({ properties }) => properties.name === name) || {} if (properties) { const { level, adcode } = properties this.loadMap(`${adcode}`).then(() => { this[`${level}Code`] = `${adcode}` this[`${level}Name`] = name this.currentLevel = level }) } }) }, loadMap (code = rootCode) { this.loading = true this.prevCode = code return new Promise((resolve, reject) => { fetch(`https://geo.datav.aliyun.com/areas_v3/bound/geojson?code=${code}${code.endsWith('00') ? '_full' : ''}`, { method: 'GET', mode: 'cors', referrerPolicy: 'no-referrer' }).then(res => { this.loading = false if (res.ok) { return res.json() } else { reject(new Error('无法获取该区域地图')) } }).then(res => { if (!res) { reject(new Error('无法获取该区域地图')) return } this.mapData = res this.$echarts.registerMap(code, res) this.chart.setOption({ series: [{ type: 'map', name: code, map: code, zoom: code === rootCode ? 1.23 : 1, top: code === rootCode ? 100 : 66, selectedMode: false, data: [ { name: '山东省', value: 10057.34 }, { name: '济南市', value: 20057.34 } ], label: { show: true, fontSize: 9, color: '#FFF', borderColor: 'rgba(95, 117, 168, .4)', backgroundColor: 'rgba(95, 117, 168, .4)', shadowColor: 'rgba(95, 117, 168, .4)', padding: 2, borderRadius: 6, shadowBlur: 4, shadowOffsetX: 2, shadowOffsetY: 2 }, itemStyle: { areaColor: new this.$echarts.graphic.LinearGradient(1, 0, 0, 0, [{ offset: 0, color: '#84A0E4' }, { offset: 1, color: '#92AFF7' }]), borderColor: '#FFF' }, emphasis: { label: { color: '#FFF' }, itemStyle: { areaColor: '#718BCC' } }, select: { label: { color: '#FFF' }, itemStyle: { areaColor: '#718BCC' } } }] }) resolve() }).catch(reject) }) } } } .map-wrap { width: 100%; height: 100%; position: relative; .map-container { width: 100%; height: 100%; } button { position: absolute; top: 0; right: 0; } .help { position: absolute; left: 0; top: 0; } ::v-deep .el-alert { display: inline-flex; width: auto; padding: 6px 8px; .el-alert__title { font-size: 12px; } } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"index/wx.html":{"url":"index/wx.html","title":"微信开发","keywords":"","body":"微信开发 微信公众号 微信小程序授权 微信小程序车牌键盘 微信小程序Canvas签名 微信小程序验证码输入 微信小程序倒计时 微信小程序日期时间选择器 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"wx/wx-mp.html":{"url":"wx/wx-mp.html","title":"微信公众号","keywords":"","body":"微信公众号 推荐使用内网穿透在开发阶段进行内网穿透，如：cpolar Vue项目中通过内容穿透域名访问报错 Invalid Host header，解决方法 // vue-cli@2.x修改webpack.dev.conf.js devServer: { disableHostCheck: true, } // vue-cli@3.x以及4.x修改vue.config.js module.exports = { devServer: { disableHostCheck: true } } 正式环境需配置域名信息 测试帐号申请，请点击 服务器配置校验TOKEN 1）将token、timestamp、nonce三个参数进行字典序排序2）将三个参数字符串拼接成一个字符串进行sha1加密3）开发者获得加密后的字符串可与signature对比，标识该请求来源于微信 import cn.hutool.crypto.SecureUtil; /** * 微信服务器配置token校验，URL处填写该接口访问路径 * springboot */ @RequestMapping(\"/common\") public class CommonController { @GetMapping(\"/v1/wx/check\") @ControllerExceptionHandler public String wxTokenCheck( @RequestParam(\"signature\") String signature, @RequestParam(\"timestamp\") String timestamp, @RequestParam(\"nonce\") String nonce, @RequestParam(\"echostr\") String echostr, HttpServletResponse response) { // 使用TreeSet字典序排序 TreeSet set = new TreeSet<>(); set.add(\"TOKEN\"); // 自己设置的TOKEN set.add(timestamp); set.add(nonce); StringBuilder sBuilder = new StringBuilder(); for (String item : set) { sBuilder.append(item); } // sha1加密 String sign = SecureUtil.sha1(sBuilder.toString()); if (signature.equalsIgnoreCase(sign)) { return echostr; } else { return String.valueOf(false); } } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"wx/weapp-grant.html":{"url":"wx/weapp-grant.html","title":"微信小程序授权","keywords":"","body":"微信小程序授权相关 openid 用户唯一标识，小程序、公众号等，每个应用唯一，不同应用中不相同unionid 同平台下相等，小程序、公众号、App等，需绑定到同一开放平台下session_key 会话密钥，解析小程序中 encryptedData, iv 注意：auth.code2Session 凭证校验时，一定能获取的值 openid, session_keyunionid 需要满足特定条件才能直接获取否则需要通过 session_key 解析 encryptedData, iv 获取 问题描述 特殊性情况下，如：新账号首次注册、已注册账号首次登录等，使用 session_key 解析 encryptedData, iv 失败，无法获取 unionid 原因：小程序端需要先 wx.login 获取 code，然后通过 wx.getUserInfo 获取 encryptedData, iv如果使用小程序 Button 的 getUserInfo 提示用户授权登录 则无法先调用 wx.login 获取 code 解决办法：在授权登录页面 onLoad 生命周期中调用 wx.login 获取 code由于 code 默认有效时间为5分钟，应该设置定时任务，每 4 分钟调用 wx.login 更新 code /** 部分代码示例 **/ // wxml 获取用户信息 // js Page({ data: { code: '', timer: undefined }, onLoad () { this.getCodeFunc() var timer = setInterval(this.getCodeFunc, 4 * 60 * 1000) this.setData({ timer }) }, onUnload () { this.timer && clearInterval(this.timer) }, getCodeFunc () { var _this = this wx.login({ success (res) { if (res.code) { _this.setData({ code: res.code }) } } }) }, getUserInfo (e) { var encryptedData = e.detail.encryptedData var iv = e.detail.iv this.doLoginRequest(encryptedData, iv, this.code) }, doLoginRequest (encryptedData, iv, code) { // TODO login request } }) © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"wx/weapp-vehicle-panel.html":{"url":"wx/weapp-vehicle-panel.html","title":"微信小程序车牌键盘","keywords":"","body":"微信小程序车牌键盘 微信小程序车牌键盘。 效果 目录结构 ├─ del.png # 删除按钮 ├─ index.js # js ├─ index.json # json配置 ├─ index.wxml # 视图 └─ index.wxss # 样式 del.png index.js Component({ externalClasses: ['v-panel'], properties: { isShow: { type: Boolean, value: false }, buttonBorder: { type: String, value: '1px solid #ccc' }, backgroundColor: { type: String, value: '#F5F5F5' }, value: { type: String, value: '', observer: function (newVal) { this.setData({ length: newVal.length }) } } }, data: { keyVehicle1: '京津沪渝冀豫云辽', keyVehicle2: '黑湘皖鲁新苏浙赣', keyVehicle3: '鄂桂甘晋蒙陕吉闽', keyVehicle4: '贵粤青藏川宁琼使领', keyNumber: '1234567890', keyEnInput1: 'QWERTYUIOPA', keyEnInput2: 'SDFGHJKLZXC', keyEnInput3: 'VBNM挂学警港澳', length: 0 }, methods: { vehicleTap: function (event) { let val = event.target.dataset.value switch (val) { case 'delete': this.triggerEvent('delete') break case 'ok': this.triggerEvent('ok') break default: this.triggerEvent('inputchange', val) } } } }) index.json { \"component\": true } index.wxml {{item}} {{item}} {{item}} {{item}} {{item}} 删除 {{item}} {{item}} {{item}} 确定 index.wxss .vehicle-panel { width: 100%; display: flex; flex-direction: column; justify-content: center; border-top: 1px solid #EEE; font-size: 32rpx; padding-top: 10rpx } .vehicle-panel-row { display: flex; justify-content: space-between; align-items: center } .vehicle-panel-row-last { display: flex; justify-content: space-between; align-items: center } .vehicle-panel-row-button { background-color: #fff; margin: 5rpx; padding: 5rpx; width: 80rpx; height: 80rpx; text-align: center; line-height: 80rpx; border-radius: 10rpx } .vehicle-panel-row-button-number { background-color: #DDD } .vehicle-panel-row-button-last { width: 90rpx; height: 90rpx; line-height: 90rpx } .vehicle-hover { background-color: #ccc } .vehicle-panel-row-button-img { display: flex; justify-content: center; align-items: center } .vehicle-en-button-delete { width: 55rpx; height: 85rpx } .vehicle-panel-ok { background-color: #1989fa; color: #fff; width: 150rpx; height: 80rpx } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"wx/weapp-sign.html":{"url":"wx/weapp-sign.html","title":"微信小程序Canvas签名","keywords":"","body":"微信小程序Canvas签名 微信小程序Canvas手写签名，基于Taro@2.x React实现。 效果 index.jsx import Taro, { Component } from '@tarojs/taro' import { View, Button, Text, Canvas } from '@tarojs/components' import styles from './styles.module.scss' /** * 手写签名 */ class Index extends Component { constructor () { this.canvasRef = Taro.createRef() this.state = { ctx: null, isSigned: false, backgroundColor: 'rgba(0, 0, 0, 0)', lineColor: '#000', lineWidth: 4 } } componentDidMount () { this.init() } config = { navigationBarTitleText: '签名', pageOrientation: 'landscape' } // 初始化 init = () => { this.canvasRef.current.fields({ node: true, size: true }).exec(([res]) => { const canvas = res.node const ctx = canvas.getContext('2d') // 获取设备像素比 const dpr = Taro.getSystemInfoSync().pixelRatio // 缩放设置canvas画布大小，防止笔迹错位 canvas.width = res.width * dpr canvas.height = res.height * dpr ctx.scale(dpr, dpr) const { lineColor, lineWidth, backgroundColor } = this.state // 设置画布背景色，画布默认透明，可不进行设置 ctx.fillStyle = backgroundColor ctx.fillRect(0, 0, canvas.width, canvas.height) // 设置线条颜色 ctx.strokeStyle = lineColor // 设置线条宽度 ctx.lineWidth = lineWidth // 设置笔迹开头结尾圆角 ctx.lineCap = 'round' // 设置交汇处圆角 ctx.lineJoin = 'round' // 利用阴影，消除锯齿 ctx.shadowBlur = 1 ctx.shadowColor = lineColor this.setState({ ctx }) }) } // 开始绘制 start = e => { const { ctx } = this.state if (e.type !== 'touchstart' || !ctx) return const { x, y } = e.changedTouches[0] ctx.moveTo(x, y) // 创建路径 ctx.beginPath() } // 绘制 move = e => { const { ctx, isSigned } = this.state if (e.type !== 'touchmove' || !ctx) return if (!isSigned) { // 如果签名状态为未签名，置为true this.setState({ isSigned: true }) } const { x, y } = e.changedTouches[0] // 绘制笔迹 ctx.lineTo(x, y) ctx.stroke() // 阻止默认事件 e.preventDefault() } // 绘制结束 end = e => { const { ctx } = this.state if (e.type !== 'touchend' || !ctx) return // 关闭路径 ctx.closePath() } // 保存 save = () => { const { ctx, isSigned } = this.state if (!ctx) return if (!isSigned) { Taro.showToast({ title: '请先手写签名', icon: 'none', duration: 2000 }) return } const base64 = ctx.canvas.toDataURL() // TODO 对图片base64进行后续处理 console.log(base64) /* 处理并关闭该页面，方法1 // 使用mobx中formStore的setSignImage方法保存签名 this.props.formStore.setSignImage(base64) Taro.navigateBack() */ /* 处理并关闭该页面，方法2 const pages = Taro.getCurrentPages() if (pages.length >= 2) { const prevPage = pages[pages.length - 2] // 调用前一页自定义的setSignImage方法保存签名到前一页 prevPage.$component.setSignImage(base64) Taro.navigateBack() } */ } // 清空画布 clear = () => { const { ctx, backgroundColor } = this.state if (!ctx) return const { width, height } = ctx.canvas // 清空画布 ctx.clearRect(0, 0, width, height) // 绘制画布背景颜色 ctx.fillStyle = backgroundColor ctx.fillRect(0, 0, width, height) // 设置是否签名状态为false this.setState({ isSigned: false }) } render () { return ( 请在上方空白区域手写签名 确认 重写 ) } } export default Index styles.module.scss .page { background-color: #F9F9FB; height: 100vh; width: 100vw; color: #262626; font-size: 0; overflow: hidden; display: flex; flex-direction: column; .canvas { height: 82vh; width: 100vw; } } .btns { border-top: 1px solid #CCC; box-sizing: border-box; height: 18vh; display: flex; align-items: center; justify-content: center; .tip { font-size: 16px; } &-wrap { display: flex; justify-content: space-around; width: 300px; margin-left: 40px; } } .btn { font-size: 17px; border: 1PX solid #526BF3; border-radius: 6px; line-height: 1; display: flex; justify-content: center; align-items: center; padding: 10px 20px; &.primary { background-color: #526BF3; color: #FFF; } &.secondary { background-color: transparent; color: #526BF3; } &.hover { opacity: 0.6; } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"wx/weapp-codes.html":{"url":"wx/weapp-codes.html","title":"微信小程序验证码输入","keywords":"","body":"微信小程序验证码输入 微信小程序验证码输入，基于Taro@2.x React实现。 使用 // 引入 import Codes from '_c/codes' // 位数输入完后回调 onInput = value => { // code字符串 console.log(value) } // render 效果 index.jsx import Taro, { Component } from '@tarojs/taro' import PropTypes from 'prop-types' import { View, Input } from '@tarojs/components' import styles from './codes.module.scss' /** * code输入 */ class Codes extends Component { constructor () { this.state = { focus: false, value: '', values: [] } } componentDidMount () { this.init() } init = () => { const { length, autoFocus } = this.props this.setState({ values: Array(length).fill('') }) autoFocus && setTimeout(() => { this.setFocus(true) }, 100) } setFocus = focus => { this.setState({ focus }) } inputHandle = ({ detail }) => { let { value } = detail let { length } = this.props if (value.length > length) { value = value.substr(0, length) } this.setState({ value }) const { onInput } = this.props const { values } = this.state if (value.length { values[i] = value[i] || '' }) this.setState({ values }) if (value.length >= length) { this.setFocus(false) onInput(values.join('')) } } render () { const { focus, value, values } = this.state const cursorIndex = values.findIndex(val => !val) return ( {values.map((val, i) => this.setFocus(true)} >{val})} this.setFocus(false)} onInput={this.inputHandle} /> ) } } Codes.propTypes = { type: PropTypes.string, length: PropTypes.number, autoFocus: PropTypes.bool, onInput: PropTypes.func } Codes.defaultProps = { type: 'number', length: 4, autoFocus: false, onInput: () => { } } export default Codes styles.module.scss .component { display: flex; justify-content: center; align-items: center; overflow: hidden; position: relative; width: 100%; .real-input { position: absolute; left: -999px; } .input { width: 80px; height: 80px; border: 2PX solid #CCC; font-size: 36px; color: #262626; font-weight: 600; border-radius: 12px; box-sizing: border-box; display: flex; justify-content: center; align-items: center; position: relative; &.cursor:after { content: ''; display: block; width: 25%; height: 2PX; border-radius: 2PX; background-color: #999; position: absolute; left: 0; right: 0; bottom: 16px; margin: 0 auto; animation: cursor 1s ease-in-out infinite; } } .input + .input { margin-left: 20px; } } @keyframes cursor { 0% { opacity: 1; } 25% { opacity: .7; } 50% { opacity: 0; } 75% { opacity: .7; } 100% { opacity: 1; } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"wx/weapp-timing.html":{"url":"wx/weapp-timing.html","title":"微信小程序倒计时","keywords":"","body":"微信小程序倒计时 微信小程序短信发送倒计时，基于Taro@2.x React实现。 使用 // 引入 import Timing from '_c/timing' // 开始方法 startTiming = (start, loading) => { loading && loading(true) setTimeout(() => { start && start() loading && loading(false) }, 100) } // render 效果 index.jsx import Taro, { Component } from '@tarojs/taro' import PropTypes from 'prop-types' import { View, Text } from '@tarojs/components' import styles from './timing.module.scss' /** * 倒计时 */ class Timing extends Component { constructor () { this.state = { clock: 0, timer: null, loading: false } } componentDidMount () { this.setState({ clock: 0 }, this.init) } componentWillUnmount () { const { timer } = this.state timer && clearInterval(timer) } init = () => { const { expiresKey, expiresInterval } = this.props // 获取上次发送的时间戳 const time = Taro.getStorageSync(expiresKey) if (!time) return const now = Date.now() // 计算剩余时间 const surplus = expiresInterval - Math.round((now - +time) / 1000) if (surplus { let { timer, clock } = this.state if (clock { const { expiresKey, expiresInterval } = this.props const now = Date.now() Taro.setStorage({ key: expiresKey, data: now }) const newTimer = setInterval(() => { let { timer, clock } = this.state if (clock { const { onClick } = this.props const { loading } = this.state if (loading) return // 通过回调的方式开始计时 onClick(this.startTiming, l => { this.setState({ loading: l }) }) } render () { const { text, buttonText, timingText } = this.props const { clock, loading } = this.state let content if (clock > 0) { content = {clock}{timingText} } else { content = {buttonText} } return ( {!!text && {text}} {content} ) } } Timing.propTypes = { text: PropTypes.string, buttonText: PropTypes.string, timingText: PropTypes.string, expiresKey: PropTypes.string, expiresInterval: PropTypes.number, onClick: PropTypes.func } Timing.defaultProps = { text: '', buttonText: '发送', timingText: '秒后重发', expiresKey: 'sms_expires', expiresInterval: 60, onClick: () => { } } export default Timing timing.module.scss .component { display: inline-flex; align-items: center; font-size: 28px; .btn { color: #526BF3; &.hover { opacity: .6; } &.disabled { color: #CCC; } } .txt { color: #999; } .text { color: #526BF3; margin-right: 16px; } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"wx/weapp-datetime-picker.html":{"url":"wx/weapp-datetime-picker.html","title":"微信小程序日期时间选择器","keywords":"","body":"微信小程序日期时间选择器 微信小程序日期时间选择器，基于Taro@2.x React实现。 使用 // 引入 import DateTimePicker from '_c/datetime-picker' // 选中确认方法 pickerConfirm = time => { this.setState({ time }) } // render this.setState({ isOpened1: false })} /> 效果 index.jsx import Taro, { Component } from '@tarojs/taro' import PropTypes from 'prop-types' import { View, Text, PickerView, PickerViewColumn } from '@tarojs/components' import styles from './datetime-picker.module.scss' /** * 时间日期选择器 */ class DateTimePicker extends Component { constructor () { this.state = { columns: [[], [], [], [], [], []], selectIndexList: [0, 0, 0, 0, 0, 0], width: '', current: null } } componentWillMount () { this.init() } // 计算每列数据 arrangeColumns = selected => { const columns = [] const { min, max, precision, precisionUnits } = this.props // 获取最小年月日时分秒 const minYear = min.getFullYear() const minMonth = min.getMonth() + 1 const minDay = min.getDate() const minHour = min.getHours() const minMinute = min.getMinutes() const minSecond = min.getSeconds() // 获取最大年月日时分秒 const maxYear = max.getFullYear() const maxMonth = max.getMonth() + 1 const maxDay = max.getDate() const maxHour = max.getHours() const maxMinute = max.getMinutes() const maxSecond = max.getSeconds() // 获取精度索引 const rank = precisionRankRecord[precision] // 年-列数据 if (rank >= precisionRankRecord.year) { const years = [] for (let i = minYear; i = maxMonth const isInMinDay = isInMinMonth && selectedDay = maxDay const isInMinHour = isInMinDay && selectedHour = maxHour const isInMinMinute = isInMinHour && selectedMinute = maxMinute // 月-列数据 if (rank >= precisionRankRecord.month) { const lower = isInMinYear ? minMonth : 1 const upper = isInMaxYear ? maxMonth : 12 const months = generateIntArray(lower, upper) columns.push(months.map(v => ({ label: precisionUnits.month, value: v.toString() }))) } // 日-列数据 if (rank >= precisionRankRecord.day) { // 获取当月天数 const daysInMonth = new Date(selectedYear, selectedMonth, 0).getDate() const lower = isInMinMonth ? minDay : 1 const upper = isInMaxMonth ? maxDay : daysInMonth const days = generateIntArray(lower, upper) columns.push(days.map(v => ({ label: precisionUnits.day, value: v.toString() }))) } // 时-列数据 if (rank >= precisionRankRecord.hour) { const lower = isInMinDay ? minHour : 0 const upper = isInMaxDay ? maxHour : 23 const hours = generateIntArray(lower, upper) columns.push( hours.map(v => ({ label: precisionUnits.hour, value: v.toString() })) ) } // 分-列数据 if (rank >= precisionRankRecord.minute) { const lower = isInMinHour ? minMinute : 0 const upper = isInMaxHour ? maxMinute : 59 const minutes = generateIntArray(lower, upper) columns.push( minutes.map(v => ({ label: precisionUnits.minute, value: v.toString() })) ) } // 秒-列数据 if (rank >= precisionRankRecord.second) { const lower = isInMinMinute ? minSecond : 0 const upper = isInMaxMinute ? maxSecond : 59 const seconds = generateIntArray(lower, upper) columns.push( seconds.map(v => ({ label: precisionUnits.second, value: v.toString() })) ) } // 返回处理后的列数据 return columns } // 初始化 init = () => { const { precision, value, min, max } = this.props const length = precisionRankRecord[precision] + 1 // 根据精度个数，设置每列宽度 const width = 750 / length // 根据输入的value转为选中的日期数组 const selected = convertDateToStringArray(value) // 处理并获取列数据 const columns = this.arrangeColumns(selected) // 根据精度个数，将日期转为yyyyMMddHHmmss格式，需补零 const selectStr = convertDateToString(value) const minStr = convertDateToString(min) const maxStr = convertDateToString(max) // 处理选中列索引，主要处理临界问题 let selectIndexList if (selectStr = maxStr) { // 选中日期大于等于最大日期，默认选中每列最后一个 selectIndexList = columns.map(column => column.length - 1) } else { // 选中日期在最小、最大日期区间内，计算内列选中日期的索引位置 selectIndexList = columns.map((arr, index) => { const values = arr.map(item => item.value) let idx = values.indexOf(selected[index].toString()) return idx !== -1 ? idx : 0 }) } // 设置state数据 this.setState({ width: `${width}rpx`, current: value, columns, selectIndexList }) } // 滑动选取列change事件处理 changeHandle = ({ detail }) => { // 选中列索引数组 const { value } = detail // 根据选中的列转索引换为选中的值 const selected = this.getSelectedValueArray(value) // 根据选中的列值重新计算列数据 const columns = this.arrangeColumns(selected) // 设置列数据 this.setState({ columns }, () => { // 延时设置临界处理后的列索引 setTimeout(() => { this.setState({ selectIndexList: value }) }, 1) }) } // 滑动式阻止时间冒泡 handleTouchMove = e => { e.stopPropagation() } // 根据选中的列转索引换为选中的值 getSelectedValueArray = selectIndexList => { const { columns } = this.state return columns.map((arr, index) => { let idx = selectIndexList[index] if (idx > arr.length - 1) { idx = arr.length - 1 selectIndexList[index] = idx } return arr[idx].value }) } // 确认操作 confirm = () => { const { onConfirm, onClose } = this.props const { selectIndexList } = this.state // 获取选中的值 const arr = this.getSelectedValueArray(selectIndexList) // 转为Date类型 const date = convertStringArrayToDate(arr) // 回调返回 onConfirm(date) // 关闭窗口 onClose() } // 根据外层模态框动画结束事件重新初始化 handleTransitionEnd = () => { const { isOpened, value } = this.props const { current } = this.state // 打开模态框，如果传入的值发生改变，重新初始化，主要处理共用一个时间选择器等特殊情况 if (isOpened && +(current || 0) !== +(value || 0)) { this.init() } } render () { const { title, isOpened, onClose } = this.props const { columns, selectIndexList, width } = this.state return ( {title} 确定 {columns.map((arr, index) => {arr.map((item, idx) => {item.value}{item.label})} )} ) } } // 精度 const precisionRankRecord = { year: 0, month: 1, day: 2, hour: 3, minute: 4, second: 5 } // 单位 const precisionUnits = { year: '年', month: '月', day: '日', hour: '时', minute: '分', second: '秒' } // 当前年 const thisYear = new Date().getFullYear() DateTimePicker.propTypes = { title: PropTypes.string, value: PropTypes.instanceOf(Date), min: PropTypes.instanceOf(Date), max: PropTypes.instanceOf(Date), precision: PropTypes.oneOf(Object.keys(precisionRankRecord)), precisionUnits: PropTypes.object, isOpened: PropTypes.bool, onClose: PropTypes.func, onConfirm: PropTypes.func } DateTimePicker.defaultProps = { title: '请选择', value: new Date(), min: new Date(new Date().setFullYear(thisYear - 10)), max: new Date(new Date().setFullYear(thisYear + 10)), precision: 'hour', precisionUnits, isOpened: false, onClose: () => {}, onConfirm: () => {} } export default DateTimePicker // date -> ['2021', '10', '1', '10', '12', '13'] const convertDateToStringArray = date => { if (!date) return [] return [ date.getFullYear().toString(), (date.getMonth() + 1).toString(), date.getDate().toString(), date.getHours().toString(), date.getMinutes().toString(), date.getSeconds().toString(), ] } // ['2021', '10', '1', '10', '12', '13'] -> date const convertStringArrayToDate = value => { if (value.length === 0) return null const yearString = value[0] || '1900' const monthString = value[1] || '1' const dateString = value[2] || '1' const hourString = value[3] || '0' const minuteString = value[4] || '0' const secondString = value[5] || '0' return new Date( parseInt(yearString), parseInt(monthString) - 1, parseInt(dateString), parseInt(hourString), parseInt(minuteString), parseInt(secondString) ) } // 根据精度个数，将日期转为yyyyMMddHHmmss格式，需补零 const convertDateToString = (date, length) => { return convertDateToStringArray(date).slice(0, length).map(item => { let str = item.toString() if (str.length { const array = [] for (let i = from; i datetime-picker.module.scss .component { position: fixed; width: 100%; height: 100%; top: 0; left: 0; visibility: hidden; z-index: 777; transition: visibility .3s cubic-bezier(0.36, 0.66, 0.04, 1); &.active { visibility: visible; .overlay { opacity: 1; } .container { transform: translate3d(0, 0, 0); } } .overlay { top: 0; left: 0; width: 100%; height: 100%; position: absolute; background-color: rgba(0, 0, 0, .3); opacity: 0; transition: opacity .15s ease-in; } .header { font-size: 28px; height: 78px; background-color: #F7F7F7; display: flex; justify-content: center; align-items: center; position: relative; .title { color: #333; } .confirm { position: absolute; right: 0; top: 0; bottom: 0; display: flex; align-items: center; padding: 0 32px; color: #536BF3; } } .container { position: absolute; bottom: 0; width: 100%; background-color: #FFF; transform: translate3d(0, 100%, 0); transition: transform .3s cubic-bezier(0.36, 0.66, 0.04, 1); } .picker-view { height: 500px; display: flex; &-column { flex: 1; height: 100%; width: 150px; font-size: 26px; .box { display: flex; align-items: center; justify-content: center; font-size: 26px; } } } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"index/flutter.html":{"url":"index/flutter.html","title":"Flutter","keywords":"","body":"Flutter 环境 Android构建 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"flutter/env.html":{"url":"flutter/env.html","title":"环境","keywords":"","body":"Flutter 环境安装配置 国内镜像 相关链接（需科学上网） 配置环境变量解决flutter pub get卡的问题Window系统在系统环境变量中添加MacOS系统在.bash_profile中添加 # 官方提供的国内镜像 export PUB_HOSTED_URL=https://pub.flutter-io.cn export FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn # 上海交通大学提供的国内镜像 export FLUTTER_STORAGE_BASE_URL=https://mirrors.sjtug.sjtu.edu.cn/ export PUB_HOSTED_URL=https://dart-pub.mirrors.sjtug.sjtu.edu.cn/ MacOS系统 1、安装 Flutter sdk （包含 dart sdk） # https://flutter.dev/docs/get-started/install/macos # 下载并解压，将 flutter 文件夹复制到 /Users//Programs/ 目录下 # 配置 .bash_profile FLUTTER_HOME=/Users//Programs/flutter PATH=$PATH:$FLUTTER_HOME/bin export PATH 2、安装 XCode，直接从 AppStore 下载安装 # 配置Xcode命令行工具以使用新安装的Xcode版本 sudo xcode-select --switch /Applications/Xcode.app/Contents/Developer # 确保之前打开过一次Xcode并签署通过了Xcode许可协议，可以从命令行运行sudo xcodebuild -license来确认 sudo xcodebuild -license 3、安装 brew # 切换到下载目录 cd /Users//Downloads # 生成 brew 安装文件 curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install >> brew_install # 编辑 brew_install # 将 line.9 (新版本好像没有 CORE_TAP_REPO，则略过) BREW_REPO = \"https://github.com/Homebrew/brew\".freeze CORE_TAP_REPO = \"https://github.com/Homebrew/homebrew-core\".freeze # 替换为 BREW_REPO = \"https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/brew.git\".freeze CORE_TAP_REPO = \"https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.git\".freeze # 执行脚本安装 /usr/bin/ruby brew_install # 安装完后删除 brew_install 文件 rm brew_install 4、安装 cocoapods # brew install 安装前会 Updating Homebrew，速度很慢 # 替换镜像源 cd \"$(brew --repo)\" git remote set-url origin https://mirrors.ustc.edu.cn/brew.git cd \"$(brew --repo)/Library/Taps/homebrew/homebrew-core\" git remote set-url origin https://mirrors.ustc.edu.cn/homebrew-core.git # 安装 brew install cocoapods # 执行命令，此步骤速度很慢 pod setup # 使用清华大学开源镜像，该步骤解决 pod setup 速度慢的问题 cd ~/.cocoapods/repos pod repo remove master git clone https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git master # 工程的podFile第一行加上 ? 未使用，作用未知，运行 flutter doctor 命令成功 source 'https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git' 5、安装 IOS tools brew update brew install --HEAD usbmuxd brew link usbmuxd brew install --HEAD libimobiledevice brew install ideviceinstaller brew install ios-deploy 6、安装Android Studio，创建安装虚拟设备 AVD # 直接下载安装即可 Android Studio # 注意mac上可能会提示 Android Studio 使用系统日历隐私，不授权可能无法完成初始化配置 # 完成初始化配置，其中 android/sdk 目录需要配置到 .bash_profile 中 ANDROID_HOME=/Users//Programs/Android/sdk export ANDROID_HOME # 安装完成打开，在创建项目的页面，右下角，Configure -> Plugins，在 Marketplace 里面搜索 并安装 flutter 插件（自动安装 Dart 插件），重启 # Configure -> AVD Manager，创建新安卓虚拟设备 # 一般选择 Phone -> Nexus 5 -> Android 8.0（需下载） -> Finish 点击绿色三角启动虚拟设备 # 提示 Android license status unknown # 运行命令添加 Android license 即可 flutter doctor --android-licenses 7、如果使用 VS Code，需要安装 flutter 插件，自动安装 Dart 插件 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"flutter/android-package.html":{"url":"flutter/android-package.html","title":"Android构建","keywords":"","body":"Android构建 最新官方文档请点击查看（需科学上网） 1、检查 App Manifest 查看默认应用程序清单文件(位于/android/app/src/main/中的AndroidManifest.xml文件)，并验证这些值是否正确，特别是： application: 编辑 application 标签，这是应用的名称。 android 8 及以后 http/https问题 android:label=\"netease_cloud_music\" -> 安装后app名字 android:icon=\"@mipmap/ic_launcher\" -> 安装后app图标，修改图标文件(位于\\/android/app/src/main/res中的各尺寸图标文件) --> uses-permission: 权限配置。如果应用程序代码不需要Internet访问，请删除android.permission.INTERNET权限。标准模板包含此标记是为了启用Flutter工具和正在运行的应用程序之间的通信。 2、查看构建配置 查看默认[Gradle 构建文件][gradlebuild]”build.gradle”，它位于/android/app/，验证这些值是否正确，尤其是： defaultConfig: applicationId: 指定始终唯一的 (Application Id)appid。 versionCode & versionName: 指定应用程序版本号和版本号字符串。 minSdkVersion & targetSdkVersion: 指定最低的API级别以及应用程序设计运行的API级别。 4、添加启动图标、启动页 图标 当一个新的Flutter应用程序被创建时，它有一个默认的启动器图标。要自定义此图标： 1、图标尺寸： drawable-mdpi-icon: 48 x 48 drawable-hdpi-icon: 72 x 72 drawable-xhdpi-icon: 96 x 96 drawable-xxhdpi-icon: 144 x 144 drawable-xxxhdpi-icon: 192 x 192 2、在/android/app/src/main/res/目录中，将图标文件放入使用配置限定符命名的文件夹中。默认mipmap-文件夹演示正确的命名约定。3、在AndroidManifest.xml中，将application标记的android:icon属性更新为引用上一步中的图标（例如 ）。4、要验证图标是否已被替换，运行应用程序并检查应用图标。 启动页 启动页配置(位于/android/app/src/main/res/drawable/中的launch_background.xml文件) 图片尺寸，竖屏：高 x 宽，横屏：宽 x 高 drawable-port-mdpi-screen: 480 x 320 drawable-port-hdpi-screen: 800 x 480 drawable-port-xhdpi-screen: 1280 x 720 drawable-port-xxhdpi-screen: 1600 x 960 drawable-port-xxxhdpi-screen: 1920 x 1280 --> 5、app签名 （1）创建 keystore 如果有现有keystore，请跳至下一步。如果没有，请通过在运行以下命令来创建一个： # -keystore 生成目录记名字 # -keyalg 加密和数字签名的算法 # -keysize 密钥长度 # -validity 有效天数 # -alias 别名，名称最好与前面-alias的参数保持一致 keytool -genkey -v -keystore ~/appkeystore.jks -keyalg RSA -keysize 2048 -validity 20000 -alias appkeystore # next 提示输入 “ 密钥库 ” 密码、确认密码 # next 提示输入名字姓氏、组织单位名称、组织名称、城市区域名称、省、国家 # next 提示是否正确，输入 y # next 提示输入 “ 密钥 ” 密码、确认密码，如果和上面 “ 密钥库 ” 密码相同，直接摁回车键 注意：保持文件私密；不要将它加入到公共源代码控制中。注意：keytool可能不在系统路径中。它是Java JDK的一部分，它是作为Android Studio的一部分安装的。 （2）引用应用程序中的keystore 创建一个名为/android/key.properties的文件，其中包含对密钥库的引用： storePassword= keyPassword= keyAlias=appkeystore storeFile=/appkeystore.jks> 注意: 保持文件私密; 不要将它加入公共源代码控制中 （3）在gradle中配置签名 通过编辑/android/app/build.gradle文件为应用配置签名 1、替换： android { 为： def keystoreProperties = new Properties() def keystorePropertiesFile = rootProject.file('key.properties') if (keystorePropertiesFile.exists()) { keystoreProperties.load(new FileInputStream(keystorePropertiesFile)) } android { 2、替换： buildTypes { release { // TODO: Add your own signing config for the release build. // Signing with the debug keys for now, so `flutter run --release` works. signingConfig signingConfigs.debug } } 为： signingConfigs { release { keyAlias keystoreProperties['keyAlias'] keyPassword keystoreProperties['keyPassword'] storeFile file(keystoreProperties['storeFile']) storePassword keystoreProperties['storePassword'] } } buildTypes { release { signingConfig signingConfigs.release } } 应用的release版本将自动进行签名。 5、开启混淆 Flutter 1.16.2及之后版本 使用--obfuscate结合使用标记来构建发行版本--split-debug-info。该--split-debug-info标志指定Flutter可以在其中输出调试文件的目录。 # flutter build apk --obfuscate --split-debug-info= # 输出调试文件的目录使用相对路径./.debug_info flutter build apk --obfuscate --split-debug-info=./.debug_info Flutter 1.16.2之前版本 默认情况下 flutter 不会开启 Android 的混淆。 如果使用了第三方 Java 或 Android 库，或者减小 apk 文件的大小或者防止代码被逆向破解。 （1）配置混淆 创建 /android/app/proguard-rules.pro 文件，并添加以下规则： # Flutter Wrapper -keep class io.flutter.app.** { *; } -keep class io.flutter.plugin.** { *; } -keep class io.flutter.util.** { *; } -keep class io.flutter.view.** { *; } -keep class io.flutter.** { *; } -keep class io.flutter.plugins.** { *; } 上述配置只混淆了 Flutter 引擎库，任何其他库（比如 Firebase）需要添加与之对应的规则。 （2）开启混淆/压缩 打开 /android/app/build.gradle 文件，定位到 buildTypes 块。在 release 配置中将 minifyEnabled 和 useProguard 设为 true，再将混淆文件指向上一步创建的文件。 android { ... buildTypes { release { signingConfig signingConfigs.release // 压缩，默认启用 // minifyEnabled true // Gradle 3.4.0之后默认启用R8，3.2.0之前版本默认ProGuard // useProguard true // 启用资源压缩 shrinkResources true // 压缩规则 proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro' } } } 注意：开启压缩 minifyEnabled true 可能会导致无法打包，暂时不启用压缩。 貌似自v1.12.13版本已解决 7、构建一个发布版（release）APK 使用命令行: 1、cd ( 为工程目录)；2、运行flutter build apk (flutter build 默认会包含 --release选项)；3、Flutter 1.16.2及之后版本压缩混淆打包可参照。 # 输出调试文件的目录为项目根目录下debug-info flutter build apk --obfuscate --split-debug-info=./.debug_info 打包好的发布APK位于/build/app/outputs/apk/app-release.apk。 8、相关问题 Could not resolve io.flutter:flutter_ ···无法现在相关依赖导致 打开 /android/build.gradle 文件，添加maven仓库相关配置 maven { url 'http://download.flutter.io' } buildscript { repositories { maven { url 'http://download.flutter.io' } } } allprojects { repositories { maven { url 'http://download.flutter.io' } } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"index/java.html":{"url":"index/java.html","title":"Java","keywords":"","body":"Java Java部分知识点总结。 String Stream FastJson compareTo 比较大小 Java工具类 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"java/string.html":{"url":"java/string.html","title":"String","keywords":"","body":"String 字符串格式化 // 新字符串使用本地语言环境，制定字符串格式和参数生成格式化的新字符串 String.format(String format, Object... args); // 使用指定的语言环境，制定字符串格式和参数生成格式化的字符串 String.format(Locale locale, String format, Object... args); 常用类型说明 转换符 说明 示例 %s 字符串类型 “字符串” %c 字符类型 ‘m’ %b 布尔类型 true %d 整数类型 (十进制) 88 %x 整数类型 (十六进制) FF %o 整数类型 (八进制) 77 %f 浮点类型 8.888 %a 十六进制浮点类型 FF.35AE %e 指数类型 9.38e+5 %g 通用浮点类型 (f和e类型中较短的) %h 散列码 %% 百分比类型 (%特殊字符%%才能显示%) % %n 换行符 %tx 日期与时间类型 (x代表不同的日期与时间转换符，见 日期转换符) 日期转换符 标志 说明 示例 c 包括全部日期和时间信息 星期六 十月 27 14:21:20 CST 2007 F “年-月-日”格式 2007-10-27 D “月/日/年”格式 10/27/07 r “HH:MM:SS PM”格式（12时制） 02:25:51 下午 T “HH:MM:SS”格式（24时制） 14:28:16 R “HH:MM”格式（24时制） 14:28 示例 System.out.println(String.format(\"Hi,%s\", \"字符串\")); // Hi,字符串 System.out.println(String.format(\"Hi,%s %s %s\", \"字\", \"符\", \"串\")); // Hi,字 符 串 System.out.printf(\"字母c的大写是：%c %n\", 'C'); // 字母c的大写是：C System.out.printf(\"布尔结果是：%b %n\", false); // 布尔结果是：false System.out.printf(\"100的一半是：%d %n\", 100 / 2); // 100的一半是：50 System.out.printf(\"100的16进制数是：%x %n\", 100); // 100的16进制数是：64 System.out.printf(\"100的8进制数是：%o %n\", 100); // 100的8进制数是：144 System.out.printf(\"50元的书打8.5折扣是：%f 元%n\", 50 * 0.85); // 50元的书打8.5折扣是：42.500000 元 System.out.printf(\"上面价格的16进制数是：%a %n\", 50 * 0.85); // 上面价格的16进制数是：0x1.54p5 System.out.printf(\"上面价格的指数表示：%e %n\", 50 * 0.85); // 上面价格的指数表示：4.250000e+01 System.out.printf(\"上面价格的指数和浮点长度较短的是：%g %n\", 50 * 0.85); // 上面价格的指数和浮点长度较短的是：42.5000 System.out.printf(\"上面的折扣是%d%% %n\", 85); // 上面的折扣是85% System.out.printf(\"字母A的散列码是：%h %n\", 'A'); // 字母A的散列码是：41 Date date = new Date(); System.out.printf(\"c的使用 全部日期和时间信息：%tc%n\", date); // c的使用 全部日期和时间信息：星期四 八月 12 09:54:37 CST 2021 System.out.printf(\"f的使用 年-月-日格式：%tF%n\", date); // f的使用 年-月-日格式：2021-08-12 System.out.printf(\"d的使用 月/日/年格式：%tD%n\", date); // d的使用 月/日/年格式：08/12/21 System.out.printf(\"r的使用 HH:MM:SS PM格式（12时制）：%tr%n\", date); // r的使用 HH:MM:SS PM格式（12时制）：09:54:37 上午 System.out.printf(\"t的使用 HH:MM:SS格式（24时制）：%tT%n\", date); // t的使用 HH:MM:SS格式（24时制）：09:54:37 System.out.printf(\"R的使用 HH:MM格式（24时制）：%tR\", date); // R的使用 HH:MM格式（24时制）：09:54 高级用法 标志 说明 示例 结果 - 整数之后添加指定数量(=整数位数+空格数)的空格 (\"%-5d\", 15) 15 + 为正数或者负数添加符号 (\"%+d\", 15) +15 空格 在整数之前添加指定数量(=整数位数+空格数)的空格 (\"% 5d\", 99) 99 0 数字前面补0 (\"%04d\", 99) 0099 , 以“,”对数字分组 (\"%,f\", 9999.99) 9,999.990000 ( 使用括号包含负数 (\"%(f\", -99.99) (99.990000) # 如果是浮点数则包含小数点，如果是16进制或8进制则添加0x或0 (\"%#x\", 99) (\"%#o\", 99) 格式化前一个转换符所描述的参数 (\"%f和% 99.450000和99.45 $ 被格式化的参数索引 (\"%1$d,%2$s\", 99,\"abc\") 99,abc © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-06-22 "},"java/stream.html":{"url":"java/stream.html","title":"Stream","keywords":"","body":"Java 8 Stream 部分 Stream 常用操作整理 测试对象 public class Obj { private String code; private Integer value; public Obj() { } public Obj(String code, Integer value) { this.code = code; this.value = value; } public String getCode() { return code; } public void setCode(String code) { this.code = code; } public Integer getValue() { return value; } public void setValue(Integer value) { this.value = value; } @Override public String toString() { return \"Obj{code='\" + code + '\\'' + \", value=\" + value + \"}\"; } } 测试list List strList = new ArrayList(); strList.add(\"B\"); strList.add(\"C\"); strList.add(\"E\"); strList.add(\"A\"); List objList = new ArrayList(); objList.add(new Obj(\"B\", 2)); objList.add(new Obj(\"C\", 3)); objList.add(new Obj(\"E\", 4)); objList.add(new Obj(\"A\", 1)); 类型转换 // List -> Map Map map = objList.stream().collect(Collectors.toMap(Obj::getCode, Obj::getValue)); // {A=A1, B=B1, C=C1, E=E1} // List -> Map Map objMap = objList.stream().collect(Collectors.toMap(Obj::getCode, obj -> obj)); // {A=Obj{code='A', value=1}, B=Obj{code='B', value=2}, C=Obj{code='C', value=3}, E=Obj{code='E', value=4}} // List -> List List list = objList.stream().map(obj -> obj.getCode()).collect(Collectors.toList()); // B C E A // List -> Set Set set = objList.stream().collect(Collectors.toSet()); // [Obj{code='B', value=2}, Obj{code='E', value=4}, Obj{code='C', value=3}, Obj{code='A', value=1}] // List -> String[] String[] array = objList.stream().map(obj -> obj.getCode()).toArray(String[]::new); // B C E A // List -> int[] int[] array = objList.stream().mapToInt(obj -> obj.getValue()).toArray(); // 2 3 4 1 // List -> String String join = strList.stream().collect(Collectors.joining()); // BCEA String joining = strList.stream().collect(Collectors.joining(\",\")); // B,C,E,A 排序 自然序排序，常用于基本数据类型 List list = strList.stream().sorted().collect(Collectors.toList()); // A B C E // 逆序 List list = strList.stream().sorted(Comparator.reverseOrder()).collect(Collectors.toList()); // E C B A // 不使用stream strList.sort(Comparator.comparing(String::toString)); // 逆序 strList.sort(Comparator.comparing(String::toString).reversed()); 使用Comparator排序，常用于对象类型 List list = objList.stream().sorted(Comparator.comparing(Obj::getCode)).collect(Collectors.toList()); // Obj{code='A', value=1} Obj{code='B', value=2} Obj{code='C', value=3} Obj{code='E', value=4} // 逆序 List list = objList.stream().sorted(Comparator.comparing(Obj::getCode).reversed()).collect(Collectors.toList()); // Obj{code='E', value=4} Obj{code='C', value=3} Obj{code='B', value=2} Obj{code='A', value=1} // 不使用stream objList.sort(Comparator.comparing(Obj::getCode)); // 逆序 objList.sort(Comparator.comparing(Obj::getCode).reversed()); 存在（anyMatch）、全部匹配（allMatch）、无匹配（noneMatch）、过滤（filter）、获取过滤后第一个（findFirst）、获取过滤后任意一个（findAny） // 存在（anyMatch） boolean anyMatch = objList.stream().anyMatch(obj -> \"E\".equals(obj.getCode())); // true // 全部匹配（allMatch） boolean allMatch = objList.stream().allMatch(obj -> obj.getValue() > 0); // true // 无匹配（noneMatch） boolean noneMatch = objList.stream().noneMatch(obj -> obj.getValue() > 4); // true // 过滤（filter） List collect = objList.stream().filter(obj -> obj.getValue() > 2).collect(Collectors.toList()); // [Obj{code='C', value=3}, Obj{code='E', value=4}] // 获取过滤后第一个（findFirst） Obj obj = objList.stream().filter(obj -> obj.getValue() > 2).findFirst().get(); // Obj{code='C', value=3} // 获取过滤后任意一个（findAny），对数据没有顺序上的要求，findAny的效率比findFirst要快 Obj obj = objList.stream().filter(obj -> obj.getValue() > 2).findAny().get(); // Obj{code='C', value=3} 聚合求值（reduce、Collectors.reducing） int totalVal = objList.stream().map(obj -> obj.getValue()).reduce(0, (sum, val) -> sum + val); // 10 int totalVal = objList.stream().collect(Collectors.reducing(0, Obj::getValue, (sum, val) -> sum + val)); // 10 统计（IntSummaryStatistics、LongSummaryStatistics、DoubleSummaryStatistics） IntSummaryStatistics summaryStatistics = objList.stream().collect(Collectors.summarizingInt(Obj::getValue)); double average = summaryStatistics.getAverage(); // 平均值 2.5 long count = summaryStatistics.getCount(); // 个数 4 int min = summaryStatistics.getMin(); // 最小值 1 int max = summaryStatistics.getMax(); // 最大值 4 long sum = summaryStatistics.getSum(); // 求和 10 求和 // int int totalVal = objList.stream().mapToInt(obj -> obj.getValue()).sum(); // 10 // double double totalVal = objList.stream().mapToDouble(obj -> obj.getValue().doubleValue()).sum(); // 10.0 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"java/fastjson.html":{"url":"java/fastjson.html","title":"FastJson","keywords":"","body":"FastJson springboot中配置请查看 maven依赖 com.alibaba fastjson 1.2.51 SerializerFeature 含义 SerializerFeature 含义 备注 QuoteFieldNames 输出key时是否使用双引号，默认为true UseSingleQuotes 使用单引号而不是双引号，默认为false WriteMapNullValue 是否输出值为null的字段，默认为false 常用 WriteEnumUsingToString Enum输出toString()，默认为false WriteEnumUsingName Enum输出name()，默认为false UseISO8601DateFormat Date使用ISO8601格式输出，默认为false WriteNullListAsEmpty 将Collection类型字段的字段空值输出为[] 常用 WriteNullStringAsEmpty 将字符串类型字段的空值输出为空字符串 \"\" 常用 WriteNullNumberAsZero 将数值类型字段的空值输出为0 WriteNullBooleanAsFalse 将Boolean类型字段的空值输出为false SkipTransientField 如果是true，类中的Get方法对应的Field是transient，序列化时将会被忽略。默认为true SortField 按字段名称排序后输出。默认为false WriteTabAsSpecial 把\\t做转义输出，默认为false PrettyFormat 结果是否格式化，默认为false WriteClassName 序列化时写入类型信息，默认为false。反序列化是需用到 DisableCircularReferenceDetect 消除对同一对象循环引用的问题，默认为false WriteSlashAsSpecial 对斜杠 \"/\" 进行转义 BrowserCompatible 将中文都会序列化为\\uXXXX格式，字节数会多一些，但是能兼容IE 6，默认为false WriteDateUseDateFormat 全局修改日期格式，默认为false。JSON.DEFFAULT_DATE_FORMAT = \"yyyy-MM-dd\";JSON.toJSONString(obj, SerializerFeature.WriteDateUseDateFormat); NotWriteRootClassName DisableCheckSpecialChar 一个对象的字符串属性中如果有特殊字符如双引号，将会在转成json时带有反斜杠转移符。如果不需要转义，可以使用这个属性。默认为false BeanToArray 将对象转为array输出 WriteNonStringKeyAsString NotWriteDefaultValue BrowserSecure IgnoreNonFieldGetter WriteNonStringValueAsString IgnoreErrorGetter WriteBigDecimalAsPlain MapSortField json -> 指定泛型类型 反序列化 // new TypeReference() { } HashMap> map = JSON.parseObject(json, new TypeReference>>() { }); © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"java/compare.html":{"url":"java/compare.html","title":"compareTo 比较大小","keywords":"","body":"compareTo 比较大小 字符串比较大小，按字典顺序比较对象比较大小，需实现Comparable接口可理解为数字减法，字符串是从第一个字符开始比较前者 减 后者相等 -> 0大于0 -> 1小于0 -> -1 Date类型比较 // 此处例举两个Date类型时间 Date dateA Date dateB // 比较 dateA.compareTo(dateB) // 结果 // Date dateA = // Date dateB = // 输出 0 -> dateA 与 dateB 为同一时间，两者相等 // Date dateA = // Date dateB = // 输出 1 -> dateA 晚于 dateB，前者大 // Date dateA = // Date dateB = // 输出 -1 -> dateA 早于 dateB，后者大 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"java/utils.html":{"url":"java/utils.html","title":"Java工具类","keywords":"","body":"java工具类 JWT常用工具 依赖io.jsonwebtoken.jjwt io.jsonwebtoken jjwt 0.9.1 /** * Jwt工具类 */ public class JwtUtil { // 日志 private static final Logger log = LoggerFactory.getLogger(JwtUtil.class); // JWT 加解密类型 private static final SignatureAlgorithm JWT_ALG = SignatureAlgorithm.HS256; // JWT 秘钥，勿暴露于前端 private static final String JWT_SECRET = \"Y29tQHNoYW5kb25nI2hvbmdlbg\"; /** * 加密 * @param subjectJson JSON * @param expire 超时时间，单位秒 * @return */ public static String buildJWT(String subjectJson, int expire) { // 生成JWT的时间 Date startDate = DateUtil.date(); // 过期时间 Date endDate = DateUtil.offset(startDate, DateField.SECOND, expire); // 为payload添加各种标准声明和私有声明 JwtBuilder builder = Jwts.builder() // new一个JwtBuilder，设置jwt的body .setId(IdUtil.simpleUUID()) // JWT的唯一标识，回避重放攻击 .setIssuedAt(startDate) // 签发时间 .setExpiration(endDate) // 过期时间 .setSubject(subjectJson) // json格式的字符串 .compressWith(CompressionCodecs.DEFLATE) .signWith(JWT_ALG, generalKey()); // 设置签名算法和密钥 return builder.compact(); } // 测试方法 public static void main(String[] args) { String buildJWT = buildJWT(\"aaaaa\", 2); System.out.println(buildJWT); System.out.println(parseJWT(buildJWT)); } /** * Jwt解析 * @param jwt 内容文本 * @return */ public static String parseJWT(String jwt) { Jws claimsJws = getClaimsJws(jwt); Claims body = claimsJws.getBody(); // 获取加密的内容JSON并返回 String subjectJson = body.getSubject(); return subjectJson; } /** * Jwt验证（true：验证通过，false：验证失败） * @param jwt 内容文本 * @return */ public static boolean checkJWT(String jwt) { return ObjectUtil.isNotNull(getClaimsJws(jwt)); } /** * parseClaimsJws * @param jwt 内容文本 * @return */ private static Jws getClaimsJws(String jwt) { Jws parseClaimsJws = null; try { SecretKey generalKey = generalKey(); JwtParser parser = Jwts.parser().setSigningKey(generalKey); parseClaimsJws = parser.parseClaimsJws(jwt); } catch (Exception e) { log.warn(\"JWT验证失败，原因：{}\", e.getMessage()); } return parseClaimsJws; } /** * 生成加密key，单例模式 * @return */ private static SecretKey generalKey() { return JwtSecretKeyHolder.instance; } private static class JwtSecretKeyHolder { // 服务端保存的jwt 秘钥 static final String str = JWT_SECRET; static final byte[] encodedKey = str.getBytes(); private static final SecretKey instance = new SecretKeySpec(encodedKey, JWT_ALG.getJcaName()); } } 返回值包装工具 异常处理可参照 /** * Result.java * 返回值包装类 * @param */ public class Result { // 状态码 private int code; // 状态信息 private String msg; // 返回值 private T data; // 默认无参构造 public Result() { } /** * 构造函数 * @param resultEnum 枚举 */ public Result(ResultEnums resultEnum) { this.code = resultEnum.getCode(); this.msg = resultEnum.getMsg(); } /** * 构造函数 * @param code 状态码 * @param msg 状态信息 */ public Result(int code, String msg) { this.code = code; this.msg = msg; } /** * 构造函数 * @param resultEnum 枚举 * @param data 返回值 */ public Result(ResultEnums resultEnum, T data) { this.code = resultEnum.getCode(); this.msg = resultEnum.getMsg(); this.data = data; } /** * 构造函数 * @param code 状态码 * @param msg 状态信息 * @param data 返回值 */ public Result(int code, String msg, T data) { this.code = code; this.msg = msg; this.data = data; } public int getCode() { return code; } public void setCode(int code) { this.code = code; } public String getMsg() { return msg; } public void setMsg(String msg) { this.msg = msg; } public T getData() { return data; } public void setData(T data) { this.data = data; } } /** * ResultUtil.java * 返回值包装工具类 */ public class ResultUtil { /** * 请求成功，无返回结果的 * @param * @return */ public static Result success() { return new Result<>(ResultEnums.SUCCESS); } /** * 请求成功，通用提示 * @param resultEnums * @param * @return */ public static Result success(ResultEnums resultEnums) { return new Result<>(resultEnums); } /** * 请求成功 * @param object 返回值 * @param * @return */ public static Result success(T object) { return new Result<>(ResultEnums.SUCCESS, object); } /** * 请求成功（如：保存、修改成功，返回结果可为null，提示保存成功、修改成功、删除成功等） * @param msg * @param object 返回值 * @param * @return */ public static Result success(String msg, T object) { return new Result<>(ResultEnums.SUCCESS.getCode(), msg, object); } /** * 请求成功 * @param resultEnums * @param object 返回值 * @param * @return */ public static Result success(ResultEnums resultEnums, T object) { return new Result<>(resultEnums, object); } /** * 请求失败（Enums.FAILED，请求失败） * @param * @return */ public static Result error() { return new Result<>(ResultEnums.FAILED); } /** * 请求失败（Enums中定义的错误） * @param resultEnum * @param * @return */ public static Result error(ResultEnums resultEnum) { return new Result<>(resultEnum); } /** * 请求失败（Enums.FAILED，msg自定义，如：返回一些字段验证错误信息，使用频率低没必要在Enums中定义的） * @param msg * @param * @return */ public static Result error(String msg) { return new Result<>(ResultEnums.FAILED.getCode(), msg); } /** * 请求失败（code，msg 都是自定义，尽量现在Enums中定义错误（尤其是常用的错误），避免使用此方法） * @param code * @param msg * @param * @return */ public static Result error(int code, String msg) { return new Result<>(code, msg); } } MultipartFile转File 转换后File文件存放于系统临时目录，使用完需删除该临时文件 /** * MultipartFile 转 File，并存放到系统临时目录中 * @param file 文件 * @return File * @throws IOException */ public static File multipartFile2File(MultipartFile file) throws IOException { return multipartFile2File(file, null, null); } /** * MultipartFile 转 File，并存放到系统临时目录中 * @param file 文件 * @param path 路径（不带 /） * @param name 文件名 * @return File * @throws IOException */ public static File multipartFile2File(MultipartFile file, String path, String name) throws IOException { // 获取系统临时目录 String tmpPath = System.getProperty(\"java.io.tmpdir\"); // 处理路径为空的情况 if (StrUtil.isEmpty(path)) { path = \"\"; } else { path += \"/\"; } if (StrUtil.isEmpty(name)) { // 文件名为空，设置默认，文件名前增加4位随机字符串，防止重复 name = RandomUtil.randomString(4) + file.getOriginalFilename(); } File dir = new File(StrUtil.format(\"{}/{}\", tmpPath, path)); // 目录不存在，创建目录 if (!dir.exists()) { dir.mkdirs(); } // 将转换后的新文件暂存到临时目录，文件使用完后需删除 File newFile = new File(StrUtil.format(\"{}/{}{}\", tmpPath, path, name)); BufferedInputStream bis = null; BufferedOutputStream bos = null; InputStream is = null; FileOutputStream fos = null; try { is = file.getInputStream(); bis = new BufferedInputStream(is); fos = new FileOutputStream(newFile); bos = new BufferedOutputStream(fos); int bytesRead; byte[] buffer = new byte[8192]; while ((bytesRead = bis.read(buffer, 0, 8192)) >= 0) { bos.write(buffer, 0, bytesRead); } bos.flush(); } catch (IOException e) { if (bos != null) { bos.close(); bos = null; } if (bis != null) { bis.close(); bis = null; } if (fos != null) { fos.close(); fos = null; } if (is != null) { is.close(); is = null; } // 如果出现异常，删除该文件，需先关闭流 newFile.delete(); throw e; } finally { if (bos != null) bos.close(); if (bis != null) bis.close(); if (fos != null) fos.close(); if (is != null) is.close(); } return newFile; } 切片文件合并 涉及工具类cn.hutool.hutool-all自定义业务异常可参照 /** * 系统临时目录中，合并文件 * @param path 文件在系统临时目录中的路径，md5 * @param chunks 切片数量 * @param suffix 文件后缀 * @param md5 文件md5 * @return File * @throws IOException * @throws BusinessException */ public static File fileMerge(String path, int chunks, String suffix, String md5) throws IOException, BusinessException { // 获取系统临时目录 String tmpPath = System.getProperty(\"java.io.tmpdir\"); File dir = new File(StrUtil.format(\"{}/{}\", tmpPath, path)); // 如果不存在或者不为文件夹，直接返回null if (!dir.exists() || !dir.isDirectory()) { throw new BusinessException(ResultEnums.FAILED.getCode(), \"切片文件不存在，请重新上传\"); } File[] files = dir.listFiles(); if (files == null || files.length = 0) { bos.write(buffer, 0, bytesRead); } bis.close(); fis.close(); f.delete(); } } bos.flush(); } finally { if (bos != null) bos.close(); if (fos != null) fos.close(); } // 文件处理完后删除目录 dir.delete(); // 校验文件MD5是否与上传前一致 if (StrUtil.isNotEmpty(md5)) { String newFileMd5 = SecureUtil.md5(newFile); if (!md5.equals(newFileMd5)) { // 删除该文件 newFile.delete(); // 文件校验失败提示 throw new BusinessException(ResultEnums.FAILED.getCode(), \"文件合并失败，请重新上传\"); } } // 返回合并后的新文件 return newFile; } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"index/spring.html":{"url":"index/spring.html","title":"Spring","keywords":"","body":"Spring 自定义异常 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"spring/exception.html":{"url":"spring/exception.html","title":"自定义异常","keywords":"","body":"自定义异常处理 基于Aspectj的自定义注解异常处理 定义业务异常类 /** * BusinessException.java * 自定义业务异常 * 继承RuntimeException，而不是Exception，否则导致spring事务无法回滚 */ public class BusinessException extends RuntimeException { private static final long serialVersionUID = 1L; // 自定义错误码 private int code; private String msg; public BusinessException(ResultEnums resultEnum) { super(resultEnum.getMsg()); this.code = resultEnum.getCode(); } public BusinessException(int code, String msg) { super(msg); this.code = code; } public int getCode() { return code; } public void setCode(int code) { this.code = code; } public String getMsg() { return msg; } public void setMsg(String msg) { this.msg = msg; } } /** * ResultEnums.java * 自定义异常枚举：返回码-->返回信息 */ public enum ResultEnums { // 常用信息 ERROR(-1, \"请求错误\"), FAILED(0, \"请求失败\"), SUCCESS(1, \"请求成功\") ; // 状态码 private int code; // 返回信息 private String msg; ResultEnums(int code, String msg) { this.code = code; this.msg = msg; } public int getCode() { return code; } public String getMsg() { return msg; } } 自定义 Service 异常注解及处理 /** * ServiceExceptionHandler.java * 自定义Service异常注解 */ @Target({ ElementType.METHOD }) @Retention(RetentionPolicy.RUNTIME) @Documented public @interface ServiceExceptionHandler { } /** * ServiceExceptionAspect.java * 自定义Service异常处理AOP */ @Component @Aspect public class ServiceExceptionAspect { private static final Logger log = LoggerFactory.getLogger(ServiceExceptionAspect.class); public ServiceExceptionAspect() {} /** * 异常通知, 在方法抛出异常之后 * pointcut：切入点是带有@ServiceExceptionHandler注解的方法 * @annotation()中填写@ServiceExceptionHandler注解位置 * @param joinPoint * @param throwable * @throws BusinessException */ @AfterThrowing( pointcut = \"@annotation(com.admin.api.config.ServiceExceptionHandler)\", throwing = \"throwable\" ) public void afterRuntimeException(JoinPoint joinPoint, Throwable throwable) throws BusinessException { // 如果是业务异常，直接抛出 if (throwable instanceof BusinessException) { throw (BusinessException) throwable; } else if (throwable instanceof RuntimeException) { // 如果是运行时异常，记录异常之后，包装成业务异常在抛出 log.error(\"service: {}\", throwable.getMessage(), throwable); throw new BusinessException(ResultEnums.ERROR); } } } 自定义 Controller 异常注解及处理 /** * ControllerExceptionHandler.java * 自定义Controller异常注解 */ @Target({ ElementType.METHOD }) @Retention(RetentionPolicy.RUNTIME) @Documented public @interface ControllerExceptionHandler { } /** * ControllerExceptionAspect.java * 自定义Controller异常处理AOP */ @Component @Aspect public class ControllerExceptionAspect { private static final Logger log = LoggerFactory.getLogger(ControllerExceptionAspect.class); /** * 环绕通知, 围绕着方法执行 * 切入点是带有@ControllerExceptionHandler注解的方法 * @annotation()中填写@ControllerExceptionHandler注解位置 * @param joinPoint * @return */ @Around(\"@annotation(com.admin.api.config.ControllerExceptionHandler)\") public Object controllerMethodHandler(ProceedingJoinPoint joinPoint) { try { return joinPoint.proceed(); } catch (Throwable throwable) { // 如果是业务异常，直接抛出 if (throwable instanceof BusinessException) { throw (BusinessException) throwable; } else { // 非业务异常，记录异常之后，包装成业务异常在抛出 log.error(\"Controller: {}\", throwable.getMessage(), throwable); throw new BusinessException(ResultEnums.ERROR); } } } } 异常处理，返回json格式的异常包装信息可参照，而非错误页面 /** * ExceptionHandler.java * 全局异常处理 */ @ControllerAdvice public class ExceptionHandler { private final static Logger log = LoggerFactory.getLogger(ExceptionHandler.class); /** * 异常处理，返回json格式的异常包装信息，而非错误页面 * @param e * @return */ @org.springframework.web.bind.annotation.ExceptionHandler(value = Exception.class) @ResponseBody public Result handler(Exception e) { if (e instanceof BusinessException) { // 业务异常，响应相应错误 BusinessException be = (BusinessException) e; return ResultUtil.error(be.getCode(), be.getMessage()); } else { log.error(\"--- 系统异常 --> {}\", e); // 系统异常，相应相应错误 return ResultUtil.error(ResultEnums.ERROR.getCode(), ResultEnums.ERROR.getMsg()); } } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"index/springboot.html":{"url":"index/springboot.html","title":"SpringBoot","keywords":"","body":"SpringBoot SpringBoot开发中遇到过的问题总结。 Put请求配置 FastJson配置 跨域配置 MyBatis Redis RabbitMQ Excel 启动方式 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"springboot/put-config.html":{"url":"springboot/put-config.html","title":"Put请求配置","keywords":"","body":"Put请求无法获取参数对象 SpringBoot中使用RESTful API设计规范，如果Put请求无法将参数转为对象，以下两种配置可选。springframework 版本 5.1 及之后，使用FormContentFilter替代HttpPutFormContentFilter。 @Configuration public class WebMvcConfig extends WebMvcConfigurationSupport { /** * 解决put请求无法将参数转为对象 * @return */ @Bean public FormContentFilter httpPutFormContentFilter() { return new FormContentFilter(); } } // 使用：@Component，原理一样，开启：FormContentFilter @Component public class PutFilter extends FormContentFilter { } SpringBoot中使用RESTful API设计规范，如果Put请求无法将参数转为对象，以下两种配置可选。springframework 版本从 3.1 开始，到 5.1 之前，不包含 5.1 。 @Configuration public class WebMvcConfig extends WebMvcConfigurationSupport { /** * 解决put请求无法将参数转为对象 * @return */ @Bean public HttpPutFormContentFilter httpPutFormContentFilter() { return new HttpPutFormContentFilter(); } } // 使用：@Component，原理一样，开启：HttpPutFormContentFilter @Component public class PutFilter extends HttpPutFormContentFilter { } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"springboot/fastjson-config.html":{"url":"springboot/fastjson-config.html","title":"FastJson配置","keywords":"","body":"FastJson处理响应数据 SpringBoot中使用FastJson将响应的数据转成json相关配置springframework 版本 5.2 及之后，直接使用使用MediaType.APPLICATION_JSON即可，无需专门指定charset=UTF-8。FastJeon序列化属性请查看 @Configuration public class WebMvcConfig extends WebMvcConfigurationSupport { /** * FastJson对响应数据处理的相关配置 */ @Override public void configureMessageConverters(List> converters) { FastJsonHttpMessageConverter fastConverter = new FastJsonHttpMessageConverter(); FastJsonConfig fastJsonConfig = new FastJsonConfig(); // 序列化 fastJsonConfig.setSerializerFeatures( SerializerFeature.WriteMapNullValue, SerializerFeature.WriteNullStringAsEmpty, SerializerFeature.WriteNullNumberAsZero, SerializerFeature.WriteNullListAsEmpty ); // 时间戳格式 fastJsonConfig.setDateFormat(\"yyyy-MM-dd HH:mm:ss\"); // 处理中文乱码问题 List fastMediaTypes = new ArrayList(); // fastMediaTypes.add(MediaType.APPLICATION_JSON_UTF8); // springframework 5.2后无需指定charset=UTF-8，直接使用MediaType.APPLICATION_JSON即可 fastMediaTypes.add(MediaType.APPLICATION_JSON); fastConverter.setSupportedMediaTypes(fastMediaTypes); // 设置 fastConverter.setFastJsonConfig(fastJsonConfig); converters.add(fastConverter); } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"springboot/cors-config.html":{"url":"springboot/cors-config.html","title":"跨域配置","keywords":"","body":"跨域配置 SpringBoot添加跨域配置有以下两种配置方法使用addCorsMappings方式配置跨域：要区分SpringBoot版本SpringBoot2.4之前：.allowedOrigins(\"*\")SpringBoot2.4及之后：.allowedOriginPatterns(\"*\") @Configuration public class WebMvcConfig extends WebMvcConfigurationSupport { /** * 跨域配置 */ @Override protected void addCorsMappings(CorsRegistry registry) { registry.addMapping(\"/**\") // 允许跨域的源，SpringBoot2.4之前 // .allowedOrigins(\"*\") // SpringBoot2.4及之后使用allowedOriginPatterns .allowedOriginPatterns(\"*\") // 是否允许浏览器发送Cookie .allowCredentials(true) // 客户端所要访问的资源允许使用的方法或方法列表 .allowedMethods(\"OPTIONS\", \"HEAD\", \"POST\", \"GET\", \"PUT\", \"DELETE\") // 正式请求的首部信息 // x-requested-with：ajax请求 .allowedHeaders(\"X-Requested-With\") // preflight request （预检请求）的返回结果 //（即 Access-Control-Allow-Methods 和Access-Control-Allow-Headers 提供的信息） // 可以被缓存多久 .maxAge(3600); super.addCorsMappings(registry); } } /** * 跨域访问过滤器 */ @Component public class CorsFilter implements Filter { @Override public void destroy() { } @Override public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException { HttpServletResponse response = (HttpServletResponse) res; HttpServletRequest request = (HttpServletRequest) req; // 也可以使用\"*\"，最好是从request中的header中获取Origin，来做配置 response.setHeader(\"Access-Control-Allow-Origin\", request.getHeader(\"Origin\")); // 是否允许浏览器发送Cookie response.setHeader(\"Access-Control-Allow-Credentials\", \"true\"); // 客户端所要访问的资源允许使用的方法或方法列表 response.setHeader(\"Access-Control-Allow-Methods\", \"OPTIONS, HEAD, POST, GET, PUT, DELETE\"); // 正式请求的首部信息 // x-requested-with：ajax请求 response.setHeader(\"Access-Control-Allow-Headers\", \"X-Requested-With\"); // preflight request （预检请求）的返回结果 //（即 Access-Control-Allow-Methods 和Access-Control-Allow-Headers 提供的信息） // 可以被缓存多久 response.setHeader(\"Access-Control-Max-Age\", \"3600\"); chain.doFilter(req, res); } @Override public void init(FilterConfig config) throws ServletException { } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"springboot/mybatis.html":{"url":"springboot/mybatis.html","title":"MyBatis","keywords":"","body":"MyBatis SpringBoot中使用MyBatis（maven地址）的一些问题及知识点 1、自增id，并返回新id 需要数据库表支持，相关请点击查看MySQL-自增字段PostgreSQL-自增字段 使用tk.mybatis.mapper通用mapper，com.alibaba.druid数据库连接池，相关依赖如下tk mapper maven地址druid maven地址 com.alibaba druid-spring-boot-starter 1.1.20 tk.mybatis mapper-spring-boot-starter 2.1.5 1、实体类id字段增加以下注解 @Id @KeySql(useGeneratedKeys = true) @Column(name = \"id\", insertable = false) 2、调用dao的insert方法或者insertSelective方法,执行之后都会将新的id赋值给实体类id字段，直接通过实体类getId()获取id 示例 /** * 实体类 */ @Entity @Table(name = \"t_goods\") public class Goods { @Id @KeySql(useGeneratedKeys = true) @Column(name = \"id\", insertable = false) private Integer id; private String name; // getter and setter } /** * Dao */ @Mapper public interface GoodsDao extends BaseDao { } /** * 调用dao的insert方法 * insert和insertSelective执行之后都会将新的id赋值给实体类id字段 */ @RunWith(SpringRunner.class) @SpringBootTest public class GoodsDaoTest { @Autowired private GoodsDao goodsDao; @Test public void test() { Goods goods = new Goods(); goods.setName(\"this is name\"); int row = goodsDao.insert(goods); // int row = goodsDao.insertSelective(goods); System.out.println(goods.getId()); } } 相关问题 1、使用PageHelper分页时报错 Cause: java.sql.SQLException: Parameter index out of range (5 > number of parameters, which is 4) 原因：MyBatis的mapper.xml中存在sql注释，导致PageHelper无法赋值分页条件解决方法：去掉mapper.xml中存在sql注释即可 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"springboot/redis.html":{"url":"springboot/redis.html","title":"Redis","keywords":"","body":"Redis Redis中key值过期通知 CentOS版本7.9，redis版本5.0.10 依赖 org.springframework.boot spring-boot-starter-data-redis 配置Redis配置文件中要配置键空间通知，过期事件的监听notify-keyspace-events Ex，更多配置请查看 import org.springframework.data.redis.connection.Message; import org.springframework.data.redis.connection.MessageListener; import org.springframework.stereotype.Component; import java.util.HashMap; import java.util.Map; import java.util.function.Consumer; /** * Redis消息监听器 */ @Component public class RedisMessageListener implements MessageListener { // 存放订阅回调函数，key可以是添加订阅所在的类名，this.getClass().getName() private final Map> subscribeMap = new HashMap<>(); /** * 添加订阅 * @param key key可以是添加订阅所在的类名，this.getClass().getName() * @param function 存放订阅回调函数 */ public void addSubscribe(String key, Consumer function) { subscribeMap.put(key, function); } @Override public void onMessage(Message message, byte[] pattern) { // 遍历订阅回调函数，有消息通知时，分别执行 if (null != message) { subscribeMap.values().forEach(function -> function.accept(message.toString())); } } } import org.springframework.beans.factory.annotation.Autowired; import org.springframework.beans.factory.annotation.Value; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import org.springframework.data.redis.connection.RedisConnectionFactory; import org.springframework.data.redis.listener.ChannelTopic; import org.springframework.data.redis.listener.RedisMessageListenerContainer; /** * Redis 配置 */ @Configuration public class RedisConfig { @Autowired private RedisConnectionFactory redisConnectionFactory; @Autowired private RedisMessageListener redisMessageListener; @Value(\"${spring.redis.database}\") private int database; // 键事件通知前缀，__keyevent@__:expired private final String topicNameTemplate = \"__keyevent@%d__:expired\"; /** * 创建消息接收容器 */ @Bean public RedisMessageListenerContainer redisMessageListenerContainer() { RedisMessageListenerContainer container = new RedisMessageListenerContainer(); ChannelTopic topic = new ChannelTopic(String.format(topicNameTemplate, database)); container.setConnectionFactory(redisConnectionFactory); container.addMessageListener(redisMessageListener, topic); return container; } } 使用 @Service public class BusinessService { @Autowired public void registerRedisMessageListener(RedisMessageListener redisMessageListener) { // 回调函数的key为过期的key redisMessageListener.addSubscribe(this.getClass().getName(), key -> { // 根据key进行业务操作，可以直接调用业务service // 分布式部署时，会通知所有节点，防止重复操作业务数据，需加锁处理，LockService }); } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"springboot/rabbitmq.html":{"url":"springboot/rabbitmq.html","title":"RabbitMQ","keywords":"","body":"RabbitMQ 依赖 org.springframework.boot spring-boot-starter-amqp 延时队列 CentOS版本7.9，RabbitMQ版本3.8.19-1.el7，Erlang版本23.3.4.5-1.el7 # rabbitmq yml 配置 spring: # 连接配置 rabbitmq: host: 127.0.0.1 port: 5672 virtual-host: / username: password: 1、TTL + 死信队列 1、TTL队列，创建交换机（任意），创建队列并设置x-dead-letter-exchange，x-dead-letter-routing-key；2、死信队列，创建交换机（一般为DirectExchange），创建队列；3、注意TTL队列与死信队列之间的Routing key一致；4、只对死信队列进行监听消费，TTL队列无消费者超时自动投递到死信交换机，达到延时目的。注意：TTL时间可以在创建TTL队列时统一设置，也可以在发送消息时设置expiration，message.getMessageProperties().setExpiration(\"5000\") import org.springframework.amqp.core.*; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; /** * RabbitMQ 配置 */ @Configuration public class RabbitMQConfig { // TTL交换机名称 public static final String TTL_EXCHANGE_NAME = \"mq.exchange.ttl\"; // TTL队列名称 public static final String TTL_QUEUE_NAME = \"mq.queue.ttl\"; // TTL Routingkey，topic类型 private final String TTL_ROUTING_KEY = \"ttl.#\"; // 死信交换机名称 private final String DEAD_LETTER_EXCHANGE_NAME = \"mq.exchange.dead.letter\"; // 死信队列名称 public static final String DEAD_LETTER_QUEUE_NAME = \"mq.queue.dead.letter\"; // 死信队列Routingkey private final String DELAY_TO_DEAD_ROUTING_KEY = \"dead.letter\"; // TTL交换机 @Bean public TopicExchange ttlExchange() { return ExchangeBuilder.topicExchange(TTL_EXCHANGE_NAME).durable(true).build(); } // TTL队列 @Bean public Queue ttlQueue() { Map args = new HashMap<>(2); // 死信队列交换机 args.put(\"x-dead-letter-exchange\", DEAD_LETTER_EXCHANGE_NAME); // 死信队列路由key args.put(\"x-dead-letter-routing-key\", DELAY_TO_DEAD_ROUTING_KEY); return QueueBuilder.durable(TTL_QUEUE_NAME).withArguments(args).build(); } // TTL队列绑定到交换机 @Bean public Binding ttlExchangeBinding() { return BindingBuilder.bind(ttlQueue()).to(ttlExchange()).with(TTL_ROUTING_KEY); } // 死信交换机 @Bean public DirectExchange deadLetterExchange() { return new DirectExchange(DEAD_LETTER_EXCHANGE_NAME, true, false, null); } // 死信队列 @Bean public Queue deadLetterQueue() { return new Queue(DEAD_LETTER_QUEUE_NAME, true, false, false, null); } // 死信队列绑定到交换机 @Bean public Binding deadLetterExchangeBinding() { return BindingBuilder.bind(deadLetterQueue()).to(deadLetterExchange()).with(DELAY_TO_DEAD_ROUTING_KEY); } } import org.springframework.amqp.rabbit.annotation.RabbitListener; import org.springframework.stereotype.Service; /** * RabbitMQ 消息消费者 */ @Service public class RabbitMQMessageReceiver { // 死信队列监听 @RabbitListener(queues = RabbitMQConfig.DEAD_LETTER_QUEUE_NAME) public void receiveDeadLetterMessage(String message) { // 业务处理 } } import org.springframework.amqp.rabbit.core.RabbitTemplate; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.stereotype.Service; /** * RabbitMQ 消息生产者 */ @Service public class RabbitMQMessageSender { @Autowired private RabbitTemplate rabbitTemplate; public void businessMethod() { String routingKey = \"ttl.test\"; String msg = \"message：ttl.test\"; rabbitTemplate.convertAndSend(RabbitMQConfig.TTL_EXCHANGE_NAME, routingKey, msg, message -> { // TTL + 死信队列：通过setExpiration方法设置expiration message.getMessageProperties().setExpiration(\"5000\"); return message; }); } } 2、延时队列 1、安装并启用rabbitmq_delayed_message_exchange插件，请查看；2、创建自定义交换机，类型为x-delayed-message，参数需指定x-delayed-type，指定交换机为topic、direct、fanout、headers；3、创建队列与交换机绑定，监听队列进行消费；注意：延时事件在发送消息时设置x-delay，message.getMessageProperties().setDelay(10 * 1000) import org.springframework.amqp.core.*; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; /** * RabbitMQ 配置 */ @Configuration public class RabbitMQConfig { // 延时交换机名称 public static final String DELAY_EXCHANGE_NAME = \"mq.exchange.delay\"; // 延时队列名称 public static final String DELAY_QUEUE_NAME = \"mq.queue.delay\"; // 延时队列Routingkey，topic类型 private final String DELAY_ROUTING_KEY = \"delay.#\"; // 延时交换机 @Bean public CustomExchange delayExchange() { Map args = new HashMap<>(1); // 交换机类型 args.put(\"x-delayed-type\", \"topic\"); return new CustomExchange(DELAY_EXCHANGE_NAME, \"x-delayed-message\", true, false, args); } // 延时队列 @Bean public Queue delayQueue() { return new Queue(DELAY_QUEUE_NAME, true, false, false, null); } // 演示队列绑定的交换机 @Bean public Binding delayExchangeBinding() { return BindingBuilder.bind(delayQueue()).to(delayExchange()).with(DELAY_ROUTING_KEY).noargs(); } } import org.springframework.amqp.rabbit.annotation.RabbitListener; import org.springframework.stereotype.Service; /** * RabbitMQ 消息消费者 */ @Service public class RabbitMQMessageReceiver { // 延时队列监听 @RabbitListener(queues = RabbitMQConfig.DELAY_QUEUE_NAME) public void receiveDelayMessage(String message) { // 业务处理 } } import org.springframework.amqp.rabbit.core.RabbitTemplate; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.stereotype.Service; /** * RabbitMQ 消息生产者 */ @Service public class RabbitMQMessageSender { @Autowired private RabbitTemplate rabbitTemplate; public void businessMethod() { String routingKey = \"delay.test\"; String msg = \"message：delay.test\"; rabbitTemplate.convertAndSend(RabbitMQConfig.DELAY_EXCHANGE_NAME, routingKey, msg, message -> { // 延时队列：通过setDelay方法设置x-delay message.getMessageProperties().setDelay(10 * 1000); return message; }); } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"springboot/excel.html":{"url":"springboot/excel.html","title":"Excel","keywords":"","body":"Excel SpringBoot 使用 POI 生成并导出 Excel。以下为后端代码，前端代码可参照。 org.apache.poi poi-ooxml 4.1.1 导出xlsx类型 /** * 导出excel接口（xlsx类型） * @param response */ @GetMapping(\"/v1/export\") public void exportExcel(HttpServletResponse response) { // 测试数据 List list = new ArrayList<>(); // id name age createTime list.add(new User(1, 'username 1', 18, new Date())); list.add(new User(2, 'username 2', 28, new Date())); list.add(new User(3, 'username 3', 16, new Date())); list.add(new User(4, 'username 4', 25, new Date())); // 创建文档（xlsx类型） SXSSFWorkbook workbook = new SXSSFWorkbook(); // 创建sheet页 SXSSFSheet sheet = workbook.createSheet(\"sheet 1\"); // 处理excel excelHandle(workbook, sheet, list); // 流输出 OutputStream outputStream = null; try { // 设置响应内容类型 response.setContentType(\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\"); // 此处导出名字可能为乱码，前后端分离下载不影响，前端生成文件名 response.setHeader(\"Content-Disposition\", \"attachment;filename=\" + URLEncoder.encode(\"导出excel.xlsx\", \"UTF-8\")); // 获取response的输出流 outputStream = new BufferedOutputStream(response.getOutputStream()); // 文档数据写入输出流 workbook.write(outputStream); outputStream.flush(); } catch (IOException ie) { // 包装异常并抛出 throw new BusinessException(ResultEnums.FAILED.getCode(), \"excel导出失败\"); } finally { if (null != outputStream) { try { outputStream.close(); } catch (IOException ie) { throw new BusinessException(ResultEnums.FAILED.getCode(), \"excel导出异常\"); } } } } /** * excel处理（xlsx类型） * @param workbook excel文档 * @param sheet sheet页 * @param list 数据 */ private void excelHandle(SXSSFWorkbook workbook, SXSSFSheet sheet, List list) { // 设置默认行高 sheet.setDefaultRowHeightInPoints(20); // 设置列宽，第一个参数为索引，第二个参数为列宽，列宽单位为一个字符宽度的 1/256，列宽需要乘以 256 sheet.setColumnWidth(1, 12 * 256); sheet.setColumnWidth(2, 15 * 256); sheet.setColumnWidth(4, 20 * 256); // 创建第一行 SXSSFRow row = sheet.createRow(0); // 设置当前行高 row.setHeightInPoints(20); //设置为居中加粗 CellStyle style = workbook.createCellStyle(); Font font = workbook.createFont(); // 粗体 font.setBold(true); // 设置居中 style.setAlignment(HorizontalAlignment.CENTER); style.setVerticalAlignment(VerticalAlignment.CENTER); style.setFont(font); // 设置列 SXSSFCell cell; cell = row.createCell(0); cell.setCellValue(\"序号\"); cell.setCellStyle(style); cell = row.createCell(1); cell.setCellValue(\"ID\"); cell.setCellStyle(style); cell = row.createCell(2); cell.setCellValue(\"姓名\"); cell.setCellStyle(style); cell = row.createCell(3); cell.setCellValue(\"年龄\"); cell.setCellStyle(style); cell = row.createCell(4); cell.setCellValue(\"注册时间\"); cell.setCellStyle(style); CellStyle cellStyle = workbook.createCellStyle(); cellStyle.setAlignment(HorizontalAlignment.CENTER); cellStyle.setVerticalAlignment(VerticalAlignment.CENTER); int rowNum = 1; // 0为表头，从1开始记序号 for (User u : list) { SXSSFRow r = sheet.createRow(rowNum); r.setHeightInPoints(20); SXSSFCell c = r.createCell(0); c.setCellValue(rowNum); c.setCellStyle(cellStyle); c = r.createCell(1); c.setCellValue(u.getId()); c.setCellStyle(cellStyle); c = r.createCell(2); c.setCellValue(u.getName()); c.setCellStyle(cellStyle); c = r.createCell(3); c.setCellValue(u.getAge()); c.setCellStyle(cellStyle); c = r.createCell(4); c.setCellValue(DateUtil.formatDateTime(u.getCreateTime()); c.setCellStyle(cellStyle); rowNum++; } } 导出xls类型 /** * 导出excel接口（xls类型） * @param response */ @GetMapping(\"/v1/export\") public void exportExcel(HttpServletResponse response) { // 测试数据 List list = new ArrayList<>(); // id name age createTime list.add(new User(1, 'username 1', 18, new Date())); list.add(new User(2, 'username 2', 28, new Date())); list.add(new User(3, 'username 3', 16, new Date())); list.add(new User(4, 'username 4', 25, new Date())); // 创建文档（xls类型） HSSFWorkbook workbook = new HSSFWorkbook(); // 创建sheet页 HSSFSheet sheet = workbook.createSheet(\"sheet 1\"); // 处理excel excelHandle(workbook, sheet, list); // 流输出 OutputStream outputStream = null; try { // 设置响应内容类型 response.setContentType(\"application/vnd.ms-excel;charset=UTF-8\"); // 此处导出名字可能为乱码，前后端分离下载不影响，前端生成文件名 response.setHeader(\"Content-Disposition\", \"attachment;filename=\" + URLEncoder.encode(\"导出excel.xls\", \"UTF-8\")); // 获取response的输出流 outputStream = response.getOutputStream(); // 文档数据写入输出流 workbook.write(outputStream); outputStream.flush(); } catch (IOException ie) { // 包装异常并抛出 throw new BusinessException(ResultEnums.FAILED.getCode(), \"excel导出失败\"); } finally { if (null != outputStream) { try { outputStream.close(); } catch (IOException ie) { throw new BusinessException(ResultEnums.FAILED.getCode(), \"excel导出异常\"); } } } } /** * excel处理（xls类型） * @param workbook excel文档 * @param sheet sheet页 * @param list 数据 */ private void excelHandle(HSSFWorkbook workbook, HSSFSheet sheet, List list) { // 设置默认行高 sheet.setDefaultRowHeightInPoints(20); // 设置列宽，第一个参数为索引，第二个参数为列宽，列宽单位为一个字符宽度的 1/256，列宽需要乘以 256 sheet.setColumnWidth(1, 12 * 256); sheet.setColumnWidth(2, 15 * 256); sheet.setColumnWidth(4, 20 * 256); // 创建第一行 HSSFRow row = sheet.createRow(0); // 设置当前行高 row.setHeightInPoints(20); //设置为居中加粗 HSSFCellStyle style = workbook.createCellStyle(); HSSFFont font = workbook.createFont(); // 粗体 font.setBold(true); // 设置居中 style.setAlignment(HorizontalAlignment.CENTER); style.setVerticalAlignment(VerticalAlignment.CENTER); style.setFont(font); // 设置列 HSSFCell cell; cell = row.createCell(0); cell.setCellValue(\"序号\"); cell.setCellStyle(style); cell = row.createCell(1); cell.setCellValue(\"ID\"); cell.setCellStyle(style); cell = row.createCell(2); cell.setCellValue(\"姓名\"); cell.setCellStyle(style); cell = row.createCell(3); cell.setCellValue(\"年龄\"); cell.setCellStyle(style); cell = row.createCell(4); cell.setCellValue(\"注册时间\"); cell.setCellStyle(style); HSSFCellStyle cellStyle = workbook.createCellStyle(); cellStyle.setAlignment(HorizontalAlignment.CENTER); cellStyle.setVerticalAlignment(VerticalAlignment.CENTER); int rowNum = 1; // 0为表头，从1开始记序号 for (User u : list) { HSSFRow r = sheet.createRow(rowNum); r.setHeightInPoints(20); HSSFCell c = r.createCell(0); c.setCellValue(rowNum); c.setCellStyle(cellStyle); c = r.createCell(1); c.setCellValue(u.getId()); c.setCellStyle(cellStyle); c = r.createCell(2); c.setCellValue(u.getName()); c.setCellStyle(cellStyle); c = r.createCell(3); c.setCellValue(u.getAge()); c.setCellStyle(cellStyle); c = r.createCell(4); c.setCellValue(DateUtil.formatDateTime(u.getCreateTime())); c.setCellStyle(cellStyle); rowNum++; } } © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"springboot/run.html":{"url":"springboot/run.html","title":"启动方式","keywords":"","body":"启动方式 jar包方式，直接启动 jar 相关脚本，linux，上传jar后可直接在项目根目录运行run.sh脚本 ├─ .jar # 项目jar包 ├─ run.sh # 运行脚本，上传jar后可直接运行该脚本 ├─ start.sh # 启动脚本 └─ stop.sh # 停用脚本 run.sh #!/bin/bash echo stop application source stop.sh echo start application source start.sh start.sh，如需配置远程调试，可参照 nohup java -Xms256m -Xmx256m -jar .jar >/dev/null 2>&1 & stop.sh #!/bin/bash PID=$(ps -ef | grep .jar | grep -v grep | awk '{ print $2 }') if [ -z \"$PID\" ] then echo Application is already stopped else echo kill -9 $PID kill -9 $PID fi © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"index/sql.html":{"url":"index/sql.html","title":"SQL","keywords":"","body":"SQL 部分sql语法、知识点总结 MySQL PostgreSQL SQL Joins © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"sql/mysql.html":{"url":"sql/mysql.html","title":"MySQL","keywords":"","body":"MySQL 1、根据日期获取周数 -- 按照周数统计，可能某年的最后一天为第一周，如：2019-12-30周数为第一周 SELECT WEEK (date_add('', INTERVAL 6 DAY), 2); /* 示例 SELECT WEEK (date_add('2019-12-30', INTERVAL 6 DAY), 2); */ 2、自增字段 一般用于表的自增id主键 -- 方法 1 -- 创建表的时候指定字段为自增 `` int(11) NOT NULL AUTO_INCREMENT COMMENT '字段注释' /* 示例 -- AUTO_INCREMENT=1参数表示从1开始自增 CREATE TABLE `t_goods` ( `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'id', `name` varchar(20) DEFAULT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8; */ -- 方法 2 ALTER TABLE ``.`` MODIFY COLUMN `` int(11) NOT NULL AUTO_INCREMENT COMMENT '' FIRST, AUTO_INCREMENT = ; /* 示例 ALTER TABLE `testdb`.`t_goods` MODIFY COLUMN `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'id' FIRST, AUTO_INCREMENT = 1; */ © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"sql/postgresql.html":{"url":"sql/postgresql.html","title":"PostgreSQL","keywords":"","body":"PostgreSQL 1、自增字段 一般用于表的自增id主键 -- 创建序列 -- 序列名：一般命名规则，__seq，如：t_goods_id_seq CREATE SEQUENCE \"public\".\"\" INCREMENT 1 MINVALUE 1 MAXVALUE 99999999999 START 1 CACHE 1; -- 修改序列所有者 -- 所有者：一般为该database用户 ALTER SEQUENCE \"public\".\"\" OWNER TO \"\"; /* 示例 CREATE SEQUENCE \"public\".\"t_goods_id_seq\" INCREMENT 1 MINVALUE 1 MAXVALUE 99999999999 START 1 CACHE 1; ALTER SEQUENCE \"public\".\"t_goods_id_seq\" OWNER TO \"test\"; */ -- 方法 1 -- 创建表的时候指定字段的默认值 \"\" int8 NOT NULL DEFAULT nextval(''::regclass) /* 示例 CREATE TABLE \"public\".\"t_goods\" ( \"id\" int8 NOT NULL DEFAULT nextval('t_goods_id_seq'::regclass), \"name\" varchar(20) COLLATE \"pg_catalog\".\"default\", CONSTRAINT \"t_goods_pkey\" PRIMARY KEY (\"id\") ); ALTER TABLE \"public\".\"t_goods\" OWNER TO \"test\"; COMMENT ON COLUMN \"public\".\"t_goods\".\"id\" IS 'id'; */ -- 方法 2 ALTER TABLE \"public\".\"\" ALTER COLUMN \"\" SET DEFAULT nextval(''::regclass); /* 示例 ALTER TABLE \"public\".\"t_goods\" ALTER COLUMN \"id\" SET DEFAULT nextval('t_goods_id_seq'::regclass); */ © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"index/git-svn.html":{"url":"index/git-svn.html","title":"Git/Svn","keywords":"","body":"Git Git使用过部分命令总结，详细可查看Git文档。 Git GitLab Svn © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"git-svn/git.html":{"url":"git-svn/git.html","title":"Git","keywords":"","body":"Git常用命令 需要提前下载安装Git客户端 常用操作 注意：git对文件名称大小写不敏感 ################## clone ################### # 克隆项目 git clone # 根据分支克隆 git clone -b ################### 提交 #################### # 查看状态 git status # 提交文件变化到暂存区 # 提交被修改(modified)和被删除(deleted)文件，不包括新文件(new) git add -u # 提交新文件(new)和被修改(modified)文件，不包括被删除(deleted)文件 git add . # 提交所有变化 git add -A # 提交文件至本地仓库区 git commit –m '' # 以下两条命令相同，合并操作，提交文件变化，提交本地仓库区，等价于 git add . 之后 git commit –m '' git commit –am '' git commit –a –m '' # 将本地版本库的分支推送到远程服务器 # git push git push origin master # 无特殊配置为提交当前分支 git push ################### 更新 #################### # 从远程拉取最新内容 git fetch # 将拉取下来的最新内容合并到当前分支 git merge # git pull 等价于上面两步操作 # 但会对代码进行破坏性更新，建议使用 git fetch，git merge 进行代码更新 git pull 暂存 切换分支时存在未提交的文件，可以使用暂存 # 添加暂存 git stash # 查看暂存记录列表 git stash list # 应用某个存储，但不会把该存储从列表中删除 # git stash apply git stash apply stash@{0} # 应用并删除某个存储 # git stash pop git stash pop stash@{0} # 删除某个存储 # git stash drop git stash drop stash@{0} # 清空所有暂存的 stash git stash clear 分支 # 显示所有参数使用方法 git branch -h # 查看所有分支，参数v显示版本号注释等附加信息，a显示所有 git branch -va # * 开头的为当前本地分支，origin为远程分支 # gh-pages 5c3cbe8 Create CNAME # * master 20575cc shouye # remotes/origin/HEAD -> origin/master # remotes/origin/gh-pages 5c3cbe8 Create CNAME # remotes/origin/master 20575cc shouye # remotes/origin/test 20575cc shouye # 创建分支 git branch # 提交分支到远程服务器 git push origin # 删除本地分支 git branch -d # 删除远程服务器分支 git push origin -d # 切换分支 git checkout # 创建并切换分支 git checkout -b # 拉取远程分支（首次拉取），本地没有 git fetch origin git checkout git 回退版本 # 查看提交记录 git log #commit (HEAD -> master, origin/master) #Author: #Date: # # # #commit #Author: #Date: # # # 增加--pretty=oneline参数只显示commit id和commit message git log --pretty=oneline # (HEAD -> master, origin/master) # # 回退到指定commit id，这一步最好在当前代码 commit 之后操作，commit之后源代码可找回 # --soft 回退到某个版本 # --hard 撤销工作区中所有未提交的修改内容，将暂存区与工作区都回到上一次版本，并删除之前的所有信息提交 git reset --soft # HEAD is now at xxxxxx commit # 强制提交 git push origin --force git 恢复工作区文件 # 查看更改的文件 git status # 如果add到暂存区需要reset，重置暂存区最近一次提交 # 如果已经commit，需要将文件回退到commit前 git reset HEAD # 恢复工作区文件 git checkout git 忽略文件（本地） # git项目根目录，编辑.git/info/exclude，添加需要忽略的文件 vim .git/info/exclude # 如果已经包含未暂存的更改，需要运行 git update-index --skip-worktree [...] # 恢复更改跟踪，取消.git/info/exclude中的配置后，需要运行 git update-index --no-skip-worktree [...] 提交gh-pages分支以供展示 # dist为打包后的文件目录 git subtree push --prefix dist origin gh-pages git log 图形化 git log --graph --pretty=\"(%p) %h %s\" 统计贡献者代码行数 # --author=\"\" 为贡献者，$(git config --get user.email)表示当前用户账号 git log --author=\"$(git config --get user.email)\" --pretty=tformat: --numstat | gawk '{ add += $1; subs += $2; loc += $1 - $2 } END { printf \"增加的行数:%s 删除的行数:%s 总行数: %s\\n\", add, subs, loc }' 使用配置 # 1、配置用户名 # 全局 git config --global user.name '' # 非全局，在项目根目录（.git文件夹所在的目录） git config user.name '' # 2、配置邮箱 # 全局 git config --global user.email '' # 非全局，在项目根目录（.git文件夹所在的目录） git config user.email '' # 3、生成密钥，与 步骤2 中邮箱相同 ssh-keygen -t rsa -C '' # (1) Enter file in which to save the key 第一次是密钥地址，输入直接回车 # (2) Enter passphrase 第二次输入是密码 # (3) Enter same passphrase again 第三次输入是确认密码 # 4、将生成的SSH公钥添加到GitLab或者GitHub或者码云等平台中 # (1) 登录之后在 用户设置页面 -> SSH密钥 # (2) 将 id_rsa.pub 中的公钥内容全部复制到 Key 文本域输入框（使用PuTTYgen生成私钥也添加到此处，PuTTYgen使用下面有介绍） # (3) 标题会自动生成也可以自行修改，添加密钥 # 5、开始使用 Git客户端工具SourcetreeC:\\Users\\\\AppData\\Local\\Atlassian\\SourceTree目录下创建accounts.json，内容如下 [ { \"$id\": \"1\", \"$type\": \"SourceTree.Api.Host.Identity.Model.IdentityAccount, SourceTree.Api.Host.Identity\", \"Authenticate\": true, \"HostInstance\": { \"$id\": \"2\", \"$type\": \"SourceTree.Host.Atlassianaccount.AtlassianAccountInstance, SourceTree.Host.AtlassianAccount\", \"Host\": { \"$id\": \"3\", \"$type\": \"SourceTree.Host.Atlassianaccount.AtlassianAccountHost, SourceTree.Host.AtlassianAccount\", \"Id\": \"atlassian account\" }, \"BaseUrl\": \"https://id.atlassian.com/\" }, \"Credentials\": { \"$id\": \"4\", \"$type\": \"SourceTree.Model.BasicAuthCredentials, SourceTree.Api.Account\", \"Username\": \"\", \"Email\": null }, \"IsDefault\": false } ] C:\\Users\\\\AppData\\Local\\Atlassian\\SourceTree.exe_Url_*****\\x.x.x.x\\user.config，在节点前添加以下内容 True 20160201 Git客户端工具TortoiseGit 使用PuTTYgen生成密钥 配置使用私钥使用，私钥文件为.ppk文件 Github速度慢优化方法 获取github域名最快访问ip，https://github.com.ipaddress.com/ 添加到hosts文件github.comglobal-ssl.fastly.netgithub.global.ssl.fastly.net github.com global-ssl.fastly.Net github.global.ssl.fastly.net Linux、Mac下修改/etc/hosts文件，修改完后执行 # 在命令行中输入以下命令使hosts生效 -> Linux（可能需要安装 nscd） nscd -i hosts # 在命令行中输入以下命令使hosts生效 -> Mac（>=10.10.4） sudo killall -HUP mDNSResponder Windows下修改 c:\\Windows\\System32\\drivers\\etc\\hosts文件，修改完后执行 # 在命令行中输入以下命令使hosts生效 ipconfig /flushdns © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-12-29 "},"git-svn/gitlab.html":{"url":"git-svn/gitlab.html","title":"GitLab","keywords":"","body":"GitLab 以Centos 7.4，GitLab 11.8.1 (ce社区版) 为例 安装 # 依赖，系统自带，可以忽略该步 #sudo yum install -y curl policycoreutils-python openssh-server # 在防火墙打开http和ssh访问 #sudo systemctl enable sshd #sudo systemctl start sshd #sudo firewall-cmd --permanent --add-service=http #sudo systemctl reload firewalld # 添加GitLab包存储库 # gitlab-ee企业版 # gitlab-ce社区版 curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | sudo bash # 安装GitLab包 yum install -y gitlab-ce 修改配置文件 # 修改配置文件 vim /etc/gitlab/gitlab.rb # 云服务器记得开放端口 # line.13，用户访问路径IP或域名 external_url 'http://gitlab.example.com:9876' # line.1021，默认nginx是80端口，防止冲突，和上面端口相同 nginx['listen_port'] = 9876 # line.677，默认端口8080，防止冲突 unicorn['port'] = 9875 # 发送邮件 # line.53 - 54 # 发件箱邮箱 gitlab_rails['gitlab_email_from'] = 'youremail@163.com' # 发件箱发件人姓名 gitlab_rails['gitlab_email_display_name'] = 'GitLab' # line.508 - 516，以163邮箱为例 gitlab_rails['smtp_enable'] = true gitlab_rails['smtp_address'] = \"smtp.163.com\" gitlab_rails['smtp_port'] = 465 # 云服务器记得开放465端口 gitlab_rails['smtp_user_name'] = \"youremail@163.com\" # 发件箱 gitlab_rails['smtp_password'] = \"stmp password\" # stmp密码 gitlab_rails['smtp_domain'] = \"163.com\" gitlab_rails['smtp_authentication'] = \"login\" gitlab_rails['smtp_enable_starttls_auto'] = true gitlab_rails['smtp_tls'] = true # 修改完配置后 # 重新装配 gitlab-ctl reconfigure # 重启服务 gitlab-ctl restart # 开机自动启动，/etc/rc.local中加入 vim /etc/rc.local gitlab-ctl start # 测试发送邮件 # 进入gitlab控制台 gitlab-rails console # 发送测试邮件 Notify.test_email('收件箱', '标题', '内容').deliver_now 运行 # 重新装配 gitlab-ctl reconfigure # 启动服务 gitlab-ctl start # 重启服务 gitlab-ctl restart # 停止服务 gitlab-ctl stop © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"git-svn/svn.html":{"url":"git-svn/svn.html","title":"Svn","keywords":"","body":"Svn 以Centos 7.4，Subversion 1.7.14 为例 客户端命令 命令 简写 说明 其它 svn checkout svn co 将文件Checkout到本地目录 PATH是服务器上的目录 svn status svn st 查看文件或者目录状态PATH空为当前目录 ?：不在svn的控制中M：内容被修改C：发生冲突A：预定加入到版本库K：被锁定 svn add - 添加新文件到版本库 支持通配符 安装 # 安装 yum install -y subversion # 查看版本 svnserve --version 配置 # subversion默认以/var/svn作为数据根目录 # 创建svn版本库目录 mkdir -p /opt/svn # 创建版本库 svnadmin create /opt/svn # 创建用户 vim /opt/svn/conf/passwd # 增加用户，格式：用户名 = 密码 [users] admin = admin guest = guest # 配置权限 vim /opt/svn/conf/authz # 格式：用户名 = 权限，r读取权限，w写入权限 [/] admin = rw guest = r # 最后设定snvserv.conf，使上面配置生效 vim /opt/svn/conf/svnserve.conf # 修改以下 anon-access = none # 使非授权用户无法访问 auth-access = write # 使授权用户有写权限 password-db = password authz-db = authz # 访问控制文件 realm = /opt/svn # 认证命名空间，subversion会在认证提示里显示，并且作为凭证缓存的关键字。 启动svn # 运行 svnserve -d -r /opt/svn # --listen-port指定端口 # vnserve -d -r /opt/svn --listen-port 3391 # 开机自动启动，/etc/rc.local中加入 vim /etc/rc.local svnserve -d -r /opt/svn Tips # windows系统，桌面右击菜单隐藏svn，强迫症专用 svn setting -> General -> Context Menu # 在Do not show the context menu for the following paths: # 加入桌面路径，如 D:\\users\\desktop Global ignore pattern # 增加以下忽略规则 node_modules dist .idea target *.iml © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-10-08 "},"index/linux.html":{"url":"index/linux.html","title":"Linux","keywords":"","body":"Linux Linux系统下常用环境的安装以及相关配置，安装、配置、使用后总结。 命令行 yum JDK PHP Node.js Maven Nexus MySQL PostgreSQL 挂载硬盘 Nginx Tomcat Redis MongoDB Solr RabbitMQ Ftp服务器 Jenkins 禅道 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/cmd.html":{"url":"linux/cmd.html","title":"命令行","keywords":"","body":"Linux命令行 用户操作 # 创建用户 useradd testuser # 设置密码，输入两遍密码即可 passwd testuser # 指定分组，如 root组 usermod -g root testuser # 设置用户root权限，修改sudoers文件可编辑 chmod -v u+w /etc/sudoers # 修改sudoers vim /etc/sudoers # line.101 增加以下内容，保存退出即可，NOPASSWD:标识不需要输入密码 #testuser ALL=(ALL) ALL testuser ALL=(ALL) NOPASSWD: ALL # 创建用户并指定登录主目录 useradd -d /www/testuser testuser # 设置密码，输入两遍密码即可 passwd testuser # 设置访问权限 chown -R testuser /www/testuser # 删除用户 userdel testuser nohup后台执行命令 # nohup java -jar xxx.jar >/dev/null 2>&1 & # >/dev/null：/dev/null表示空设备文件，也可指定输出文件 # 2>&1：2表示错误输出（0：表示stdin标准输入，1：表示stdout标准输出），&1表示重定向为stdout标准输出 nohup >/dev/null 2>&1 & 查看端口占用 # 方式 1 lsof -i: # 方式 2 # -t (tcp) 仅显示tcp相关选项 # -u (udp) 仅显示udp相关选项 # -n 拒绝显示别名，能显示数字的全部转化为数字 # -l 仅列出在Listen(监听)的服务状态 # -p 显示建立相关链接的程序名 netstat -tunlp | grep 删除当前目录及其子目录下所有指定文件 # ./ 为当前目录及其子目录 # -type d 目标为文件夹 # -name \"\" 查找要删除的文件 # xargs rm -rf 执行删除 # 删除指定文件 find ./ -name \"\" | xargs rm -rf # 删除指定文件夹 find ./ -type d -name \"\" | xargs rm -rf # 如：删除所有.md文件 find ./ -name \"*.md\" | xargs rm -rf # 如：删除所有含有md的文件夹 find ./ -type d -name \"*md*\" | xargs rm -rf 刷新DNS缓存 sudo dscacheutil -flushcache © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/yum.html":{"url":"linux/yum.html","title":"Yum","keywords":"","body":"yum 命令相关 yum，是Yellow dog Updater, Modified 的简称，是杜克大学为了提高RPM 软件包安装性而开发的一种软件包管理器。以Centos 7.4 为例 配置阿里源 # 备份原centos源 cd /etc/yum.repos.d mv CentOS-Base.repo CentOS-Base.repo_bk # 下载阿里源http://mirrors.aliyun.com/repo/Centos-7.repo # 重命名 # Centos-7.repo -> CentOS-Base.repo # 上传阿里源到/etc/yum.repos.d/ # 更新源 yum clean all yum makecache © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/jdk.html":{"url":"linux/jdk.html","title":"JDK","keywords":"","body":"JDK 以Centos 7.4，JDK 1.8 为例 安装 # 下载二进制压缩包https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html # jdk-8u201-linux-x64.tar.gz # 解压 tar -xzvf jdk-8u191-linux-x64.tar.gz # 修改profile vim /etc/profile # 最后面添加 export JAVA_HOME=/opt/jdk1.8.0_191 export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar export PATH=$PATH:$JAVA_HOME/bin # 重新初始化profile source /etc/profile # 查看配置结果 java -version © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/php.html":{"url":"linux/php.html","title":"PHP","keywords":"","body":"PHP 以Centos 7.4，PHP 7.1.x 为例 安装 # 配置源 rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm # 安装php71w和各种拓展 yum -y install php71w php71w-cli php71w-common php71w-devel php71w-embedded php71w-fpm php71w-gd php71w-mbstring php71w-mysqlnd php71w-opcache php71w-pdo php71w-xml # 测试 php -v 支持nginx HTTP服务 nginx linux环境安装可参照 # 修改配置文件 vim /etc/php.ini # line.762 取消注释，修改为0 cgi.fix_pathinfo=0 # 启动fpm服务 /usr/sbin/php-fpm # 开机自动启动，/etc/rc.local中加入 vim /etc/rc.local /usr/sbin/php-fpm # nginx配置 location / { root html; index index.php index.html index.htm; } location ~* \\.php$ { fastcgi_index index.php; fastcgi_pass 127.0.0.1:9000; include fastcgi_params; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; fastcgi_param SCRIPT_NAME $fastcgi_script_name; } # 重启nginx nginx -s reload # 测试 rm /opt/nginx/html/index.html echo \"\" >> /opt/nginx/html/index.php # 使用浏览器打开，会显示 phpinfo() © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/nodejs.html":{"url":"linux/nodejs.html","title":"Node.js","keywords":"","body":"Node.js 以Centos 7.4，Node.js 10.15.3 二进制文件安装为例 安装 # 下载地址https://nodejs.org/en/download/ # 安装教程可参考https://github.com/nodejs/help/wiki/Installation # 定义node版本 VERSION=v10.15.0 # 定义系统版本 DISTRO=linux-x64 # 创建安装目录 sudo mkdir -p /usr/local/lib/nodejs # 解压到安装目录 sudo tar -xJvf node-$VERSION-$DISTRO.tar.xz -C /usr/local/lib/nodejs # 修改profile vim /etc/profile # 末尾加入以下内容 # Nodejs VERSION=10.15.3 VERSION=v DISTRO=linux-x64 export PATH=/usr/local/lib/nodejs/node-$VERSION-$DISTRO/bin:$PATH # 刷新profile source /etc/profile # 检查 node -v npm -v © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/maven.html":{"url":"linux/maven.html","title":"Maven","keywords":"","body":"Maven 以Centos 7.4，Maven 3.6.0 为例 安装 # 下载二进制文件压缩包http://mirrors.shu.edu.cn/apache/maven/maven-3/ # 或者直接下载然后通过ftp工具上传到服务器 wget http://mirrors.shu.edu.cn/apache/maven/maven-3/3.6.0/binaries/apache-maven-3.6.0-bin.tar.gz # 解压 tar -xzvf apache-maven-3.6.0-bin.tar.gz # 修改profile vim /etc/profile export M2_HOME=/opt/apache-maven-3.6.0 # 最后面添加 export PATH=$PATH:$JAVA_HOME/bin:$M2_HOME/bin # 修改PATH # 重新初始化profile source /etc/profile # 查看配置结果 mvn -v 基本配置 /conf/settings.xml ${user.home}/.m2/repository huaweimaven Huawei Maven * https://mirrors.huaweicloud.com/repository/maven/ 使用Nexus私服配置 Nexus搭建请查看/conf/settings.xml nexus Nexus * http://127.0.0.1:8081/repository/maven-public/ huaweimaven Huawei Maven central https://mirrors.huaweicloud.com/repository/maven/ nexus nexus Nexus http://127.0.0.1:8081/repository/maven-public/ default true true nexus Nexus http://127.0.0.1:8081/repository/maven-public/ true true nexus releases username passoword snapshots username passoword 在项目pom.xml添加 snapshots Snapshot http://127.0.0.1:8081/repository/maven-snapshots/ releases Release http://127.0.0.1:8081/repository/maven-releases/ false：是否分配一个包含时间戳的构建号，false：不分配；（Nexus 3.x中无效）Nexus 3.x中snapshots版带构建号，使用时只需填写x.x.x-SNAPSHOT，即可，自动引用最新的构建号版本releases版不带构建号 pom.xml部分说明 groupId artifactId jar 1.0 1.0-SNAPSHOT --> 其中groupId和artifactId将会是发布到私服后的包路径；packaging是打包方式；version中是包的版本。如果version版本号包括-SNAPSHOT则该包会被发布到spapshots仓库，否则会被发布到releases仓库。 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/nexus.html":{"url":"linux/nexus.html","title":"Nexus","keywords":"","body":"Nexus Nexus Repository OSS 3.x 版本，下载地址解压后，会有两个目录：nexus-3.xx.x-xx：nexus私服管理界面的容器，内部集成了jettysonatype-work：私服的默认仓库，用于存储索引和组件资源搭建Maven私服，相关使用配置请查看 CentOS环境 CentOS版本7.9Linux版依赖Java 8运行时环境，需先安装jdk1.8，请查看启动后访问：http://:8081 # 创建nexus目录 mkdir /opt/nexus # 下载并解压nexus-3.33.0-01-unix.tar.gz到nexus目录 tar xzvf nexus-3.33.0-01-unix.tar.gz -C /opt/nexus/ # 创建nexus用户 useradd -d /opt/nexus/ nexus # 设置权限 chown -R nexus /opt/nexus/ # 修改运行用户 vim /opt/nexus/nexus-3.33.0-01/bin/nexus.rc # line.1 run_as_user=\"nexus\" # 如果jdk环境为后期自定义安装目录，需指定JAVA路径 vim /opt/nexus/nexus-3.33.0-01/bin/nexus # line.14 INSTALL4J_JAVA_HOME_OVERRIDE=/opt/jdk1.8.0_191 # 加入系统服务，通过服务方式启动 vim /etc/systemd/system/nexus.service # ------------------ nexus.service start ----------------- [Unit] Description=nexus service After=network.target [Service] Type=forking LimitNOFILE=65536 ExecStart=/opt/nexus/nexus-3.33.0-01/bin/nexus start ExecStop=/opt/nexus/nexus-3.33.0-01/bin/nexus stop User=nexus Restart=on-abort TimeoutSec=600 [Install] WantedBy=multi-user.target # ------------------ nexus.service end ------------------- # 重新加载systemctl systemctl daemon-reload # 启动服务 systemctl start nexus.service # 开机自动启动 systemctl enable nexus.service Windows环境 Windows版本Windows 10自带JRE，无效额外安装启动后访问：http://:8081 # 在 nexus-3.xx.x-xx/bin/ 目录下，以管理员身份运行命令行工具 # 安装nexus服务 nexus.exe /install # 启动nexus服务 nexus.exe /start # 停止nexus服务 nexus.exe /stop # 卸载nexus服务 nexus.exe /uninstall 配置 服务需启动过，完成初始化 # 编辑配置文件 sonatype-work/nexus3/etc/nexus.properties # 修改端口 application-port=8081 # line.2 # 修改配置文件后需重启服务 systemctl restart nexus.service # linux nexus.exe /restart # windows © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/mysql.html":{"url":"linux/mysql.html","title":"MySQL","keywords":"","body":"MySQL 以Centos 7.4，MySQL5.7.x为例 安装 # 1、查看已安装的mysql rpm -qa | grep -i mysql # 2、删除之前版本 yum -y remove 已安装的名称 # 如： yum -y remove mysql-community-client-5.6.38-2.el7.x86_64 # 3、更新源并安装 cd /opt wget https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm rpm -ivh mysql57-community-release-el7-11.noarch.rpm yum -y install mysql-server # 4、启动服务，必要的，不然不会生成/var/run/mysqld/mysqld.pid，导致其他错误 systemctl start mysqld 移动相关目录 移动data目录，log目录，相关操作（安装完需先启动mysql，生成数据库文件和log文件之后再进行移动操作） # 停止服务 systemctl stop mysqld # 创建目录 mkdir -p /opt/mysql/data/ # 修改属主和属组 chown -R mysql:mysql /opt/mysql/data # 复制mysql data目录 cp -a /var/lib/mysql /opt/mysql/data/ # 建立链接（如果更新data目录后无法，使用链接的方式） #ln -s /opt/mysql/data/mysql /usr/lib/mysql # 修改my.cfg vim /etc/my.cnf datadir=/opt/mysql/data/mysql # 复制mysql原有data目录可不修改此配置 #socket=/opt/mysql/data/mysql/mysql.sock # 创建目录 mkdir -p /opt/mysql/logs # 修改属主和属组 chown -R mysql:mysql /opt/mysql/logs # 移动log文件，-a带权限复制 cp -a /var/log/mysqld.log /opt/mysql/logs # 修改log目录 vim /etc/my.cnf server_id=1 expire_logs_days=10 log-error=/opt/mysql/logs/mysqld.log # 启动mysql systemctl start mysqld # 开启自动启动 systemctl enable mysqld 修改root密码 # 1、修改配置文件 vim /etc/my.cnf # 增加 skip-grant-tables # 2、重启mysql服务 systemctl restart mysqld # 3、进入mysq命令行 mysql -uroot # ERROR 2002 (HY000): Can’t connect to local MySQL server through socket ‘/var/lib/mysql/mysql.sock’ (2) #mysql -uroot -S /opt/mysql/data/mysql/mysql.sock # 4、执行sql use mysql; SET SQL_SAFE_UPDATES = 0; update mysql.user set authentication_string=password('root') where User='root'; flush privileges; SET SQL_SAFE_UPDATES = 1; # 5、修改配置文件 vim /etc/my.cnf # 去掉 skip-grant-tables # 6、重启mysql服务 systemctl restart mysqld # 7、使用新密码进入mysql mysql -uroot -p # 输入密码进入 修改mysql默认端口 # 1、修改配置文件 vim /etc/my.cnf # 2、在[mysqld]下增加 port= # 3、重启mysql服务 systemctl restart mysqld 修改mysql默认编码 # 1、修改配置文件 vim /etc/my.cnf # 2、增加 [client] default-character-set = utf8mb4 [mysqld] character-set-server=utf8mb4 collation-server=utf8mb4_unicode_ci [mysql] default-character-set = utf8mb4 # 3、重启mysql服务 systemctl restart mysqld 创建用户、数据库，授权数据库权限，远程连接 -- 1、创建用户名，%代表可以远程连接 use mysql; CREATE USER 'username'@'%' IDENTIFIED BY 'password'; -- 2、创建数据库并制定默认编码 create database testdb DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; -- 3、用户授权使用指定数据库的指定权限 GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON testdb.* TO 'username'@'%' IDENTIFIED BY 'password'; FLUSH PRIVILEGES; -- 删除用户，无需FLUSH PRIVILEGES; drop user 'username'@'%'; 常见错误 ERROR 1819 (HY000): Your password does not satisfy the current policy requirementsERROR 1820 (HY000): You must reset your password using ALTER USER statement before executin 与validate_password_policy取值有关 Policy Tests Performed Remarks 0 or LOW Length 1 or MEDIUM Length; numeric, lowercase/uppercase, and special characters Default 2 or STRONG Length; numeric, lowercase/uppercase, and special characters; dictionary file -- 解决方法 -- 1、修改用户密码 set password=password(\"youpassword\"); -- 或者 alter user 'root'@'localhost' identified by 'youpassword'; -- 也可通过设置validate_password_policy，不推荐 --set global validate_password_policy=0; -- 2、刷新权限 flush privileges; help contents; ERROR 1819 (HY000): Your password does not satisfy the current policy requirements # 密码强度太弱，建议字母大小写+数字+符号 [Err] 1055 - Expression #1 of ORDER BY clause is not in GROUP BY clause and contains nonaggregated column 'information_schema.PROFILING.SEQ' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by # 修改my.cnf vim /etc/my.cnf # 在[mysqld]添加以下配置 sql_mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' # 重启mysql服务 systemctl restart mysqld Illegal mix of collations (utf8_general_ci,IMPLICIT) and (utf8mb4_general_ci,COERCIBLE) for operation xxx # 问题原因：emoji表情导致，MySQL 的 utf8 并不是真正的 utf8。 # 解决方法：可讲数据库 或者 数据表 或者 对应字段的编码改为utf8mb4， # 项目之初建议在数据库级别或者表级别设置编码，后期可以在对应字段修改编码。 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/pgsql.html":{"url":"linux/pgsql.html","title":"PostgreSQL","keywords":"","body":"PostgreSQL 以Centos 7.4，PostgreSQL11.x为例 安装 # 1、官网获取下载地址 # https://www.postgresql.org/download/linux/redhat/ # 2、安装存储库RPM yum install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm # 3、安装pgsql服务 yum install -y postgresql11 postgresql11-server # 4、初始化数据库 /usr/pgsql-11/bin/postgresql-11-setup initdb # 5、启动 systemctl start postgresql-11 # 6、设置自动启动 systemctl enable postgresql-11 # 7、设置postgres用户密码 # 删除原密码 sudo passwd -d postgres # 设置新密码 sudo -u postgres passwd 配置 # 1、修改配置 vim /var/lib/pgsql/11/data/postgresql.conf # 修改监听地址，允许远程访问 listen_addresses = '*' # line.59 # 修改端口，云服务器配置开放端口，默认端口：5432 port = 5432 # line.63 卸载 # 1、查询安装的包 rpm -qa | grep postgresql # 2、卸载，多个包，空格隔开 yum remove 创建数据库、用户 # 1、切换到postgres用户 su postgres # 2、启用sql shell psql -- 3、创建用户 CREATE USER WITH PASSWORD 'password'; -- 修改密码 ALTER USER WITH PASSWORD 'password'; -- 4、创建数据库 CREATE DATABASE ; -- 5、授权 GRANT ALL PRIVILEGES ON DATABASE TO ; # 6、返回shell \\q # 7、退出shell，切换回root用户 su root # 8、配置允许远程访问 vim /var/lib/pgsql/11/data/pg_hba.conf # 最末尾加入 # TYPE DATABASE USER ADDRESS METHOD host 0.0.0.0/0 md5 # 9、重启服务 systemctl restart postgresql-11 基本语法 # 查看所有数据库 \\l # 切换当前数据库 \\c # 查看当前数据库下所有表 \\d # 退出数据库返回shell \\q © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/mount.html":{"url":"linux/mount.html","title":"挂载硬盘","keywords":"","body":"Linux下永久挂载硬盘到指定目录 以Centos 7.4为例 # 1、查看可挂载硬盘 fdisk -l # 2、磁盘分区 fdisk /dev/vdb # 3、参数：输入 n， p， 1， 回车，回车， wq # 4、格式化硬盘 mkfs.ext4 /dev/vdb1 # 5、挂载到指定目录 mount /dev/vdb1 /opt # 6、写入分区表（自动挂载） echo '/dev/vdb1 /opt ext4 defaults 0 0' >> /etc/fstab # 7、查看挂载结果 df -h © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/nginx.html":{"url":"linux/nginx.html","title":"Nginx","keywords":"","body":"Nginx 以Centos 7.4，Nginx 1.15.8为例 安装 # 1、编译依赖 yum -y install gcc gcc-c++ # 2、nginx依赖 yum -y install zlib zlib-devel openssl openssl-devel pcre pcre-devel # 3、下载 解压nginx-1.15.8.tar.gz tar -xzvf nginx-1.15.8.tar.gz # 4、创建nginx用户 useradd -s /bin/false -M nginx # 5、编译 cd nginx-1.15.8 # 生成makefile，指定用户、组、安装路径、相关模块 ./configure --user=nginx --group=nginx --prefix=/opt/nginx-1.15.8-01/ --with-http_v2_module --with-http_ssl_module --with-http_sub_module --with-http_stub_status_module --with-http_gzip_static_module --with-pcre # 6、编译安装 make && make install # 7、创建nginx命令软链接到环境变量 ln -s /opt/nginx-1.15.8-01/sbin/* /usr/local/sbin/ # 开机自动启动，/etc/rc.local中加入 vim /etc/rc.local nginx location相关 # location表达式类型 ~ 表示执行一个正则匹配，区分大小写 ~* 表示执行一个正则匹配，不区分大小写 ^~ 表示普通字符匹配。使用前缀匹配。如果匹配成功，则不再匹配其他location。 = 进行普通字符精确匹配。也就是完全匹配。 @ 它定义一个命名的 location，使用在内部定向时，例如 error_page, try_files # location优先级 (location =) > (location 完整路径) > (location ^~ 路径) > (location ~,~* 正则顺序) > (location 部分起始路径) > (/) # 1、等号类型（=）的优先级最高。一旦匹配成功，则不再查找其他匹配项。 # 2、^~类型表达式。一旦匹配成功，则不再查找其他匹配项。 # 3、正则表达式类型（~ ~*）的优先级次之。如果有多个location的正则能匹配的话，则使用正则表达式最长的那个。 # 4、常规字符串匹配类型。按前缀匹配。 配置SSL（https） # 安装 --with-http_ssl_module，添加ssl模块 http { server { listen 443 ssl; # 此处加ssl参数，可以不用使用ssl on配置 server_name www.xxx.com; # 域名 #ssl on; ssl_certificate /opt/ssl/xxx.pem; # crt / pem 文件 ssl_certificate_key /opt/ssl/xxx.key; # key ssl_session_timeout 5m; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_prefer_server_ciphers on; location / { root html; index index.html index.htm; } } server { listen 80; server_name xxx.com www.xxx.com; rewrite ^(.*) https://$host$1 permanent; } } 启用http2 Nginx 1.9.5及以上版本，OpenSSL 1.0.2及以上版本监听443端口时配置http2，启用http2，80端口无法启用http2 # 安装 --with-http_v2_module，添加http2模块 http { server { listen 443 http2 ssl; # 监听443端口时配置http2，启用http2 } } 接口代理跨域 http { server { location /api/ { # host 修改为真实的域名和端口 proxy_set_header Host $http_host; proxy_pass http://192.168.0.12:8080/api/; } # ^~ 表示以某前缀开头 location ^~ /admin/ { # host 修改为真实的域名和端口 proxy_set_header Host $http_host; proxy_pass http://admin; } } } HTML5 History模式 解决URL无法匹配到静态资源的问题，如：非根目录刷新原理：rewrite到index.html中，然后交给路由在处理请求资源 # 方法 1 http { server { location /path { root html; index index.html index.htm; if (!-e $request_filename) { rewrite ^/(.*) /path/index.html last; break; } } } } # 方法 2 http { server { location /path { root html; index index.html index.htm; try_files $uri $uri/ @router; } location @router { rewrite ^.*$ /path/index.html last; } } } 请求相关配置 可在http、server或location中设置，优先级location > server > http client_max_body_size：限制请求体的大小，若超过所设定的大小，返回413错误client_header_timeout：读取请求头的超时时间，若超过所设定的大小，返回408错误client_body_timeout：读取请求实体的超时时间，若超过所设定的大小，返回413错误proxy_connect_timeout：http请求无法立即被容器(tomcat, netty等)处理，被放在nginx的待处理池中等待被处理。此参数为等待的最长时间，默认为60秒，官方推荐最长不要超过75秒proxy_read_timeout：http请求被容器(tomcat, netty等)处理后，nginx会等待处理结果，也就是容器返回的response。此参数即为服务器响应时间，默认60秒proxy_send_timeout：http请求被服务器处理完后，把数据传返回给Nginx的用时，默认60秒 http { server { location a { client_max_body_size 10m; } } } 跨域配置 可在http、server或location中设置，优先级location > server > httpadd_header Access-Control-Allow-Methods 'PUT,POST,GET,DELETE,OPTIONS';：指定允许跨域的方法，*代表所有add_header Access-Control-Max-Age 3600;：预检命令的缓存，如果不缓存每次会发送两次请求add_header Access-Control-Allow-Credentials true;：带cookie请求需要加上这个字段，并设置为trueadd_header Access-Control-Allow-Origin $http_origin;：表示允许这个域跨域调用（客户端发送请求的域名和端口），$http_origin动态获取请求客户端请求的域 不用*的原因是带cookie的请求不支持*号add_header Access-Control-Allow-Headers $http_access_control_request_headers;：表示请求头的字段 动态获取if ($request_method = 'OPTIONS') { return 200; }：检查请求的类型是不是预检命令 http { server { location a { add_header Access-Control-Allow-Methods 'PUT,POST,GET,DELETE,OPTIONS'; add_header Access-Control-Max-Age 3600; add_header Access-Control-Allow-Credentials true; add_header Access-Control-Allow-Origin $http_origin; add_header Access-Control-Allow-Headers $http_access_control_request_headers; if ($request_method = 'OPTIONS') { return 200; } } } } 负载均衡 tomcat 为例反向代理 负载均衡后获取客户端真实IP html { # 添加tomcat列表，真实应用服务器都放在这 upstream tomcat_pool { # server tomcat地址:端口号 weight表示权值，权值越大，被分配的几率越大; server 192.168.0.223:8080 weight=4 max_fails=2 fail_timeout=30s; server 192.168.0.224:8080 weight=4 max_fails=2 fail_timeout=30s; } server { # 默认请求设置 location / { # host 修改为真实的域名和端口 proxy_set_header Host $http_host; proxy_pass http://tomcat_pool; # 转向tomcat处理 proxy_cookie_domain domino_server nginx_server; # 解决反向代理后Cookie不一致的问题 } # 带有基础路径请求设置 location ^~ /api/ { # host 修改为真实的域名和端口 proxy_set_header Host $http_host; # 客户端真实ip proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; # 客户端真实协议(http/https) proxy_set_header X-Forwarded-Proto $scheme; # 负载均衡upstream proxy_pass http://tomcat_pool/api/; # 转向tomcat处理 proxy_cookie_domain domino_server nginx_server; # 解决反向代理后Cookie不一致的问题 } } } 负载均衡后获取客户端真实IP，java代码 // 负载均衡后获取客户端真实IP地址 public String getClientIp(HttpServletRequest request) { String ip = request.getHeader(\"x-forwarded-for\"); if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) { ip = request.getHeader(\"Proxy-Client-IP\"); } if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) { ip = request.getHeader(\"WL-Proxy-Client-IP\"); } if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) { ip = request.getRemoteAddr(); } if(ip.trim().contains(\",\")){ // 为什么会有这一步，因为经过多层代理后会有多个代理，取第一个ip地址就可以了 String [] ips = ip.split(\",\"); ip = ips[0]; } return ip; } gzip http { # gzip模块设置 gzip on; # 开启gzip压缩输出 gzip_min_length 1k; # 最小压缩文件大小 gzip_buffers 4 16k; # 压缩缓冲区 gzip_http_version 1.1; # 用了反向代理的话，末端通信是HTTP/1.0，默认是HTTP/1.1 gzip_comp_level 2; # 压缩等级 gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png; # 压缩类型 gzip_vary off; # 跟Squid等缓存服务有关，on的话会在Header里增加\"Vary: Accept-Encoding\" gzip_disable \"MSIE [1-6]\\.\"; # ie6不压缩 } 修改nginx.conf、html位置 # 修改nginx.conf位置 # 移动nginx.conf mv /opt/nginx-1.15.8-01/conf/nginx.conf /opt/ # 创建软连接 ln -s /opt/nginx.conf /opt/nginx-1.15.8-01/conf/nginx.conf/ # 修改html位置 # 创建目录 mkdir /opt/nginx-app # 修改配置文件 vim /opt/nginx.conf # 顶部加入 user root; html { server { location / { root /opt/nginx-app; } } } # 重启服务 nginx -s reload © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/tomcat.html":{"url":"linux/tomcat.html","title":"Tomcat","keywords":"","body":"Tomcat 以Centos 7.4，Tomcat 8.5.43为例 常用配置修改 # {tomcat-path}/config/server.xml 代表了运行在上的单个Web应用 一个可以有多个元素，每个Web应用必须有唯一的URL路径 这个URL路径在中的属性path中设定。 --> 的appBase属性的相对路径 如果Web应用采用开放目录结构，则指定Web应用的根目录 如果Web应用是个war文件，则指定war文件的路径。 --> 控制台乱码 window系统下Tomcat 9可能会出现看控制台乱码的情况将tomcat/conf/logging.properties中，UTF-8全局替换为GBK重启tomcat © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/redis.html":{"url":"linux/redis.html","title":"Redis","keywords":"","body":"Redis 以Centos 7.4，redis 5.0.x 为例 安装 # 下载压缩包https://redis.io/download # /opt/redis-5.0.4.tar.gz cd /opt # 解压 tar -xzvf redis-5.0.4.tar.gz # 编译 cd /opt/redis-5.0.4 make # 安装 cd /opt/redis-5.0.4/src make install PREFIX=/usr/local/redis # 复制配置文件到安装目录 cp -a /opt/redis-5.0.4/redis.conf /usr/local/redis # 修改配置 vim /usr/local/redis/redis.conf bind 127.0.0.1 # line.69 注释掉 port # line.92 修改默认端口 daemonize yes # line.136 守护进程 yes dir /usr/local/redis/ # line.263 修改dump.rdb目录 requirepass # line.507 设置密码 maxmemory # line.566 可使用最大内存，单位字节（bytes） notify-keyspace-events Ex # line.1060 键空间通知，过期事件的监听 # notify-keyspace-events 全部配置 # K 键空间通知，以__keyspace@__为前缀 # E 键事件通知，以__keysevent@__为前缀 # g del, expipre, rename 等类型无关的通用命令的通知 # $ String命令 # l List命令 # s Set命令 # h Hash命令 # z 有序集合命令 # x 过期事件（每次key过期时生成） # e 驱逐事件（当key在内存满了被清除时生成） # A g$lshzxe的别名，因此“AKE”意味着所有的事件 # 创建软连接 ln -s /usr/local/redis/bin/* /usr/local/sbin/ # 启动服务 redis-server /usr/local/redis/redis.conf # 开机自动启动，/etc/rc.local中加入 vim /etc/rc.local redis-server /usr/local/redis/redis.conf 测试连接 # 无密码 redis-cli # 有密码 redis-cli > auth > ping pong 相关错误 MISCONF Redis is configured to save RDB snapshots, but it is currently not able to persist on disk. Commands that may modify the data set are disabled, because this instance is configured to report errors during writes if RDB snapshotting fails (stop-writes-on-bgsave-error option). Please check the Redis logs for details about the RDB error. # 修改配置 vim /usr/local/redis/redis.conf stop-writes-on-bgsave-error no # line.235 持久化失败报错 no，继续使用 # 重启redis © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/mongodb.html":{"url":"linux/mongodb.html","title":"MongoDB","keywords":"","body":"MongoDB 下载安装 MongoDB官网 -> On-Premises -> MongoDB Community Server选择 版本（4.4.0）、平台（CentOS 7.0）、包（tgz），具体可根据需要选择获取 tgz 压缩包下载链接并下载 # 解压 tar -xzvf mongodb-linux-x86_64-rhel70-4.4.0.tgz # 移动到/usr/local/下 mv /opt/mongodb-linux-x86_64-rhel70-4.4.0 /usr/local/mongodb4 # 修改/etc/profile vim /etc/profile # 添加 export MONGODB_HOME=/usr/local/mongodb4 export PATH=PATH:{MONGODB_HOME}/bin # 刷新/etc/profile source /etc/profile # 在mongodb/bin目录下添加mongodb.conf cd /usr/local/mongodb4/bin vim mongodb.conf # 添加以下内容 # mongodb 配置文件 # 端口，默认27017 port=27017 # IP，默认127.0.0.1 bind_ip=0.0.0.0 # 数据库存放 dbpath=/var/lib/mongodb/data # 日志文件 logpath=/var/lib/mongodb/logs/mongodb.log # 错误日志采用追加模式，配置这个选项后mongodb的日志会追加到现有的日志文件，而不是从新创建一个新文件 logappend=true # 启用日志文件，默认启用 journal=true # 这个选项可以过滤掉一些无用的日志信息，若需要调试使用请设置为false quiet=true # 设置后台运行 fork=true # 开启认证 auth=true # 创建数据库目录和日志文件目录 mkdir -p /var/lib/mongodb/data mkdir -p /var/lib/mongodb/logs # 启动 /usr/local/mongodb4/bin/mongod -f /usr/local/mongodb4/bin/mongodb.conf # 关闭 /usr/local/mongodb4/bin/mongod -shutdown -dbpath=/var/lib/mongodb/data 创建数据库、用户 # 启用mongo /usr/local/mongodb4/bin/mongo # 选择admin库 use admin # 创建admin用户 db.createUser({user:\"admin\",pwd:\"\",roles:[{role:\"userAdminAnyDatabase\",db:\"admin\"}]}) # 用户的验证，返回1表示成功 db.auth(\"admin\", \"\") # 使用use创建数据库 use test # 创建用户 # db.createUser({user:\"\",pwd:\"\",roles:[{role:\"\",db:\"\"}]}) db.createUser({user:\"test\",pwd:\"password\",roles:[{role:\"dbOwner\",db:\"test\"}]}) © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/solr.html":{"url":"linux/solr.html","title":"Solr","keywords":"","body":"Solr 以Centos 7.4，solr 8.1 为例 安装 # 下载压缩包http://lucene.apache.org/solr/mirrors-solr-latest-redir.html # /opt/solr-8.1.0.tgz cd /opt # 解压 tar -xzvf solr-8.1.0.tgz # 创建core cd /opt/solr-8.1.0/server/solr/configsets cp -r _default ../ mv _default # 创建软连接 ln -s /opt/solr-8.1.0/bin/solr /usr/local/sbin/ # 启动服务 start：启动服务；stop：停止服务；restart：重启服务 -p 自定义端口 -m 内存 solr start -p 8398 -force -m 1g # 开机自动启动，/etc/rc.local中加入 vim /etc/rc.local solr start -p 8398 -force -m 1g 使用 基本使用 # 访问 http://:8398/solr # 菜单 -> Core Admin # 添加core，名字为上一步文件夹名（core name） 添加hanlp中文分词器，分词插件 # https://github.com/hankcs/hanlp-lucene-plugin # 下载jar包hanlp-portable-1.7.3.jar、hanlp-lucene-plugin-1.1.6.jar # 添加jar包到 cd /opt/solr-8.1.0/server/solr-webapp/webapp/WEB-INF/lib # 修改配置文件 cd /opt/solr-8.1.0/server/solr//conf vim managed-schema # 末尾标签内增加相关配置 --> # 重启solr服务 solr restart -p 8398 -force -m 1g 相关问题 # *** [WARN] *** Your Max Processes Limit is currently 7270. # It should be set to 65000 to avoid operational disruption. # If you no longer wish to see this warning, set SOLR_ULIMIT_CHECKS to false in your profile or solr.in.sh # WARNING: Starting Solr as the root user is a security risk and not considered best practice. Exiting. # Please consult the Reference Guide. To override this check, start with argument '-force' # 启动时后面加参数-force solr start -p 8398 -force -m 1g © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/rabbitmq.html":{"url":"linux/rabbitmq.html","title":"RabbitMQ","keywords":"","body":"RabbitMQ 安装 下载对应版本的erlang和rabbitmq-server注意：rabbitmq-server的el版本要跟erlang对应 # 下载rpm包 wget --content-disposition https://packagecloud.io/rabbitmq/erlang/packages/el/7/erlang-23.3.4.5-1.el7.x86_64.rpm/download.rpm wget --content-disposition https://packagecloud.io/rabbitmq/rabbitmq-server/packages/el/7/rabbitmq-server-3.8.19-1.el7.noarch.rpm/download.rpm # 按顺序安装rpm包 yum -y install erlang-23.3.4.5-1.el7.x86_64.rpm yum -y install rabbitmq-server-3.8.19-1.el7.noarch.rpm 配置 新版本rabbitmq需单独创建配置文件rabbitmq.conf下载地址：https://github.com/rabbitmq/rabbitmq-server/blob/v版本号/deps/rabbit/docs/rabbitmq.conf.example # 在/etc/rabbitmq/下，下载配置文件 cd /etc/rabbitmq/ # 创建配置文件 touch rabbitmq.conf # 重命名配置文件，将配置复制到配置文件中 vim rabbitmq.conf # 启用rabbitmq的管理平台插件，会在/etc/rabbitmq 目录下多出一个 enabled_plugins cd /etc/rabbitmq/ rabbitmq-plugins enable rabbitmq_management # 启动服务 systemctl start rabbitmq-server # 停止服务 systemctl stop rabbitmq-server # 开机自动启动 systemctl enable rabbitmq-server 安装插件 社区插件列表 # 查看已安装插件 rabbitmq-plugins list # 未出现在列表中的插件需单独安装 cd /usr/lib/rabbitmq/lib/rabbitmq_server-3.8.19/plugins/ # 下载插件，如：延时队列插件 wget https://github.com/rabbitmq/rabbitmq-delayed-message-exchange/releases/download/3.8.17/rabbitmq_delayed_message_exchange-3.8.17.8f537ac.ez # 启用插件，rabbitmq-plugins enable rabbitmq-plugins enable rabbitmq_delayed_message_exchange 用户管理 # 需在rabbitmq-server启动状态下操作 # 添加用户 # rabbitmqctl add_user rabbitmqctl add_user admin admin # 设置角色tags # rabbitmqctl set_user_tags rabbitmqctl set_user_tags admin administrator # 设置权限，可以远程访问， # rabbitmqctl set_permissions -p \"\" \"\" \"\" \"\" rabbitmqctl set_permissions -p \"/\" admin \".*\" \".*\" \".*\" # 查看用户列表 rabbitmqctl list_users # 查看用户权限 rabbitmqctl list_permissions -p / # 删除用户 # rabbitmqctl delete_user rabbitmqctl delete_user admin RabbitMQ 基本概念 1、Message：消息，消息是不具名的，它由消息头和消息体组成。消息体是不透明的，而消息头则由一系列的可选属性组成，这些属性包括routing-key（路由键）、priority（相对于其他消息的优先权）、delivery-mode（指出该消息可能需要持久性存储）等。2、Publisher：消息的生产者，也是一个向交换器发布消息的客户端应用程序。3、Exchange：交换器，用来接收生产者发送的消息并将这些消息路由给服务器中的队列。4、Binding：绑定，用于消息队列和交换器之间的关联。一个绑定就是基于路由键将交换器和消息队列连接起来的路由规则，所以可以将交换器理解成一个由绑定构成的路由表。5、Queue：消息队列，用来保存消息直到发送给消费者。它是消息的容器，也是消息的终点。一个消息可投入一个或多个队列。消息一直在队列里面，等待消费者连接到这个队列将其取走。6、Connection：网络连接，比如一个TCP连接。7、Channel：信道，多路复用连接中的一条独立的双向数据流通道。信道是建立在真实的TCP连接内地虚拟连接，AMQP 命令都是通过信道发出去的，不管是发布消息、订阅队列还是接收消息，这些动作都是通过信道完成。因为对于操作系统来说建立和销毁 TCP 都是非常昂贵的开销，所以引入了信道的概念，以复用一条 TCP 连接。8、Consumer：消息的消费者，表示一个从消息队列中取得消息的客户端应用程序。9、Virtual Host：虚拟主机，表示一批交换器、消息队列和相关对象。虚拟主机是共享相同的身份认证和加密环境的独立服务器域。每个 vhost 本质上就是一个 mini 版的 RabbitMQ 服务器，拥有自己的队列、交换器、绑定和权限机制。vhost 是 AMQP 概念的基础，必须在连接时指定，RabbitMQ 默认的 vhost 是 / 。10、Broker：表示消息队列服务器实体。 RabbitMQ 交换机 1、Direct exchange---直接类型交换机 要求消息带的路由键和绑定的路由键完全匹配，这是一个完整的匹配；如果一个队列绑定到该交换机上要求路由键“abc”，则只有被标记为“abc”的消息才被转发，不会转发abc.def，也不会转发dog.ghi，只会转发abc。 2、Fanout Exchange---扇出类型交换机 只需将队列绑定到该类型交换机上，该类型的交换机绑定队列时可以不指定路由键(Routingkey)；当消息发送给该交换机后，它会将消息投递给与该交换机绑定的所有队列；很像子网广播，每台子网内的主机都获得了一份复制的消息。Fanout交换机转发消息是最快的。 3、Topic Exchange---主题类型交换机 使用通配符去匹配，路由到对应的队列。通配符有两种：* 、# 。需要注意的是通配符前面必须要加上\".\"符号；* 符号：有且只匹配一个词。比如：a.*可以匹配到\"a.b\"、\"a.c\"，但是匹配不了\"a.b.c\"；# 符号：匹配一个或多个词。比如：rabbit.#既可以匹配到\"rabbit.a.b\"、\"rabbit.a\"，也可以匹配到\"rabbit.a.b.c\"。 4、Headers Exchange---首部交换机 &#x1F44E;性能差❌不常用不处理路由键。而是根据发送的消息内容中的headers属性进行匹配；在绑定Queue与Exchange时指定一组键值对；当消息发送到RabbitMQ时会取到该消息的headers与Exchange绑定时指定的键值对进行匹配；如果完全匹配则消息会路由到该队列，否则不会路由到该队列；headers属性是一个键值对，可以是Hashtable，键值对的值可以是任何类型；而fanout，direct，topic 的路由键都需要要字符串形式的；匹配规则x-match有下列两种类型： x-match = all：表示所有的键值对都匹配才能接受到消息 x-match = any：表示只要有键值对匹配就能接受到消息 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/ftp.html":{"url":"linux/ftp.html","title":"Ftp服务器","keywords":"","body":"FTP服务器 以Centos 7.4 为例 安装 # 查询是否安装vsftpd rpm -qa | grep vsftpd # 安装 yum install -y vsftpd # 创建ftp主目录 #mkdir /opt/www/ftp # 创建ftp用户 useradd -d /opt/www/ftp -m ftpuser # 设置新用户密码 passwd ftpuser # 更改用户权限 usermod -s /sbin/nologin ftpuser # 限定用户ftpuser不能telnet，只能ftp # usermod -s /sbin/bash ftpuser # 用户ftpuser恢复正常 # usermod -d /opt/www/ftp ftpuser # 更改用户ftpuser的主目录为/opt/www/ftp # 文件授权给ftp用户 chown -R ftpuser /opt/www/ftp # 进入vsftpd目录 cd /etc/vsftpd # 创建chroot_list并写入ftp用户 echo 'ftpuser' > chroot_list # 在user_list中加入ftp用户 vim /etc/vsftpd/user_list # 修改配置文件 vim /etc/vsftpd/vsftpd.conf anonymous_enable=NO # line.12 禁止匿名用户 chroot_local_user=YES # line.101 chroot_list_enable=NO # line.102 禁止chroot_list中用户切换目录 chroot_list_file=/etc/vsftpd/chroot_list # line.104 定义不能更改用户主目录的文件，该文件需自己创建，默认被注释 listen=YES # line.115 监听ipv4 listen_ipv6=NO # line.124 不监听ipv6 userlist_enable=YES # line.127 启用白名单 userlist_deny=NO # line.128 禁用黑名单 local_root=/opt/www/ftp # 新增，ftp根目录 pasv_max_port=5510 # 新增，被动端口 pasv_min_port=5500 # 新增，被动端口 allow_writeable_chroot=YES # 新增，支持chroot_list中的用户write权限 # 启动服务器 systemctl start vsftpd # 开机自动启的 systemctl enable vsftpd 相关问题 云服务器设置安全组后需要开放相关接口 # 20 - 22 # 被动端口 5500 - 5510 5500/5510 331 Please specify the password. # 可能性较大的原因是密码强度太低，不影响登录 500 OOPS: cannot change directory:/opt/www/ftp/images # 原因，文件权限导致 # 只设置了images目录的ftp的用户权限，需要设置www的用户权限 cd /opt chown -R ftpuser www/ftp/ cd /opt/www/ftp chown -R ftpuser images/ # 特殊情况！如果与ftpuser同一用户组用户test也需要访问/opt/www/ftp，需要给www/ftp文件夹设置权限 chmod 770 www/ftp 530 Login incorrect. # 确认密码正确的情况下报530 vim /etc/pam.d/vsftpd # 注释掉以下两行 #%PAM-1.0 session optional pam_keyinit.so force revoke #auth required pam_listfile.so item=user sense=deny file=/etc/vsftpd/ftpusers onerr=succeed #auth required pam_shells.so auth include password-auth account include password-auth session required pam_loginuid.so session include password-auth # 重启服务 systemctl restart vsftpd 服务器发回了不可路由的地址。使用服务器地址代替。 # 更改Filezilla设置，编辑-设置-连接-FTP-被动模式，将“使用服务器的外部ip地址来代替”改为“回到主动模式”即可。 SFTP服务器 # 创建用户组 groupadd sftp # 创建用户，指定用户组，限定只能ftp登录 useradd -d /opt/www/sftp -g sftp -s /sbin/nologin sftpuser # 设置密码 passwd sftpuser # 修改ssh配置文件 vim /etc/ssh/sshd_config # 注释掉以下两行 #X11Forwarding yes # line.98 #Subsystem sftp /usr/libexec/openssh/sftp-server # line.129 # 在sshd_config末尾添加 Subsystem sftp internal-sftp Match Group sftp ChrootDirectory /opt/www/sftp/ ForceCommand internal-sftp AllowTcpForwarding no X11Forwarding no # 设置文件权限 # ChrootDirectory /opt/www/sftp 目录所有者必须为root，设置sftp用户组 # /opt/www/sftp 及 /opt/www/sftp/assets 目录权限不能超过755 chown -R root:sftp /opt/www/sftp chmod -R 755 /opt/www/sftp cd /opt/www/sftp mkdir assets chown -R sftpuser:sftp /opt/www/sftp/assets chmod -R 755 /opt/www/sftp/assets # 重启ssh服务 systemctl restart sshd 上传尺寸限制、静态资源访问跨域问题 可参照Springboot 相关配置 # 设置servlet最大请求尺寸 spring.servlet.multipart.max-request-size = 10MB # 设置servlet最大文件上传尺寸 spring.servlet.multipart.max-file-size = 10MB © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/jenkins.html":{"url":"linux/jenkins.html","title":"Jenkins","keywords":"","body":"Jenkins Jenkins安装前需先安装JDK可参照 安装 方式1，推荐 # 添加yum源 sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo # 导入密钥 sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key # 安装 sudo yum install -y jenkins 方式2，下载离线安装包安装 以Centos 7.4 为例，下载jenkins-2.150.3-1.1.noarch.rpm rpm -ih jenkins-2.150.3-1.1.noarch.rpm 修改java目录 vim /etc/init.d/jenkins # 大约75行，添加java目录 candidates=\" /opt/jdk1.8.0_191/bin/java ... \" # 保存后运行一下命令，重新加载 systemctl daemon-reload # 启动 systemctl start jenkins 开机启动 # 由于Jenkins不是Native Service，所以需要用chkconfig命令而不是systemctl命令 sudo /sbin/chkconfig jenkins on 修改默认端口号 vim /etc/sysconfig/jenkins # 大约56行，将默认端口8080修改即可 JENKINS_PORT=\"8765\" # 重启服务 systemctl restart jenkins © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"linux/zentao.html":{"url":"linux/zentao.html","title":"禅道","keywords":"","body":"禅道 以Centos 7.4，ZenTaoPMS.11.4.1 为例 安装 需要提前安装以下依赖，可点击链接参考 nginx，mysql，php # nginx中新建项目根目录html_zen_tao（和html同级） # 配置nginx.conf server { listen 8888; server_name 140.143.232.110; location / { root html_zen_tao; index index.php index.html index.htm; } location ~* \\.php$ { fastcgi_index index.php; fastcgi_pass 127.0.0.1:9000; include fastcgi_params; # fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; # 自定义项目根目录后需用绝对路径方式配置SCRIPT_FILENAME # 否则访问php文件会显示 No input file specified. fastcgi_param SCRIPT_FILENAME /opt/nginx/html_zen_tao/$fastcgi_script_name; fastcgi_param SCRIPT_NAME $fastcgi_script_name; } } # 下载禅道项目管理软件源码 https://www.zentao.net/download/80131.html # ZenTaoPMS.11.4.1.zip # 解压到html_zen_tao unzip ZenTaoPMS.11.4.1.zip # 通过IP地址访问http://IP:PORT/zentaopms/www/index.php # 根据提示进行安装 常见问题 PDO扩展、PDO_MySQL扩展、MBSTRING扩展 未加载 # 修改配置文件 vim /etc/php.ini # line.725，修改并添加 extension_dir = \"/usr/lib64/php/modules\" extension=pdo_mysqlnd.so extension=mbstring.so extension=pdo.so # 重启php-fpm ps aux | grep php-fpm kill -9 xxxx # 你懂得 /usr/sbin/php-fpm © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"index/mac.html":{"url":"index/mac.html","title":"Mac","keywords":"","body":"Mac 常用环境配置 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-08-12 "},"mac/env-config.html":{"url":"mac/env-config.html","title":"常用环境配置","keywords":"","body":"Mac常用环境配置 oh-my-zsh 推荐命令行工具 iterm2oh-my-zsh官网 # 安装oh-my-zsh sh -c \"$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\" # 更新 omz update # 卸载 uninstall_oh_my_zsh 安装插件 # 进入自定义插件目录 cd ~/.oh-my-zsh/custom/plugins/ # 安装插件 # 命令自动提示 git clone https://github.com/zsh-users/zsh-autosuggestions.git # 命令高亮 git clone https://github.com/zsh-users/zsh-syntax-highlighting.git # 配置 plugins 配置 # 相关环境变量配置 vim ~/.zshrc #vim ~/.bash_profile # Path to your oh-my-zsh installation. export ZSH=\"$HOME/.oh-my-zsh\" ZSH_THEME=\"robbyrussell\" plugins=( git zsh-autosuggestions zsh-syntax-highlighting ) source $ZSH/oh-my-zsh.sh # 重新加载配置文件 source ~/.zshrc #source ~/.bash_profile Xcode Command Line Tools xcode-select 可参照 homebrew Homebrew官网 安装 # 配置环境变量 vim ~/.zshrc #vim ~/.bash_profile # 添加以下配置 # homebrew export HOMEBREW_BREW_GIT_REMOTE=\"https://mirrors.ustc.edu.cn/brew.git\" export HOMEBREW_CORE_GIT_REMOTE=\"https://mirrors.ustc.edu.cn/homebrew-core.git\" export HOMEBREW_BOTTLE_DOMAIN=\"https://mirrors.ustc.edu.cn/homebrew-bottles\" export HOMEBREW_API_DOMAIN=\"https://mirrors.ustc.edu.cn/homebrew-bottles/api\" # 重新加载配置文件 source ~/.zshrc #source ~/.bash_profile # 安装 /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)\" # 卸载 /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/uninstall.sh)\" 如果安装慢或超时可以参照 Github速度慢优化方法 将raw.githubusercontent.com配置到/etc/hosts 常用命令及安装软件包 # 查看版本号 brew -v # 更新brew brew update # 检测brew brew doctor # 查询可用包，安装前可先查一下 brew search # 安装git brew install git # 安装svn brew install subversion # 安装yarn brew install yarn # 注意需要配置环境变量，才能访问到yarn安装的全局npm包 # other export path export PATH=$PATH:~/.yarn/bin # 查看安装的包 brew list # 更新所有包 brew upgrade # 更新指定包 brew upgrade # 卸载包 brew uninstall nvm # 安装 brew install nvm # 创建nvm工作目录 mkdir ~/.nvm # 配置环境变量 vim ~/.zshrc #vim ~/.bash_profile # 添加以下配置 # nvm export NVM_DIR=\"$HOME/.nvm\" NVM_HOME=\"$(brew --prefix nvm)\" [ -s \"$NVM_HOME/nvm.sh\" ] && \\. \"$NVM_HOME/nvm.sh\" # This loads nvm [ -s \"$NVM_HOME/bash_completion\" ] && \\. \"$NVM_HOME/bash_completion\" # This loads nvm bash_completion # 重新加载配置文件 source ~/.zshrc #source ~/.bash_profile node.js 通过nvm命令安装 # 安装指定版本 node.js nvm install # 指定 default 别名可以在新打开命令行工具时，使node命令生效 nvm alias default jdk Mac Arm版 Azul Zulu 下载地址下载.tar.gz格式，解压，将zulu-8.jdk放到/Library/Java/JavaVirtualMachines下 # 配置环境变量 vim ~/.zshrc #vim ~/.bash_profile # 添加以下配置 # jdk export JAVA_HOME=\"/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home\" export CLASSPATH=\".:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar\" export PATH=$PATH:$JAVA_HOME/bin # 重新加载配置文件 source ~/.zshrc #source ~/.bash_profile maven maven 下载页面如果遇到 idea 版本限制，可使用 maven 3.6.3，maven 3.6.3 下载地址下载后解压到~/java下 # 配置环境变量 vim ~/.zshrc #vim ~/.bash_profile # 添加以下配置 # maven export M2_HOME=\"$HOME/java/apache-maven-3.8.6\" export PATH=$PATH:$M2_HOME/bin # 重新加载配置文件 source ~/.zshrc #source ~/.bash_profile © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2023-03-22 "},"index/windows.html":{"url":"index/windows.html","title":"Windows","keywords":"","body":"Windows DOS © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"windows/dos.html":{"url":"windows/dos.html","title":"DOS","keywords":"","body":"DOS命令行 删除所有指定文件 :: 删除当前目录下所有具有的文件，包括下级目录 :: del /f/s/q \"\" :: 如：所有.md的文件 del /f/s/q \"*.md\" 使用WinSCP上传文件到Linux系统 1、WinSCP下载地址2、安装后需将winscp.exe的所在目录配置到环境变量3、创建运行脚本upload.txt option confirm off open :@ cd /opt/test/ rm file.txt rmdir folder put test\\* ./ close exit # 说明： # cd /opt/test/ 改变服务器当前目录 # rm file.txt 删除文件 # rmdir folder 删除文件夹内全部文件及文件夹 # put test\\* ./ 上传本地当前目录到服务器cd的目录，本地目录也可使用绝对路径，如：C:\\test\\a.zip 4、运行脚本upload.bat执行upload.bat会自动上传，初次会有登录提示，英文输入法状态下输入Y即可。注意：1、用户名、密码不能出现特殊符号；2、权限问题可参照。 # 如需打印日志可添加参数 /log=log.txt winscp.exe /console /script=upload.txt 5、使用Git Bash运行bat脚本 cmd.exe /C upload.bat 参照：winscp命令 命令 描述 call 执行任意远程 shell 命令 cd 更改远程工作目录 checksum 计算远程文件的校验和 chmod 更改远程文件的权限 close 关闭会话 cp 复制远程文件 echo 将消息打印到脚本输出 exit 关闭所有会话并终止程序 get 从远程目录下载文件到本地目录 help 显示帮助 keepuptodate 不断反映远程目录上本地目录的变化 lcd 更改本地工作目录 lls 列出本地目录的内容 ln 创建远程符号链接 lpwd 打印本地工作目录 ls 列出远程目录的内容 mkdir 创建远程目录 mv 移动或重命名远程文件 open 连接到服务器 option 设置或显示脚本选项的值 put 将文件从本地目录上传到远程目录 pwd 打印远程工作目录 rm 删除远程文件 rmdir 删除远程目录 session 列出连接的会话或选择活动会话 stat 检索远程文件的属性 synchronize 将远程目录与本地目录同步 net网络命令 # 建立IPC链接 net use \\\\ /user: # 删除指定链接 net use \\\\ /delete # 删除全部链接，会有确认提示，可用于查看列表 net use * /delete 刷新DNS缓存 ipconfig /flushdns 复制文件/文件夹并添加到压缩文件 安装winrar，安装后需将winrar.exe的所在目录配置到环境变量 :: 创建目录 md test :: 使用xcopy命令拷贝folder1及其子目录与文件到test目录下，/E 参数表示包括空目录 xcopy folder1 test\\folder1\\ /E :: 使用xcopy命令拷贝folder2及其子目录与文件到test目录下，排除exclude.txt指定的文件及文件夹：\\dir\\ 为忽略dir目录，.txt 为忽略扩展名的文件 xcopy folder2 test\\folder2\\ /E /exclude:exclude.txt :: 使用copy命令拷贝exclude.txt到test目录下 copy exclude.txt .\\test\\ :: 压缩test文件夹到test.zip，完成后删除test目录 start winrar a test.zip .\\test -dr xcopy命令/exclude参数所需的exclude.txt内容 folder2\\dir\\ folder2\\ignore.txt © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"index/ide.html":{"url":"index/ide.html","title":"开发工具","keywords":"","body":"开发工具 常用开发工具配置、插件等。 VSCode IDEA EditorConfig © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"ide/vscode.html":{"url":"ide/vscode.html","title":"VSCode","keywords":"","body":"VSCode 配置 { \"breadcrumbs.enabled\": false, \"dart.debugExternalLibraries\": true, \"dart.debugSdkLibraries\": false, \"diffEditor.ignoreTrimWhitespace\": false, \"editor.bracketPairColorization.enabled\": true, \"editor.fontSize\": 17, \"editor.formatOnPaste\": true, \"editor.guides.bracketPairs\": \"active\", \"editor.minimap.enabled\": true, \"editor.multiCursorModifier\": \"ctrlCmd\", \"editor.snippetSuggestions\": \"top\", \"editor.tabSize\": 2, \"emmet.includeLanguages\": { \"wxml\": \"html\" }, \"eslint.validate\": [\"javascript\", \"javascriptreact\", \"typescript\", \"typescriptreact\", \"vue\", \"html\"], \"explorer.autoReveal\": false, \"files.associations\": { \"*.cjson\": \"jsonc\", \"*.wxss\": \"css\", \"*.wxs\": \"javascript\" }, \"files.exclude\": { \"**/.git\": true, \"**/.svn\": true, \"**/.hg\": true, \"**/CVS\": false, \"**/.DS_Store\": true, \"**/tmp\": false, \"**/node_modules\": false, \"**/bower_components\": false, \"**/dist\": false, \"**/.cache\": false }, \"files.watcherExclude\": { \"**/.git/objects/**\": false, \"**/.git/subtree-cache/**\": false, \"**/.git/**\": true, \"**/.svn/**\": true, \"**/node_modules/**\": true, \"**/tmp/**\": true, \"**/bower_components/**\": true, \"**/dist/**\": true, \"**/_book/**\": true, \"**/.cache/**\": true }, \"search.exclude\": { \"**/.git/objects/**\": false, \"**/.git/subtree-cache/**\": false, \"**/.git/**\": true, \"**/.svn/**\": true, \"**/node_modules/**\": true, \"**/tmp/**\": true, \"**/bower_components/**\": true, \"**/dist/**\": true, \"**/_book/**\": true, \"**/.cache/**\": true }, \"http.proxyAuthorization\": \"false\", \"minapp-vscode.disableAutoConfig\": true, \"search.followSymlinks\": false, \"terminal.integrated.fontSize\": 14, \"update.enableWindowsBackgroundUpdates\": false, \"vsicons.dontShowNewVersionMessage\": true, \"vetur.validation.template\": false, \"volar.codeLens.pugTools\": false, \"workbench.colorTheme\": \"Monokai\", \"workbench.iconTheme\": \"vscode-icons\", \"workbench.startupEditor\": \"newUntitledFile\", \"workbench.sideBar.location\": \"left\", \"window.zoomLevel\": 0, \"extensions.autoUpdate\": true, \"update.mode\": \"manual\" } 常用插件 # 中文 Chinese (Simplified) Language Pack for Visual Studio Code # 编辑器代码格式化 EditorConfig for VS Code # js格式校验 ESLint # git忽略 gitignore # git增强插件，可查看提交记录 GitLens — Git supercharged # 路径自动补全 Path Intellisense # sublime键位 Sublime Text Keymap # 资源管理器图标 vscode-icons # () [] {} 匹配高亮区分，新版vscode已经内置，无需单独安装 # Bracket Pair Colorizer 2 # 查看文件16进制 hexdump for VSCode # markdown文件预览 Markdown Preview Enhanced # vue3，Volar vue3插件 Volar # vue2，Vetur vue2插件 #Vetur # react Simple React Snippets # css预编译stylus language-stylus # svn SVN # flutter开发插件，自动安装dart插件 Flutter # flutter 模版 Flutter Widget Snippets # 静态html本地开发，热加载 Live Server # px2rem.rootFontSize 默认设计稿宽750px，默认使用iphone7 设备宽375px 开发，按照index.js[x]中的rem自适应计算方法为 50 # 详细配置查看该插件说明 px2rem Volar配置 建议关闭配置 { \"volar.codeLens.scriptSetupTools\": false, \"volar.codeLens.references\": false } 对于全局组件，需要定义GlobalComponents进行类型检查以及组件标签高亮 // src/components.d.ts // declare module '@vue/runtime-core' works for vue 3 // declare module 'vue' works for vue2 + vue 3 declare module 'vue' { export interface GlobalComponents { RouterLink: {} RouterView: {} MyComponent: {} // 如果不支持ts的组件，可直接使用{} Button: typeof import('element-ui')['Button'] } } export { } 如果使用eslint可能会有报错，可直接通过.eslintignore屏蔽 components.d.ts 部分快捷键配置 # 1、代码提示 # 原快捷键 Ctrl + space，与系统冲突，修改即可 # 文件 -> 首选项 -> 键盘快捷方式，搜索“触发建议”，修改为 Alt + / ，按enter键保存即可 # 2、在资源管理器视图中显示活动文件 # 文件 -> 首选项 -> 键盘快捷方式，搜索“在资源管理器视图中显示活动文件”，修改为 Ctrl + ~ ，按enter键保存即可 自定义模版 在生成的template.code-snippets中加入以下 { \"vue2\": { \"prefix\": \"vue2 init template\", \"scope\": \"vue\", \"body\": [ \"\", \" \", \" \", \"\", \"\", \"export default {\", \" name: '$1'\", \"}\", \"\", \"\", \"\", \"\", \"\" ], \"description\": \"vue2初始化模版\" }, \"vue3\": { \"prefix\": \"vue3 init template\", \"scope\": \"vue\", \"body\": [ \"\", \" \", \" \", \"\", \"\", \"import { defineComponent } from 'vue'\", \"\", \"export default defineComponent({\", \" name: '$1',\", \" setup () {\", \" return {\", \"\", \" }\", \" }\", \"})\", \"\", \"\", \"\", \"\", \"\" ], \"description\": \"vue3初始化模版\" }, \"vue3setup\": { \"prefix\": \"vue3setup init template\", \"scope\": \"vue\", \"body\": [ \"\", \"import { } from 'vue'\", \"export default { name: '$1' }\", \"\", \"\", \"\", \"\", \"\", \" \", \"\", \"\" ], \"description\": \"vue3setup初始化模版\" } } 使用 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-06-29 "},"ide/idea.html":{"url":"ide/idea.html","title":"IDEA","keywords":"","body":"IDEA 远程调试 jar包方式启动java项目，可以使用idea进行远程调试1、远程服务器启动项目2、IDEA run Debug 3、IDEA 断点调试 nohup java -Xms256m -Xmx256m -jar -Xdebug -Xrunjdwp:transport=dt_socket,suspend=n,server=y,address= .jar >/dev/null 2>&1 & # IDEA 设置 run -> Edit Configurations -> + -> Remote Name: Host: Port: 常用插件 File -> Settings -> Plugins # 社区版Spring支持 Spring Assistant # Flutter相关，自动安装Dart Flutter # JRebel IDEA上热部署 JRebel and XRebel for IntelliJ # 破解 # 1、生成GUID：https://www.guidgen.com/ # 2、Help -> JRebel -> Activation -> Team URL分别填写 https://jrebel.qekang.com/ # 3、 勾选协议，Activate JRebel # 4、next enable JRebel -> I agree # 5、重启IDEA，JRebel setup guide按照提示操作 # Mybatis扩展支持 Free Mybatis plugin 常用设置 路径等配置 # 字体及大小 File -> Settings -> Editor -> Font Font: Consolas Size: 16 Line Spacing: 1.2 # Maven，使用本地Maven File -> Settings -> Build, Execution, Deployment -> Build Tools -> Maven Maven home directory: User settings file: # JDK设置，一般系统会自动设置，无需手动设置 File -> Settings -> Build, Execution, Deployment -> Build Tools -> Maven -> Runner JRE: # Flutter SDK路径设置，配置后，Dart会自动配置 File -> Settings -> Languages & Frameworks -> Flutter Flutter SDK path: # 取消代码重复提示 File -> Settings -> Editor -> Inspections -> General -> Duplicated Code # 注释模版，java方法 File -> Settings -> Editor -> Live Templates 1、右侧 + 选择 Template Group 填写名字 2、右侧 + 选择 Live Template 3、设置 （1）Abbreviation: （2）Description: （3）Template text: * * $target$ $param$ * @return $return$ */ （4）下方Applicable相关: （5）Expand with: （6）Edit variables: param: groovyScript(\"def result=''; def params=\\\"${_1}\\\".replaceAll('[\\\\\\\\[|\\\\\\\\]|\\\\\\\\s]', '').split(',').toList(); for(i = 0; i Settings -> Editor -> File and Code Templates 1、选中Files -> Class 2、选择Includes -> File Header /** * ${ClassName} * @author * @since ${YEAR}-${MONTH}-${DAY} ${HOUR}:${MINUTE}:00 */ 快捷键 # 代码补全，Eclipse中Alt + / File -> Settings -> Keymap -> Main menu -> Code -> Code Completion # 删除占用 Cyclic Expand Word: Cyclic Expand Word (Backward): # 添加 Basic: # 自动折行 File -> Settings -> Keymap -> Main menu -> View -> Active Editor # 添加 Soft-Wrap: IDE优化设置 # 自动续订试用，注意：版本2021.2.2及以前 Plugins -> Custom Plugin Repositories # 增加 https://plugins.zhile.io # 安装插件 IDE Eval Reset # Help最后，Eval Reset，勾选 Auto reset before per restart，Reset # 修改内存 Help -> Change Memory Settings # 取消索引（web项目，WebStorm中必备） Preferences -> Editor -> File Types Ignored Files and Folders 中 # 添加 node_modules # 关闭打开后自动进入项目 Preferences -> Appearance & Behavior -> System Settings # 取消勾选 Reopen projects on startup # 关闭更新 Preferences -> Appearance & Behavior -> System Settings -> Updates # 取消全部勾选 # 取消自动保存 File -> Settings -> Appearance & Behavior -> System Settings -> Autosave # 全部取消勾选 # 未保存文件显示* File -> Settings -> Editor -> General -> Editor Tabs Appearance -> Mark modified（*）# 勾选 # 控制台字体 File -> Settings -> Editor -> Color Scheme -> Console Font Use console font instead of the default # 勾选，设置Size 14 # 密码保存位置 Preferences -> Appearance & Behavior -> System Settings -> Passwords In KeePass # 选择，保存到本地（Mac不保存到钥匙串访问） # 取消保存自动格式化 Preferences -> Tools -> Actions on Save Reformat code # 取消勾选 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-09-16 "},"ide/editorconfig.html":{"url":"ide/editorconfig.html","title":"EditorConfig","keywords":"","body":"EditorConfig 项目根目录中添加.editorconfig文件，并在开发工具中安装相应插件，如：VSCode安装EditorConfig for Visual Studio Code # editorconfig.org root = true [*] indent_style = space indent_size = 2 end_of_line = lf charset = utf-8 trim_trailing_whitespace = true insert_final_newline = true # markdown文件不去掉结尾空格 [*.md] trim_trailing_whitespace = false © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"index/markdown.html":{"url":"index/markdown.html","title":"MarkDown","keywords":"","body":"MarkDown MarkDown部分语法。 转义字符 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"markdown/ascii.html":{"url":"markdown/ascii.html","title":"转义字符","keywords":"","body":"转义字符 Emoji表情 Emoji代码查询参照 Emoji Unicode Tables使用方式如下所示： Emoji Unicode 使用 &#x1F603; U+1F603 &#x1F603; ASCII转义字符 结果 描述 实体编号 空格 space &#32; ! exclamation mark &#33; \" quotation mark &#34; # number sign &#35; $ dollar sign &#36; % percent sign &#37; & ampersand &#38; ' apostrophe &#39; ( left parenthesis &#40; ) right parenthesis &#41; * asterisk &#42; + plus sign &#43; , comma &#44; - hyphen &#45; . period &#46; / slash &#47; 0 digit 0 &#48; 1 digit 1 &#49; 2 digit 2 &#50; 3 digit 3 &#51; 4 digit 4 &#52; 5 digit 5 &#53; 6 digit 6 &#54; 7 digit 7 &#55; 8 digit 8 &#56; 9 digit 9 &#57; : colon &#58; ; semicolon &#59; less-than &#60; = equals-to &#61; > greater-than &#62; ? question mark &#63; @ at sign &#64; A uppercase A &#65; B uppercase B &#66; C uppercase C &#67; D uppercase D &#68; E uppercase E &#69; F uppercase F &#70; G uppercase G &#71; H uppercase H &#72; I uppercase I &#73; J uppercase J &#74; K uppercase K &#75; L uppercase L &#76; M uppercase M &#77; N uppercase N &#78; O uppercase O &#79; P uppercase P &#80; Q uppercase Q &#81; R uppercase R &#82; S uppercase S &#83; T uppercase T &#84; U uppercase U &#85; V uppercase V &#86; W uppercase W &#87; X uppercase X &#88; Y uppercase Y &#89; Z uppercase Z &#90; [ left square bracket &#91; \\ backslash &#92; ] right square bracket &#93; ^ caret &#94; _ underscore &#95; ` grave accent &#96; a lowercase a &#97; b lowercase b &#98; c lowercase c &#99; d lowercase d &#100; e lowercase e &#101; f lowercase f &#102; g lowercase g &#103; h lowercase h &#104; i lowercase i &#105; j lowercase j &#106; k lowercase k &#107; l lowercase l &#108; m lowercase m &#109; n lowercase n &#110; o lowercase o &#111; p lowercase p &#112; q lowercase q &#113; r lowercase r &#114; s lowercase s &#115; t lowercase t &#116; u lowercase u &#117; v lowercase v &#118; w lowercase w &#119; x lowercase x &#120; y lowercase y &#121; z lowercase z &#122; { left curly brace &#123; | vertical bar &#124; } right curly brace &#125; ~ tilde &#126; © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"index/others.html":{"url":"index/others.html","title":"其它","keywords":"","body":"其它 操作系统 Excel © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"others/sys.html":{"url":"others/sys.html","title":"操作系统","keywords":"","body":"操作系统 iso系统镜像 CentOS系统镜像下载请点击Windows系统镜像下载请点击 iso镜像校验 # 使用Windows下certutil工具，打开命令提示符使用以下命令 # Windows iso镜像需要SHA1 # CentOS iso镜像需要SHA256 certutil -hashfile MD5 certutil -hashfile SHA1 certutil -hashfile SHA256 创建USB安装盘 Rufus下载地址请点击 Ventoy下载地址请点击&#x1F44D; CentOS USB安装盘示例（以Rufus为例） Windows USB安装盘示例（以Rufus为例） CentOS安装 1、进入CentOS安装界面，按TAB键进入配置编辑（根据提示，uefi是按E键）2、将配置改为vmlinuz initrd=initrd.img inst.stage2=hd......quiet改为vmlinuz initrd=initrd.img linux dd quiet3、修改之后回车系统会进入磁盘设备列表，查看U盘的设备名，记住设备名（如下图所示，如：sdb4）4、按CTRL + ALT + DEL重启，进入安装界面5、按TAB编辑配置，改为vmlinuz initrd=initrd.img inst.stage2=hd:/dev/sdb4 quiet6、sdb4对应U盘的设备名，然后按回车进入图形安装界面 Windows安装 注意：DELL ChengMing3980 8代CPU，系统应为：UEFI+GPT+WIN10 Windows10删除3D对象 注册表中删除{0DB7E03F-FC29-4DC6-9020-FF41B59E513A} 计算机\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer\\NameSpace 计算机\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer\\Namespace 右键 - 在此处打开命令窗口 注册表目录计算机\\HKEY_CLASSES_ROOT\\Directory\\Background\\shell # 1、shell项，右键 新建 项，命名为 cmd_shell # 2、cmd_shell中设置 # (默认) -> 在此处打开命令窗口 # 新建 字符串值 -> Extended # 新建 字符串值 -> Icon -> 值 -> cmd.exe # 新建 项 -> command -> (默认) -> cmd.exe /s /k pushd \"%V\" 说明：字符串值 Extended：shift + 右键 才会显示 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"others/excel.html":{"url":"others/excel.html","title":"Excel","keywords":"","body":"Excel Excel生成32位UUID =LOWER(CONCATENATE(DEC2HEX(RANDBETWEEN(0,POWER(16,8)),8),\"\",DEC2HEX(RANDBETWEEN(0,POWER(16,4)),4),\"\",\"4\",DEC2HEX(RANDBETWEEN(0,POWER(16,3)),3),\"\",DEC2HEX(RANDBETWEEN(8,11)),DEC2HEX(RANDBETWEEN(0,POWER(16,3)),3),\"\",DEC2HEX(RANDBETWEEN(0,POWER(16,8)),8),DEC2HEX(RANDBETWEEN(0,POWER(16,4)),4))) © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "},"index/collection.html":{"url":"index/collection.html","title":"文章收藏","keywords":"","body":"文章收藏 文档 [JavaScript] ES6 入门教程[JavaScript] MDN[JavaScript] 现代 JavaScript 教程[JavaScript] 30 秒就能理解的 JavaScript 代码片段[FrontEnd] 30 seconds of code[Animation] TweenMax动画工具 构建补间动画[Java] Java 8 Api手册[手册] 网道 / WangDoc.com 工具 [微信公众号] 10个可视化 CSS 工具， 快速生成 CSS 片段 前端 Html [GitHub] HTML 面试知识点总结[掘金] 中高级前端必须注意的40条移动端H5坑位指南 | 网易三年实践 JavaScript [掘金] JavaScript 那些写出来会被同事揍的骚操作[掘金] 移动端300ms延迟以及点击穿透[掘金] 由浅入深，66条JavaScript面试知识点[掘金] 吊打 JavaScript 之从原型到原型链[掘金] (查缺补漏)送你 54 道 JavaScript 面试题[掘金] 从Vue源码中学到的28个编程好习惯[掘金] 这些前端基础题你能答对几道？(测试你的基础掌握,附答案解析)[掘金] [建议👍]再来100道JS输出题酸爽继续（共1.8W字+巩固JS基础）[掘金] [诚意满满✍]带你填一些JS容易出错的坑[掘金] 你不知道的 WebSocket[掘金] 「一劳永逸」送你21道高频JavaScript手写面试题[掘金] [译] 你不知道的 console 命令[掘金] 编写高质量可维护的代码之优化逻辑判断[GitHub] JavaScript 面试知识点总结[掘金] 进阶必读：深入理解 JavaScript 原型[掘金] Javascript中常用的13种设计模式[掘金] 「多图预警」那些年，被blob虐过的程序猿觉醒了！[开源中国] 基于vue的h5文件切片上传（获取文件md5，实现秒传、进度条实现）[掘金] 从原型链出发，看看 Class 被编译成了什么样子[SegmentFault] JavaScript: 数组reduce实例方法[掘金] 最全的手写JS面试题[掘金] Event Loop ：你知道它们的打印顺序吗？[掘金] 25个你不得不知道的数组reduce高级用法[掘金] 灵活运用JS开发技巧[掘金] 1.5万字概括ES6全部特性(已更新ES2020)[掘金] 【建议收藏】25+正则面试题详尽解析，让你轻松通过正则面试，让你少写2000行代码[MDN] JSON.stringify特性[掘金] 宏任务和微任务的理解 CSS [掘金] 一篇全面的CSS布局学习指南 [译][掘金] 一文梳理CSS必会知识点[掘金] CSS Viewport 单位，很多人还不知道使用它来快速布局！[掘金] 你可能不知道的Animation动画技巧与细节[掘金] 每天一个小技巧：纯CSS实现瀑布流（Masonry）[掘金] 每天一个小技巧：变形汉堡按钮（Hamburger Menu）[掘金] 每天一个小技巧：CSS clip-path 的妙用[掘金] 【收藏】你不知道的css技巧[掘金] 令人头疼的skew()倾斜函数之我见[掘金] 『真香警告』这33个超级好用的CSS选择器，你可能见都没见过。[掘金] css篇--100道近两万字帮你巩固css知识点[掘金] 最强大的 CSS 布局 —— Grid 布局[阮一峰] Flex 布局教程：语法篇[阮一峰] CSS Grid 网格布局教程[GitHub] CSS 面试知识点总结[Others] You-need-to-know-css[掘金] CSS 奇思妙想边框动画[掘金] 灵活运用CSS开发技巧[掘金] 【建议收藏】css晦涩难懂的点都在这啦[掘金] 超详|2020年你不应该错过的CSS新特性[掘金] Flexbox布局中不为人知的细节[掘金] 你可能不太熟知的CSS布局技巧[掘金] 1.5 万字 CSS 基础拾遗（核心知识、常见需求）[掘金] 仅使用CSS提高页面渲染速度[GitHub] iCSS[掘金] 分享几个css生成工具[掘金] CSS 实现多行文本“展开收起”[掘金] CSS 自动显示“全文”链接[掘金] 疯狂操作 CSS3 实现 60 FPS 动画效果，CodeReview 时同事直呼：细节！[掘金] 能用CSS实现的就不用麻烦JavaScript[掘金] 能用CSS实现的就不用麻烦JavaScript — Part2[掘金] 8个硬核技巧带你迅速提升CSS技术 | 掘金直播总结[掘金] 8则未必知道且超级实用的纯CSS布局排版技巧 | 网易4年实践[掘金] 灵活运用CSS开发技巧[掘金] 巧用CSS filter，让你的网站更加酷炫！[掘金] 好玩的 CSS - 40 个有趣的 CSS 网站 TypeScript [掘金] 🔥一篇够用的TypeScript总结[掘金] 你可能不知道的 TypeScript 高级技巧[掘金] 一份不可多得的 TS 学习指南（1.8W字）[掘金] 总结TypeScript在项目开发中的应用实践体会 Vue [掘金] 从 0 开始手把手带你搭建一套规范的 Vue3.x 项目工程环境[掘金] 揭秘 Vue.js 九个性能优化技巧[掘金] 史上最强vue总结---面试开发全靠它了[掘金] 实战技巧，Vue原来还可以这样写[掘金] 前方高能，这是最新的一波Vue实战技巧，不用则已，一用惊人[掘金] 10个简单的技巧让你的 vue.js 代码更优雅🍊[掘金] 一万字教你怎么用 Vue[掘金] 一个合格的中级前端工程师应该掌握的 20 个 Vue 技巧 React [掘金] 「React进阶」 React全部api解读+基础实践大全(夯实基础2万字总结) Webpack [掘金] 「一劳永逸」由浅入深配置webpack4[JELLY] 学习 Webpack5 之路（基础篇）[JELLY] 学习 Webpack5 之路（实践篇）[JELLY] 学习 Webpack5 之路（优化篇） JQuery [掘金] [ 浅谈前端 ] jQuery基本使用 其它 [掘金] 超实用！7 个优秀的 UI 交互动画技巧[掘金] 1.4万字 | 玩转前端 Video 播放器[掘金] 「查缺补漏」送你18道浏览器面试题[掘金] 14期-连肝7个晚上，总结了计算机网络的知识点！（共66条）[掘金] 脱离996，Chrome DevTools 面板全攻略！！！[掘金] 那些前端开发必不可少的生产力工具[SegmentFault] 关于移动端适配，你必须要知道的[掘金] 前端10个灵魂拷问 吃透这些你就能摆脱初级前端工程师！[掘金] 「查缺补漏」巩固你的HTTP知识体系[掘金] 前端一键自动部署工具🛠[GitHub] 算法知识总结[GitHub] 计算机网络知识总结[GitHub] 半小时搞懂 HTTP、HTTPS和HTTP2[掘金] 整理一批正在学、正在看、正在用，前端工具[掘金] 拯救你的年底KPI：前端性能优化[掘金] 前端优秀实践不完全指南[掘金] ES6、ES7、ES8、ES9、ES10新特性一览[SegmentFault] JS语法 ES6、ES7、ES8、ES9、ES10、ES11、ES12新特性[掘金] 让我告诉你一些强无敌的 NPM 软件包[掘金] 【设计模式】这样学也太简单了吧！[GitHub] CSS像素、物理像素、逻辑像素、设备像素比、PPI、Viewport[SegmentFault] Vite 开发插件如何生成 .d.ts 类型声明文件[掘金] 中高级前端必须注意的40条移动端H5坑位指南 | 网易三年实践[掘金] 写给中高级前端关于性能优化的9大策略和6大指标 | 网易四年实践[掘金] 前端性能优化指南[掘金] 推荐 10 个很“哇塞”的Web“资源”给前端工友，收藏等于学会~[掘金] (算法入门)人人都能看懂的时间复杂度和空间复杂度[掘金] 十大经典排序算法总结（JavaScript描述）[掘金] 太震撼了！我把七大JS排序算法做成了可视化！！！太好玩了！ 后端 [微信公众号] spring：我是如何解决循环依赖的？[开源中国] 聊聊spring事务失效的12种场景，太坑了 Server [掘金] 2万字系统总结，带你实现 Linux 命令自由？[掘金] 万字总结，体系化带你全面认识 Nginx ！[掘金] 【Nginx】前端该了解的 Nginx 知识 微信开发 公众号 [SegmentFault] vue使用微信JS-SDK实现分享功能 Flutter [掘金] 最新上架App Store 全流程[掘金] 最新App上架安卓应用市场[掘金] flutter好用的轮子推荐一-列表动画[掘金] flutter好用的轮子推荐二-点赞按钮动画[掘金] flutter好用的轮子推荐三-超强轮播图Swiper[掘金] flutter好用的轮子推荐四-可定制的图片预览查看器photo_view[掘金] flutter好用的轮子推荐五-列表左右滑动带出按钮选项[掘金] flutter好用的轮子推荐六-超好用的全局toast （ 同类型组件fluttertoast ）[掘金] flutter好用的轮子推荐七-flutter圆形或线型进度条[掘金] flutter好用的轮子推荐八-flutter一个超酷动画的底部tab栏[掘金] flutter好用的轮子推荐九-flutter可定制的上下滑出抽屉[掘金] flutter好用的轮子推荐十-flutter拖动排序元素[掘金] flutter好用的轮子推荐十一-flutter文字动效组件[掘金] flutter好用的轮子推荐十二-flutter一个全屏动效的抽屉组件[掘金] flutter好用的轮子推荐十三-flutter可展开选项的浮动按钮[掘金] flutter好用的轮子推荐十四-flutter将widget裁剪成各种自定义形状[掘金] flutter好用的轮子推荐十五-flutter给滚动内容添加粘性header组件[掘金] flutter好用的轮子推荐十六-flutter可自定义的评分组件[掘金] flutter好用的轮子推荐十七-flutter可翻转的卡片组件[掘金] flutter好用的轮子推荐十八-flutter液体效果的页面切换组件[掘金] flutter好用的轮子推荐十九-flutter水波效果的进度器[掘金] flutter好用的轮子推荐二十一-flutter制作刮刮卡效果[掘金] Flutter Candies 一桶天下[掘金] flutter开发之Dart[必读篇]💯[掘金] flutter实战总结(老手不必看) Git [掘金] 三年 Git 使用心得 & 常见问题整理[掘金] 「一劳永逸」一张脑图带你掌握Git命令[掘金] 一份工作 6 年前端的 Git 备忘录 🛠 SQL MySQL [掘金] MySQL的四种事务隔离级别 其它 [GitHub] 家庭网络知识整理[掘金] 【利器篇】35+精选chrome插件，含15+前端插件，总有一款值得你停留[掘金] 【利器篇】前端40+精选VSCode插件，总有几个你未拥有！ © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-08-19 "},"index/delicious.html":{"url":"index/delicious.html","title":" ","keywords":"","body":"A magic page! var container = document.getElementsByClassName('body-inner')[0] container.style.overflow = 'hidden' document.getElementById('a-magic-page').ondblclick = function () { container.style.overflow = '' } 吕座酸菜鱼秘籍 鱼的选择酸菜鱼主要用草鱼和黑鱼两种（推荐后者）；草鱼便宜并且肉质鲜嫩，但是刺多；黑鱼没有毛刺，肉质紧实； 酸菜包的选择一般选用海底捞或者好人家； 配料葱、姜、蒜、花椒、盐、料酒、白胡椒、淀粉、鸡蛋清； 鱼的处理1、将鱼肉和鱼骨分离，鱼肉切薄片；2、用腌鱼料包腌制鱼片，约20分钟（没有料包就手动：盐、胡椒粉、淀粉、鸡蛋清）；3、鱼头和鱼骨放料酒腌制； 制作1、起锅烧油，推荐使用花生油，放鱼头和鱼骨煎炒，三分钟后加入葱姜蒜爆香，然后加入酸菜煸炒，加入料酒；2、加入开水约1200毫升，烧开后煮5~8分钟，汤色泛白酸菜出味，加入调味料（可用料包的，或者自己加盐也可以），再煮三分钟；3、将鱼骨和酸菜捞出至盆中备用，锅内留汤；4、将鱼片下入汤锅，滑1分钟（开锅即可）；5、将鱼片和汤倒盆中，然后把花椒、蒜末或者蒜苗放在鱼片上面；6、烧一勺油，稍微冒烟，浇到花椒、蒜苗上面，即制作完成； PS喜欢吃配菜，可以焯点豆芽放在锅底。 © 2023 www.wdg.pub all right reserved，powered by GitbookLast modified: 2022-05-22 "}}