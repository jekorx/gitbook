{"./":{"url":"./","title":"前言","keywords":"","body":"个人主页 主页地址：https://www.wdg.pub/主要是个人学习、工作经验的总结，不断完善中··· 如果存在错误，或者有好的建议还请多指教，提交反馈 个人GitHub地址：https://github.com/jekorx个人Npm地址：https://www.npmjs.com/~jekorx 1、[cnode-react](https://github.com/jekorx/cnode-react)，是CNodejs移动webapp react实现，可在[CNodejs社区](https://cnodejs.org)注册账号，使用AccessToken登录，[点此查看演示](https://jekorx.github.io/cnode-react)，请使用移动网页模式查看，由于路由是history模式（无法配置github web服务器），在非 / 根目录刷新会404 > 2、[vue-carousel-card](https://github.com/jekorx/vue-carousel-card)，vue轮播，[点此查看演示](https://jekorx.github.io/vue-carousel-card/) > 3、[particle-wave](https://github.com/jekorx/particle-wave)，WebGL粒子波浪效果，[点此查看演示](https://jekorx.github.io/particle-wave/) > 4、[bio](https://github.com/jekorx/bio)，vue个人简历模版，[点此查看演示](https://jekorx.github.io/bio/) > 5、gallery-by-react，react画廊，[点此查看演示](https://jekorx.github.io/gallery-by-react/) --> © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2021-02-19 "},"index/nodejs.html":{"url":"index/nodejs.html","title":"Node.js","keywords":"","body":"Node.js 主要是基于Node.js一些常用工具的介绍，基本用法总结。 Npm Yarn PM2 Http-Server © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"nodejs/npm.html":{"url":"nodejs/npm.html","title":"Npm","keywords":"","body":"Npm 设置淘宝镜像源 # 解决npm或者某些依赖于npm的命令（gitbook等）安装依赖慢的问题 npm config set registry=http://registry.npm.taobao.org # 解决node-sass安装失败的问题 npm config set sass_binary_site=https://npm.taobao.org/mirrors/node-sass 版本 # 版本号 # .. x.y.z # 修复bug，小改动，增加z # 增加新特性，可向后兼容，增加y # 有很大的改动，无法向下兼容，增加x # 大于等于修补版本号 # 如：~1.2.3，表示从>=1.2.3到=2.3.4到1.1.2，表示必须大于1.1.2版 >version # 可大于或等于某个版本 # 如：>=1.1.2，表示可以等于1.1.2，也可以大于1.1.2版本 >=version # 必须小于某个版本 # 如：=0.0.0的任意版本 * # 大于等于version1，小于等于version2 # 如：1.1.2 - 1.3.1，表示包括1.1.2和1.3.1以及他们件的任意版本 version1 - version2 # 满足range1或者满足range2，可以多个范围 # 如：=2.3.1 =2.5.2 发布npm包 1、注册npm帐号，点击前往npm官网2、登录npm帐号 # 根据提示输入创建的账号、密码和邮箱 npm login 3、发布包，.gitignore或.npmignore中的文件将会被忽略版本更新时，需要提升版本号 npm publish 4、撤销发布删除npm市场的包同名的24小时后才能重新发布 # 删除某个版本 npm unpublish @ # 删除整个npm市场的包 npm unpublish --force # 不删除，安装时会提示，版本号可忽略 # 如：npm deprecate '这个包已经不再维护了' npm deprecate [@] linux npm 全局安装权限不足的问题 一般非root用户操作会出现该问题 Windows系统： 1、通常是因为项目位置导致，如：电脑桌面的项目；2、需要以管理员身份运行命令行工具。 # 相关报错信息 error code EACCES error syscall access error path /usr/local/lib/nodejs/node-v12.16.2-linux-x64/lib/node_modules error errno -13 error Error: EACCES: permission denied, access '/usr/local/lib/nodejs/node-v12.16.2-linux-x64/lib/node_modules' error [Error: EACCES: permission denied, access '/usr/local/lib/nodejs/node-v12.16.2-linux-x64/lib/node_modules'] { error stack: \"Error: EACCES: permission denied, access '/usr/local/lib/nodejs/node-v12.16.2-linux-x64/lib/node_modules'\", error errno: -13, error code: 'EACCES', error syscall: 'access', error path: '/usr/local/lib/nodejs/node-v12.16.2-linux-x64/lib/node_modules' error } error The operation was rejected by your operating system. error It is likely you do not have the permissions to access this file as the current user error error If you believe this might be a permissions issue, please double-check the error permissions of the file and its containing directories, or try running error the command again as root/Administrator. 解决方法 # 1、在命令行的主目录中，为全局安装创建目录： mkdir ~/.npm-global # 2、配置npm以使用新的目录路径： npm config set prefix '~/.npm-global' # 3、打开或创建一个 ~/.bash_profile 文件并添加以下行： export PATH=$PATH:~/.npm-global/bin # 4、在命令行上，更新系统变量： source ~/.bash_profile # 5、要测试新配置，请在不使用的情况下全局安装软件包sudo： npm install -g yarn # 可以使用相应的ENV变量代替步骤1-3（例如，如果您不想修改~/.bash_profile NPM_CONFIG_PREFIX=~/.npm-global # npm 5.2或更高版本，则可能要考虑将npx作为运行全局命令的替代方法 npx node-sass安装失败的问题 win10环境 Error: Can't find Python executable \"python\", you can set the PYTHON env variable. 解决方法 # node-gyp npm install -g node-gyp # 用管理员权限打开命令行执行 npm install --global --production windows-build-tools # 该命令会安装 # 1、python(v2.7，3.x不支持) # 2、visual C++ Build Tools，或者 （vs2015以上（包含15）） # 3、.net framework 4.5.1 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"nodejs/yarn.html":{"url":"nodejs/yarn.html","title":"Yarn","keywords":"","body":"yarn 快速、可靠、安全的依赖管理工具。比npm好用 0_0 安装 # 使用npm安装 npm i -g yarn # 使用npm升级yarn npm update -g yarn 相关问题及解决方案 # 可能会安装失败，原因基本都是权限问题 # MacOS / Linux sudo npm i -g yarn # windows可以使用管理员权限启动的命令行 # 检查 yarn -v # 如果出现找不到该命令的问题，需要配置全局环境变量 # 该问题多出现在windows系统 # 环境变量中增加npm安装的全局工具的路径 # windows C:\\Users\\\\AppData\\Roaming\\npm # yarn安装的全局工具不能用的问题 # 该问题多出现在windows系统 # 环境变量中增加yarn安装的全局工具的bin路径 # windows C:\\Users\\\\AppData\\Local\\Yarn\\bin 设置淘宝镜像源 # 解决安装依赖慢的问题 yarn config set registry https://registry.npm.taobao.org # 解决node-sass安装失败的问题 yarn config set sass_binary_site https://npm.taobao.org/mirrors/node-sass 常用命令 以安装react和http-server为例 npm yarn npm i yarn npm i react -S yarn add react npm uninstall react -S yarn remove react npm i react -D yarn add react -D npm update react -S yarn upgrade react npm i -g http-server yarn global add http-server npm update -g http-server yarn global upgrade http-server 注意：yarn全局安装关键字global必须跟在yarn关键字后面，否则会安装global © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"nodejs/process-manager.html":{"url":"nodejs/process-manager.html","title":"PM2","keywords":"","body":"PM2（Process Manager 2） Node进程管理工具，简化Node App管理的繁琐任务，如性能监控、自动重启、负载均衡等。 常用命令 # 启动app pm2 start yarn --name AppName -- start # 查看所有app pm2 list # or pm2 ls # 启动，all表示全部app，CMD表示命令（如：yarn），-i max 表示cluster模式，数量为最大cpu核数，--watch表示当文件变化时自动重启应用，args表示参数 pm2 start [id | AppName | all | CMD] --name [AppName] -i max --watch -- [args] # 停止，all表示全部app pm2 stop [id | AppName | all] # 重启，相当于先 stop 再 start，会导致服务短时间内无法使用，all表示全部app pm2 restart [id | AppName | all] # 热重载，多用于cluster模式，逐个重新启动所有进程，始终保持至少一个进程在运行，实现不停机重载 pm2 reload [AppName] # 删除，all表示全部app pm2 delete [id | AppName | all] # 监控 pm2 monit [id | AppName] # 日志 pm2 logs 常见错误 windows系统常见错误（1） # 报错信息 C:\\USERS\\\\APPDATA\\ROAMING\\NPM\\YARN.CMD:1 (function (exports, require, module, __filename, __dirname) { @IF EXIST \"%~dp0\\node.exe\" ( ^ SyntaxError: Invalid or unexpected token at new Script (vm.js:79:7) at createScript (vm.js:251:10) at Object.runInThisContext (vm.js:303:10) at Module._compile (internal/modules/cjs/loader.js:656:28) at Object.Module._extensions..js (internal/modules/cjs/loader.js:699:10) at Module.load (internal/modules/cjs/loader.js:598:32) at tryModuleLoad (internal/modules/cjs/loader.js:537:12) at Function.Module._load (internal/modules/cjs/loader.js:529:3) at Object. (C:\\Users\\\\AppData\\Local\\Yarn\\Data\\global\\node_modules\\pm2\\lib\\ProcessContainerFork.js:27:21) at Module._compile (internal/modules/cjs/loader.js:688:30) C:\\USERS\\\\APPDATA\\ROAMING\\NPM\\YARN.CMD:1 (function (exports, require, module, __filename, __dirname) { @IF EXIST \"%~dp0\\node.exe\" ( # 错误分析 在Windows上，yarn.cmd它不是有效的，您必须直接运行Node.js命令 # 解决方法 pm2 start C:\\Users\\\\AppData\\Roaming\\npm\\node_modules\\yarn\\bin\\yarn.js --name nuxt -- start © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"nodejs/http-server.html":{"url":"nodejs/http-server.html","title":"Http-Server","keywords":"","body":"http-server http-server是一个简单的，零配置的命令行http服务器。 安装 npm install http-server -g # or yarn global add http-server 使用 http-server [path] [options] 可用选项 -p 要使用的端口（默认为8080） -a 要使用的地址（默认为0.0.0.0） -d 显示目录列表（默认为'True'） -i 显示autoIndex（默认为'True'） -g或者--gzip当启用时（默认为'False'），它将./public/some-file.js.gz代替./public/some-file.js当文件的gzip压缩版本存在且请求接受gzip编码时。 -e或者--ext如果没有提供默认文件扩展名（默认为'html'） -s或者--silent从输出中抑制日志消息 --cors通过Access-Control-Allow-Origin标头启用CORS -o 启动服务器后打开浏览器窗口 -c设置缓存控制max-age标头的缓存时间（以秒为单位），例如-c10为10秒（默认为“3600”）。要禁用缓存，请使用-c-1。 -U或--utc在日志消息中使用UTC时间格式。 -P或者将--proxy所有无法在本地解析的请求代理到给定的URL。例如：-P http://someurl.com -S或--ssl启用https。 -C或--certssl cert文件的路径（默认值：cert.pem）。 -K或--keyssl密钥文件的路径（默认值：key.pem）。 -r或--robots提供/robots.txt（其内容默认为'User-agent：* \\ nDisisis：/'） -h或--help打印此列表并退出。 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"index/frontend.html":{"url":"index/frontend.html","title":"前端","keywords":"","body":"Web前端 前端相关使用总结。 Axios Html Css 移动端vw适配方案 Vue.js Create React App Vue Cli Js Utils 正则表达式 ESLint Less Canvas 防抖节流 Webpack Nuxt.js 高德vue地图选择器 VueQuillEditor Chrome文件下载 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2021-01-20 "},"frontend/axios.html":{"url":"frontend/axios.html","title":"Axios","keywords":"","body":"Axios Axios 是一个基于promise的HTTP库，可以用在浏览器和node.js中。 安装 yarn add axios # or npm i axios -S 基本使用 /** * 1、基础使用1 * axios(config) * 2、基础使用2，url不在配置中指定 * axios(url[, config]) * 3、默认请求方法别名 * 使用别名方法时，url、method、data 这些属性都不必在配置中指定。 * axios.request(config) * axios.get(url[, config]) * axios.delete(url[, config]) * axios.head(url[, config]) * axios.post(url[, data[, config]]) * axios.put(url[, data[, config]]) * axios.patch(url[, data[, config]]) * 4、并发 * axios.all(iterable) * axios.spread(callback) * 例： * let axiosList=[ * axios.get('url1', { params: 'xxx' }), * axios.get('url2', { params: 'xxx' }) * ] * axios.all(axiosList).then(axios.spread((res1, res2) => { * console.log(res1, res2) // 分别是两个请求的返回值 * }) * 5、创建实例 * axios.create([config]) */ /** * promise方式 */ function get () { // GET请求参数名必须是params，URL参数，可参考详细配置 axios.get('/user', { params: { ID: '12345' } }) .then(res => { console.log(res) }) .catch(err => { console.log(err) }) } function post () { axios.post('/user', { firstName: 'Fred', lastName: 'Flintstone' }) .then(res => { console.log(res) }) .catch(err => { console.log(err) }) } /** * async/await方式 */ async function gets () { try { let data1 = await axios.get('url1', { params: 'xxx' }) let data2 = await axios.get('url2', { params: 'xxx' }) console.log(data1, data2) } catch (error) { console.log(error) } } 常用配置 Java后端 import axios from 'axios' import qs from 'qs' /** * axios config */ // url 前缀 axios.defaults.baseURL = process.env.NODE_ENV === 'production' ? '/web/' : '/api/' // 跨域请求时携带cookie axios.defaults.withCredentials = true /** * axios 默认 Content-Type: application/json;charset=UTF-8 * 请求正文为Request Payload，格式是json格式的字符串，需要用 @RequestBody 方式接收参数 * * 如果后端使用 @RequestParam 方式接收，配置transformRequest，参数使用qs转换 * 请求头Content-Type会被设置为: Content-Type: application/x-www-form-urlencoded;charset=UTF-8 * 请求正文为Form Data，格式是key=value&key1=value2 * 后端接收对象参数，无需任何注解可自动转换接收 */ // 请求参数转转换，{ a: 123, b: 'str' } => a=123&b=str axios.defaults.transformRequest = [params => qs.stringify(params)] // 请求统一额外参数 axios.defaults.params = { apiuser: 'debug' } // 请求拦截器 axios.interceptors.request.use(config => { // 请求发出前，可以开始加载动画之类的操作 return config }, error => { // 请求发出错误处理 return Promise.reject(error) }) // 响应拦截器 axios.interceptors.response.use(response => { // 接收到响应处理，停止加载动画之类操作 return response }, error => { // 响应错误处理，统一异常处理 console.log(error.stack) return Promise.reject(error) }) 使用全局默认配置，特殊使用时配置 使用了上述全局配置之后，请求头Content-Type会被设置为: application/x-www-form-urlencoded 如果上传文件需要将Content-Type设置为multipart/form-data，具体使用如下所示 /** * 使用axios上传文件，ajax文件上传 */ // input(type=\"file\" onchange=\"fileChange\" multiple=\"multiple\") // 设置multiple可以选择多个文件 function fileChange (e) { // 获取文件对象数组 let files = e.target.files // 创建一个FormData，存储需要提交的表单数据，如果通过ajax方式上传文件，必须使用FormData let formData = new FormData() // 普通表单数据 formData.append('num', 123) formData.append('name', 'aa') // 文件数据 formData.append('file', files[0]) // 多个文件数据需要遍历放入 for (let f of files) { formData.append('files', f) } // 上传data必须转为formData axios.post('/upload', formData, { // 覆盖默认设置中的transformRequest设置 transformRequest: [(params, headers) => { // 请求头Content-Type 为multipart/form-data headers = { 'Content-Type': 'multipart/form-data' } // 取消qs参数转换 return params }], // 上传进度 onUploadProgress ({ loaded, total }) { let p = (loaded / total * 100).toFixed(0) + '%' console.log(p) } }).then(res => console.log(res)) } 详细配置 { // `url` 是用于请求的服务器 URL url: '/user', // `method` 是创建请求时使用的方法 method: 'get', // 默认是 get // `baseURL` 将自动加在 `url` 前面，除非 `url` 是一个绝对 URL。 // 它可以通过设置一个 `baseURL` 便于为 axios 实例的方法传递相对 URL baseURL: 'https://some-domain.com/api/', // `transformRequest` 允许在向服务器发送前，修改请求数据 // 只能用在 'PUT', 'POST' 和 'PATCH' 这几个请求方法 // 后面数组中的函数必须返回一个字符串，或 ArrayBuffer，或 Stream transformRequest: [function (data) { // 对 data 进行任意转换处理 return data; }], // `transformResponse` 在传递给 then/catch 前，允许修改响应数据 transformResponse: [function (data) { // 对 data 进行任意转换处理 return data; }], // `headers` 是即将被发送的自定义请求头 headers: {'X-Requested-With': 'XMLHttpRequest'}, // `params` 是即将与请求一起发送的 URL 参数 // 必须是一个无格式对象(plain object)或 URLSearchParams 对象 params: { ID: 12345 }, // `paramsSerializer` 是一个负责 `params` 序列化的函数 // (e.g. https://www.npmjs.com/package/qs, http://api.jquery.com/jquery.param/) paramsSerializer: function(params) { return Qs.stringify(params, {arrayFormat: 'brackets'}) }, // `data` 是作为请求主体被发送的数据 // 只适用于这些请求方法 'PUT', 'POST', 和 'PATCH' // 在没有设置 `transformRequest` 时，必须是以下类型之一： // - string, plain object, ArrayBuffer, ArrayBufferView, URLSearchParams // - 浏览器专属：FormData, File, Blob // - Node 专属： Stream data: { firstName: 'Fred' }, // `timeout` 指定请求超时的毫秒数(0 表示无超时时间) // 如果请求话费了超过 `timeout` 的时间，请求将被中断 timeout: 1000, // `withCredentials` 表示跨域请求时是否需要使用凭证 withCredentials: false, // 默认的 // `adapter` 允许自定义处理请求，以使测试更轻松 // 返回一个 promise 并应用一个有效的响应 adapter: function (config) { /* ... */ }, // `auth` 表示应该使用 HTTP 基础验证，并提供凭据 // 这将设置一个 `Authorization` 头，覆写掉现有的任意使用 `headers` 设置的自定义 `Authorization`头 auth: { username: 'janedoe', password: 's00pers3cret' }, // `responseType` 表示服务器响应的数据类型，可以是 'arraybuffer', 'blob', 'document', 'json', 'text', 'stream' responseType: 'json', // 默认的 // `xsrfCookieName` 是用作 xsrf token 的值的cookie的名称 xsrfCookieName: 'XSRF-TOKEN', // default // `xsrfHeaderName` 是承载 xsrf token 的值的 HTTP 头的名称 xsrfHeaderName: 'X-XSRF-TOKEN', // 默认的 // `onUploadProgress` 允许为上传处理进度事件 onUploadProgress: function (progressEvent) { // 对原生进度事件的处理 }, // `onDownloadProgress` 允许为下载处理进度事件 onDownloadProgress: function (progressEvent) { // 对原生进度事件的处理 }, // `maxContentLength` 定义允许的响应内容的最大尺寸 maxContentLength: 2000, // `validateStatus` 定义对于给定的HTTP 响应状态码是 resolve 或 reject promise 。如果 `validateStatus` 返回 `true` (或者设置为 `null` 或 `undefined`)，promise 将被 resolve; 否则，promise 将被 rejecte validateStatus: function (status) { return status >= 200 && status © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-27 "},"frontend/html.html":{"url":"frontend/html.html","title":"Html","keywords":"","body":"HTML 禁用页面缓存 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2021-01-20 "},"frontend/css.html":{"url":"frontend/css.html","title":"Css","keywords":"","body":"Css样式 文本域内容解析换行，解析换行符网站全局黑白色水平垂直居中文本超出省略号渐变色div+css绘制六边形div+css实现四角边框 文本域内容解析换行，解析换行符 white-space: pre-wrap; 网站全局黑白色 /* 须在html上设置 */ html { -webkit-filter: grayscale(100%); -moz-filter: grayscale(100%); -ms-filter: grayscale(100%); -o-filter: grayscale(100%); filter: grayscale(100%); filter: progid:DXImageTransform.Microsoft.BasicImage(grayscale=1); } 水平垂直居中 水平垂直居中 /* 默认初始化样式 */ body { height: 500px; } .center { height: 20%; border: 1px solid #666; } /* 1、line-height水平垂直居中 */ /* 父节点固定px高度 */ .center { text-align: center; height: 100px; line-height: 100px; } /* 2、绝对定位水平垂直居中 */ /* 子节点固定px高度 .center { text-align: center; position: relative; } .center span { position: absolute; top: 0; left: 0; right: 0; bottom: 0; margin: auto; width: 200px; height: 21px; text-align: center; } */ /* 衍生写法，&#x1F525;推荐使用 top、left偏移父容器的50%，通过transform: translate偏移自身-50%实现居中 可不设置子节点宽高 */ .center span { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; } /* 3、伪类水平垂直居中 */ /* 容器before伪类生成一个行内节点，高100%，宽1px，margin-right: -1px，消除1px的占用 容器所有子节点都需要设置vertical-align: middle 容器通常情况下字体大小不为0，代码的换行符会占用一个字符的位置，此处应将容器字体大小设为0，内容节点中重新设置字体大小 */ .center { text-align: center; font-size: 0; } .center::before { content: \"\"; display: inline-block; height: 100%; width: 1px; margin-right: -1px; vertical-align: middle; } .center span { font-size: 16px; vertical-align: middle; } /* 4、flex水平垂直居中，&#x1F525;推荐使用 */ /* 设为 Flex 布局以后，子元素的float、clear和vertical-align属性将失效 */ .center { display: flex; justify-content: center; align-items: center; } /* 5、grid水平垂直居中 */ /* 注意兼容性要求浏览器版本较高 */ .center { display: grid; justify-content: center; align-items: center; } /* 6、table-cell水平垂直居中 */ /* 父容器宽度默认内容宽度 当display: table时，padding失效 当display: table-row时，margin、padding失效 当display: table-cell时，margin失效 */ .center { display: table; width: 100%; } .center span { display: table-cell; vertical-align: middle; text-align: center; } 文本超出省略号 /** * 单行文本 * 注意：固定宽度 */ .text { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; } /** * 多行文本 * 注意：固定宽度，容器padding属性会导致文本无法隐藏 */ .text { overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 2; } 渐变色 线性渐变 径向渐变 圆锥渐变 /** * 线性就变 * background-image: linear-gradient(direction, color-stop1, color-stop2, ...); * * direction（可不写，默认：to bottom（从上到下））：渐变方向、角度 * 渐变方向：to right（从左到右），to bottom right（从左上角到右下角） * 角度：0deg 将创建一个从下到上的渐变，90deg 将创建一个从左到右的渐变 * * repeating-linear-gradient：重复渐变 */ .box { background-color: red; /* 浏览器不支持的时候显示 */ background-image: linear-gradient(to right, red, yellow, green); } .box { background-color: red; /* 浏览器不支持的时候显示 */ background-image: repeating-linear-gradient(red, yellow 10%, green 20%); } /** * 径向渐变 * background-image: radial-gradient(shape size at position, start-color, ..., last-color); * * shape size at position：（可不写，默认：渐变的中心是 center（表示在中心点），渐变的形状是 ellipse（表示椭圆形），渐变的大小是 farthest-corner（表示到最远的角落）） * shape：circle 表示圆形，ellipse 表示椭圆形（默认） * size： * closest-side：指定径向渐变的半径长度为从圆心到离圆心最近的边 * closest-corner：指定径向渐变的半径长度为从圆心到离圆心最近的角 * farthest-side：指定径向渐变的半径长度为从圆心到离圆心最远的边 * farthest-corner：指定径向渐变的半径长度为从圆心到离圆心最远的角 * * repeating-radial-gradient：重复渐变 */ .box { background-color: red; /* 浏览器不支持的时候显示 */ background-image: radial-gradient(red, green); } .box { background-color: red; /* 浏览器不支持的时候显示 */ background-image: repeating-radial-gradient(red, yellow 10%, green 15%); } /** * 圆锥渐变 * background-image: conic-gradient(from at , color-stop1, color-stop2, ...); * from at ：（可不写，默认：from 0deg at center） * * repeating-conic-gradient：重复渐变 */ .box { background-color: red; /* 浏览器不支持的时候显示 */ background-image: conic-gradient(from 45deg at 20% 40%, red, orange, yellow, green, blue, purple, red); } .box { background-color: red; /* 浏览器不支持的时候显示 */ background-image: repeating-conic-gradient(#fff 0 9deg, #000 9deg 18deg); } div+css绘制六边形 .corner { width: 0; height: 0; border-right: 20px solid #EEE; border-top: 20px solid red; border-bottom: 20px solid #CCC; border-left: 20px solid #EEE; } .hexagon { width: 40px; height: 64px; background-color: purple; position: relative; font-size: 14px; color: #FFF; border-radius: 0; border: 0; } .hexagon:before { content: ''; width: 0; height: 0; position: absolute; top: 0; left: -20px; border-right: 20px solid purple; border-top: 32px solid transparent; border-bottom: 32px solid transparent; } .hexagon:after { content: ''; width: 0; height: 0; position: absolute; top: 0; right: -20px; border-left: 20px solid purple; border-top: 32px solid transparent; border-bottom: 32px solid transparent; } /** * 关键点：使用border绘制三角形 * 箭头向上的三角形：border-bottom：颜色，border-left：透明色，border-right：透明色 * 箭头向右的三角形：border-left：颜色，border-top：透明色，border-bottom：透明色 * 箭头向下的三角形：border-top：颜色，border-left：透明色，border-right：透明色 * 箭头向左的三角形：border-right：颜色，border-top：透明色，border-bottom：透明色 */ .hexagon { width: 40px; height: 64px; background-color: purple; position: relative; font-size: 14px; color: #FFF; border-radius: 0; border: 0; } .hexagon:before { content: ''; width: 0; height: 0; position: absolute; top: 0; left: -20px; border-right: 20px solid purple; border-top: 32px solid transparent; border-bottom: 32px solid transparent; } .hexagon:after { content: ''; width: 0; height: 0; position: absolute; top: 0; right: -20px; border-left: 20px solid purple; border-top: 32px solid transparent; border-bottom: 32px solid transparent; } div+css实现四角边框 .qrcode-box1 { display: inline-block; border: 1px solid #3295D1; box-sizing: border-box; padding: 10px; width: 160px; height: 160px; background: linear-gradient(#3295D1, #3295D1) -155px -128px no-repeat, linear-gradient(#3295D1, #3295D1) -128px -155px no-repeat, linear-gradient(#3295D1, #3295D1) 128px -155px no-repeat, linear-gradient(#3295D1, #3295D1) 155px -128px no-repeat, linear-gradient(#3295D1, #3295D1) -155px 128px no-repeat, linear-gradient(#3295D1, #3295D1) -128px 155px no-repeat, linear-gradient(#3295D1, #3295D1) 128px 155px no-repeat, linear-gradient(#3295D1, #3295D1) 155px 128px no-repeat; } 方式一：通过:before :after伪类实现（也可使用4个div实现）原包裹div实现顶部两个角，增加一个div实现底部两个角，确保新增加div与原包裹div重合优点：可以根据图片大小自适应，易于理解；缺点：实现复杂，dom多、代码多 --> .qrcode-box { display: inline-block; border: 1px solid #3295D1; box-sizing: border-box; padding: 10px; position: relative; } .qrcode-box .qrcode-box-background { position: absolute; top: 0; right: 0; bottom: 0; left: 0; } .qrcode-box::before, .qrcode-box::after, .qrcode-box .qrcode-box-background::before, .qrcode-box .qrcode-box-background::after { content: \"\"; display: block; position: absolute; width: 30px; height: 30px; } .qrcode-box::before { top: 0; left: 0; border-top: 3px solid #3295D1; border-left: 3px solid #3295D1; } .qrcode-box::after { top: 0; right: 0; border-top: 3px solid #3295D1; border-right: 3px solid #3295D1; } .qrcode-box .qrcode-box-background::before { bottom: 0; left: 0; border-bottom: 3px solid #3295D1; border-left: 3px solid #3295D1; } .qrcode-box .qrcode-box-background::after { bottom: 0; right: 0; border-bottom: 3px solid #3295D1; border-right: 3px solid #3295D1; } 方式二：通过在background中使用8个linear-gradient渐变色，并将每个背景色偏移出div范围实现优点：dom少，代码少；缺点：固定宽高，计算位置复杂，不易理解注意：偏移量计算方式，内部img需限制宽高 --> .qrcode-box { display: inline-block; border: 1px solid #3295D1; box-sizing: border-box; padding: 10px; width: 160px; height: 160px; /* * 边角宽3px，高30px，偏移量计算方式 * box宽（160px）- border（1px）- 1px - 边角宽3px = 155px * box宽（160px）- border（1px）- 1px - 边角高30px = 128px */ background: linear-gradient(#3295D1, #3295D1) -155px -128px no-repeat, linear-gradient(#3295D1, #3295D1) -128px -155px no-repeat, linear-gradient(#3295D1, #3295D1) 128px -155px no-repeat, linear-gradient(#3295D1, #3295D1) 155px -128px no-repeat, linear-gradient(#3295D1, #3295D1) -155px 128px no-repeat, linear-gradient(#3295D1, #3295D1) -128px 155px no-repeat, linear-gradient(#3295D1, #3295D1) 128px 155px no-repeat, linear-gradient(#3295D1, #3295D1) 155px 128px no-repeat; } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2021-01-13 "},"frontend/vw.html":{"url":"frontend/vw.html","title":"移动端vw适配方案","keywords":"","body":"移动端vw适配方案 如果使用 create-react-app创建项目 可参照参照该文最后章节 该文测试所使用postcss版本为7.0.x注意PostCSS插件等依赖与postcss的版本匹配，否则会报错使用时也可根据报错信息调整各依赖版本 1、安装PostCSS插件 相关依赖 postcss-import 解决@import引入路径问题 postcss-url 用来处理文件，比如图片文件、字体文件等引用路径的处理 autoprefixer 自动处理浏览器前缀，一般脚手架会自带 # 安装依赖 yarn add postcss-import postcss-url autoprefixer -D /* 当前依赖版本 */ { \"devDependencies\": { \"autoprefixer\": \"^9.7.6\", \"postcss-import\": \"^12.0.1\", \"postcss-url\": \"^8.0.0\" } } 配置PostCSS，项目根目录.postcssrc.js文件 module.exports = { plugins: { autoprefixer: {}, 'postcss-import': {}, 'postcss-url': {} } } 2、其他插件 相关依赖 postcss-aspect-ratio-mini 处理元素容器宽高比 postcss-px-to-viewport 把px单位转换为vw、vh、vmin或者vmax这样的视窗单位，也是vw适配方案的核心插件之一 postcss-write-svg 处理移动端1px的解决方案 postcss-preset-env cssnext，使用CSS未来的特性 cssnano 压缩和清理CSS代码 cssnano-preset-advanced cssnano依赖，preset: 'advanced' postcss-viewport-units 给CSS的属性添加content的属性，配合viewport-units-buggyfill库给vw、vh、vmin和vmax做适配的操作 # 安装依赖 yarn add postcss-aspect-ratio-mini postcss-px-to-viewport postcss-write-svg postcss-preset-env cssnano cssnano-preset-advanced postcss-viewport-units -D /* 当前依赖版本 */ { \"devDependencies\": { \"cssnano\": \"^4.1.10\", \"cssnano-preset-advanced\": \"^4.0.7\", \"postcss-aspect-ratio-mini\": \"^1.0.1\", \"postcss-preset-env\": \"^6.7.0\", \"postcss-px-to-viewport\": \"^1.1.1\", \"postcss-viewport-units\": \"^0.1.6\", \"postcss-write-svg\": \"^3.0.1\" } } 增加PostCSS配置，项目根目录.postcssrc.js文件，以下为完整配置 module.exports = { plugins: { 'postcss-import': {}, 'postcss-url': {}, 'postcss-aspect-ratio-mini': {}, 'postcss-write-svg': { utf8: false // 使用base64编码 }, 'postcss-preset-env': { stage: 4 // 稳定阶段 }, 'postcss-px-to-viewport': { viewportWidth: 750, // (Number) 视窗的宽度，对应的是我们设计稿的宽度，一般是750 viewportHeight: 1334, // (Number) 视窗的高度，根据750设备的宽度来指定，一般指定1334，也可以不配置 unitPrecision: 3, // (Number) 指定`px`转换为视窗单位值的小数位数（很多时候无法整除） viewportUnit: 'vw', // (String) 指定需要转换成的视窗单位，建议使用vw selectorBlackList: ['.ignore', '.hairlines', '.markdown'], // (Array) 指定不转换为视窗单位的类，可以自定义，可以无限添加，建议定义一至两个通用的类名，注意：第三方UI库也要在此添加 minPixelValue: 1, // (Number) 小于或等于`1px`不转换为视窗单位，你也可以设置为你想要的值 mediaQuery: false // (Boolean) 允许在媒体查询中转换`px` }, 'postcss-viewport-units': { filterRule: rule => rule.nodes.findIndex(i => i.prop === 'content') === -1 // 过滤伪类content使用 }, 'cssnano': { 'cssnano-preset-advanced': { zindex: false, // 防止z-index的值重置为1 autoprefixer: false // 有重复调用，关闭 } } } } 关于兼容第三方UI库 const path = require('path') module.exports = ({ file }) => { // 解决UI框架与设计稿尺寸不一致的问题，如：vant有赞移动端web UI框架 //const designWidth = file.dirname.includes(path.join('node_modules', 'vant')) ? 375 : 750 // 默认设计稿宽度750 const designWidth = 750 return { plugins: { // ··· ··· 其他配置 'postcss-px-to-viewport': { viewportWidth: designWidth, // (Number) 视窗的宽度，对应的是我们设计稿的宽度，一般是750 viewportHeight: 1334, // (Number) 视窗的高度，根据750设备的宽度来指定，一般指定1334，也可以不配置 unitPrecision: 3, // (Number) 指定`px`转换为视窗单位值的小数位数（很多时候无法整除） viewportUnit: 'vw', // (String) 指定需要转换成的视窗单位，建议使用vw selectorBlackList: ['.ignore', '.hairlines', '.markdown'], // (Array) 指定不转换为视窗单位的类，可以自定义，可以无限添加，建议定义一至两个通用的类名，注意：第三方UI库也要在此添加 minPixelValue: 1, // (Number) 小于或等于`1px`不转换为视窗单位，你也可以设置为你想要的值 mediaQuery: false // (Boolean) 允许在媒体查询中转换`px` }, // ··· ··· 其他配置 } } } 注意：由于cssnext和cssnano都具有autoprefixer，事实上只需要一个，所以把默认的autoprefixer删除掉，然后把cssnano中的autoprefixer设置为false 3、index.html配置 修改meta viewport 增加viewport-units-buggyfill、fastclick配置在index.html中加入注意：fastclick可能引起一些点击问题，参照 FastClick 填坑及源码解析 if ('addEventListener' in document) { document.addEventListener('DOMContentLoaded', function () { FastClick.attach(document.body) }, false) } if (!window.Promise) { document.writeln('' + '') } window.onload = function () { window.viewportUnitsBuggyfill.init({ hacks: window.viewportUnitsBuggyfillHacks }) } 4、部分功能使用介绍 （1）postcss-aspect-ratio-mini 宽高比容器 使用 [aspectratio] { position: relative; } [aspectratio]:before { content: ''; display: block; width: 1px; margin-left: -1px; height: 0; } [aspectratio-content] { position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; } [w-188-246] { width: 188px; background-color: red; } [w-188-246] { aspect-ratio: '188:246'; } 编译后代码css [aspectratio] { position: relative; } [w-188-246] { width: 188px; background-color: red; } [w-188-246]:before { padding-top: 130.85106382978725%; } [aspectratio]:before { content: \"\"; display: block; width: 1px; margin-left: -1px; height: 0; } [aspectratio-content] { position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; } （2）postcss-write-svg 在retina屏绘制1px细线 使用 /* 注意：stylus 里面这样搞无效，less、scss可能会有warning，可以使用 */ @svg 1px-border { width: 4px; height: 4px; @rect { fill: transparent; width: 100%; height: 100%; stroke-width: 25%; stroke: var(--color, black); } } .hairlines { border: 0; border-top: 1px solid; border-image: svg(1px-border param(--color red)) 1 stretch; } 编译后代码css .hairlines { margin-bottom: 20px; border: 0; border-top: 1px solid; -o-border-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zd…IgaGVpZ2h0PSIxMDAlIiBzdHJva2Utd2lkdGg9IjI1JSIgc3Ryb2tlPSJyZWQiLz48L3N2Zz4=) 1 stretch; border-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zd…IgaGVpZ2h0PSIxMDAlIiBzdHJva2Utd2lkdGg9IjI1JSIgc3Ryb2tlPSJyZWQiLz48L3N2Zz4=) 1 stretch; } retina屏下放大效果对比展示，蓝色线class=\"line\"为未使用postcss-write-svg .line { border-top: 1px solid #00b1ff; } 在 create-react-app 中使用 create-react-app使用 可参照 1、依赖 参数文章开头 1、2 安装相关依赖 2、配置 在config-overrides.js文件中添加以下配置 const { // ··· ··· 其他方法引入 addPostcssPlugins // ··· ··· 其他方法引入 } = require('customize-cra') // postcss vw plugins const postCssPlugins = [ require('postcss-import'), require('postcss-url'), require('postcss-aspect-ratio-mini'), require('postcss-write-svg')({ utf8: false }), require('postcss-preset-env')({ stage: 4 // 稳定阶段 }), require('postcss-px-to-viewport')({ viewportWidth: 750, // (Number) 视窗的宽度，对应的是我们设计稿的宽度，一般是750 viewportHeight: 1334, // (Number) 视窗的高度，根据750设备的宽度来指定，一般指定1334，也可以不配置 unitPrecision: 3, // (Number) 指定`px`转换为视窗单位值的小数位数（很多时候无法整除） viewportUnit: 'vw', // (String) 指定需要转换成的视窗单位，建议使用vw selectorBlackList: ['.ignore', '.hairlines', '.markdown'], // (Array) 指定不转换为视窗单位的类，可以自定义，可以无限添加，建议定义一至两个通用的类名，注意：第三方UI库也要在此添加 minPixelValue: 1, // (Number) 小于或等于`1px`不转换为视窗单位，你也可以设置为你想要的值 mediaQuery: false // (Boolean) 允许在媒体查询中转换`px` }), require('postcss-viewport-units')({ filterRule: rule => rule.nodes.findIndex(i => i.prop === 'content') === -1 // 过滤伪类content使用 }), require('cssnano')({ 'cssnano-preset-advanced': { zindex: false, // 防止z-index的值重置为1 autoprefixer: false // 有重复调用，关闭 } }) ] /** * 修改默认配置 */ module.exports = function (config, env) { // ··· ··· 其他配置 // 添加postcss插件 addPostcssPlugins(postCssPlugins)(config) // ··· ··· 其他配置 // 返回config return config } 3、注意 react中不能使用空的自定义属性（如：），如需自定义属性样式，正确的使用方法如下 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-12-02 "},"frontend/vuejs.html":{"url":"frontend/vuejs.html","title":"Vue.js","keywords":"","body":"Vue.js 父子组件生命周期顺序 /* 加载渲染过程 */ parent beforeCreate ↓ parent created ↓ parent beforeMount ↓ child beforeCreate ↓ child created ↓ child beforeMount ↓ child mounted ↓ parent mounted /* 更新过程 */ // 子组件更新 child beforeUpdate ↓ child updated // 子组件影响父组件（$emit）、父组件影响子组件（props） parent beforeUpdate ↓ child beforeUpdate ↓ child updated ↓ parent updated // 父组件更新 parent beforeUpdate ↓ parent updated /* 销毁过程 */ parent beforeDestroy ↓ child beforeDestroy ↓ child destroyed ↓ parent destroyed © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"frontend/cra.html":{"url":"frontend/cra.html","title":"Create React App","keywords":"","body":"Create React App 创建项目 TypeScript模版增加配置请查看 # 默认创建项目 yarn create react-app # 使用typescript创建项目 yarn create react-app --template typescript 优化package.json 将原来的dependencies、scripts改为以下 { \"scripts\": { \"dev\": \"react-scripts start\", \"build\": \"react-scripts build\", \"test\": \"react-scripts test\", \"eject\": \"react-scripts eject\" }, \"dependencies\": { \"react\": \"^16.13.1\", \"react-dom\": \"^16.13.1\" }, \"devDependencies\": { \"@testing-library/jest-dom\": \"^4.2.4\", \"@testing-library/react\": \"^9.3.2\", \"@testing-library/user-event\": \"^7.1.2\", \"react-scripts\": \"3.4.1\" } } 跨域代理 在package.json中添加 { \"proxy\": \"http://192.168.0.11\" } 环境变量配置 开发环境，项目根目录创建.env.development文件 # 运行时不自动在浏览器中打开 BROWSER=none # 修改端口 PORT=8009 生产环境，项目根目录创建.env.production文件 # 打包后子路径，/ 为默认根目录，如需修改为 /app/xxx，则 PUBLIC_URL=/app PUBLIC_URL=/app # 打包不生成sourcemap GENERATE_SOURCEMAP=false 常用依赖 axios 基于Promise的HTTP客户端，用于浏览器和node.js qs 查询字符串解析和字符串化库 mobx 状态管理 mobx-react mobx在react使用支持 prop-types 检查 react props，TypeScript模版不需要 react-router-dom 路由，会自动添加react-router依赖 @types/react-router-dom 路由类型定义（TypeScript模版），会自动添加@types/react-router依赖 react-app-rewired 在不eject也不创建额外react-scripts的情况下修改create-react-app内置的webpack配置 （1）安装依赖 相关依赖 react-app-rewired 修改create-react-app内置的webpack配置 customize-cra 提供了一些实用程序，通过react-app-rewired来自定义配置create-react-app核心功能 eslint js校验 eslint-config-standard eslint的standard校验规则 eslint-plugin-import eslint插件 eslint-plugin-node eslint插件 eslint-plugin-promise eslint插件 eslint-plugin-standard eslint插件 node-sass scss支持，自带scss配置，默认支持scss module react-hot-loader 热加载 @hot-loader/react-dom hot loader支持hooks，安装时需与react版本一致 # 安装依赖 yarn add react-app-rewired customize-cra -D # eslint yarn add eslint eslint-config-standard eslint-plugin-import eslint-plugin-node eslint-plugin-promise eslint-plugin-standard -D # scss yarn add node-sass -D # 热加载依赖 yarn add react-hot-loader @hot-loader/react-dom -D /* 当前依赖版本 */ { \"devDependencies\": { \"@hot-loader/react-dom\": \"^16.13.0\", \"customize-cra\": \"^0.9.1\", \"eslint\": \"^6.8.0\", \"eslint-config-standard\": \"^14.1.1\", \"eslint-plugin-import\": \"^2.20.2\", \"eslint-plugin-node\": \"^11.1.0\", \"eslint-plugin-promise\": \"^4.2.1\", \"eslint-plugin-standard\": \"^4.0.1\", \"node-sass\": \"^4.13.1\", \"react-app-rewired\": \"^2.1.5\", \"react-hot-loader\": \"^4.12.20\" } } （2）配置 项目根目录创建config-overrides.js文件，配置为以下 const path = require('path') const { addBabelPlugin, addDecoratorsLegacy, addWebpackAlias, useEslintRc } = require('customize-cra') const resolve = dir => path.resolve(__dirname, 'src', dir) // hot-loader配置 const rewireHotLoader = (config, env) => { if (env === 'production') { return config } // Find a rule which contains eslint-loader const condition = u => typeof u === 'object' && u.loader && u.loader.includes('eslint-loader') const rule = config.module.rules.find(rule => rule.use && rule.use.some(condition)) if (rule) { const use = rule.use.find(condition) if (use) { // Inject the option for eslint-loader use.options.emitWarning = true } } // If in development, add 'react-hot-loader/babel' to babel plugins. return addBabelPlugin('react-hot-loader/babel')(config) } // 别名 const alias = env => Object.assign(env === 'production' ? {} : { 'react-dom': '@hot-loader/react-dom' }, { '@src': resolve(''), '@api': resolve('api'), '@store': resolve('store'), '@routes': resolve('routes'), '@pages': resolve('pages'), '@layouts': resolve('layouts'), '@components': resolve('components'), '@styles': resolve('assets/styles'), '@images': resolve('assets/images') }) /** * 修改默认配置 */ module.exports = function (config, env) { // 开发模式使用react-hot-loader rewireHotLoader(config, env) // 使用自定义.eslintrc useEslintRc('./.eslintrc')(config) // 装饰器，主要用于mobx addDecoratorsLegacy()(config) // 别名 addWebpackAlias(alias(env))(config) // 返回config return config } 修改package.json文件中scripts为以下 { \"scripts\": { \"dev\": \"react-app-rewired start\", \"build\": \"react-app-rewired build\", \"test\": \"react-app-rewired test\", \"eject\": \"react-scripts eject\" } } ESLint配置 删除package.json文件中eslintConfig根目录创建.eslintrc文件，配置eslint，当前使用standard校验规则注意：需要与相关开发工具设置配合 { \"extends\": [ \"standard\", \"plugin:react/recommended\" ], \"env\": { \"browser\": true, \"commonjs\": true, \"node\": true, \"es6\": true }, \"parser\": \"babel-eslint\", \"parserOptions\": { \"ecmaVersion\": 7, \"sourceType\": \"module\", \"ecmaFeatures\": { \"jsx\": true, \"legacyDecorators\": true } }, \"settings\": { \"react\": { \"version\": \"detect\" } }, \"plugins\": [ \"react\" ], \"rules\": { \"arrow-parens\": [ \"error\", \"as-needed\" ], \"object-curly-spacing\": [ 1, \"always\" ] } } 部分组件使用 scss、scss module使用 创建style.scss文件，直接在需要的页面或者组件中引入即可 import './style.scss' 创建style.module.scss文件，直接在需要的组件中引入，然后className引用里面的样式即可 import styles from './style.module.scss' 输出样式 .___ { } react-hot-loader使用 相关配置参照上方的配置说明，配置主要针对开发模式（1）react-hot-loader/babel（2）webpack配置别名'react-dom': '@hot-loader/react-dom'支持hooks import { hot } from 'react-hot-loader/root' // 处理入口文件引入的 App 组件，开发模式需要使用 react-hot-loader 处理 const AppComponent = process.env.NODE_ENV === 'development' ? hot(App) : App ReactDOM.render( , document.getElementById('root') ) TypeScript模版增加配置 eslint 此处eslint有版本要求 eslint-plugin-react eslint react组件 @typescript-eslint/parser typescript eslint解析器 @typescript-eslint/eslint-plugin typescript eslint插件 # 安装依赖 yarn add @typescript-eslint/parser @typescript-eslint/eslint-plugin eslint-plugin-react -D # 此处eslint版本要求^6.6.0，版本不符会提示安装eslint@^6.6.0，后续版本可根据相关提示安装对应版本的eslint yarn add eslint@^6.6.0 -D /* 当前依赖版本 */ { \"devDependencies\": { \"@typescript-eslint/eslint-plugin\": \"^2.31.0\", \"@typescript-eslint/parser\": \"^2.31.0\", \"eslint\": \"^6.6.0\", \"eslint-plugin-react\": \"^7.19.0\" } } 增加.eslintignore，添加以下内容 config-overrides.js node_modules .eslintrc修改为以下@typescript-eslint/explicit-function-return-type：强制函数返回类型有声明，关闭@typescript-eslint/no-non-null-assertion：非空断言，关闭 { \"extends\": [ \"standard\", \"plugin:react/recommended\", \"plugin:@typescript-eslint/recommended\" ], \"env\": { \"browser\": true, \"commonjs\": true, \"node\": true, \"es6\": true }, \"parser\": \"@typescript-eslint/parser\", \"parserOptions\": { \"ecmaVersion\": 7, \"sourceType\": \"module\", \"ecmaFeatures\": { \"jsx\": true, \"legacyDecorators\": true } }, \"settings\": { \"react\": { \"version\": \"detect\" } }, \"plugins\": [ \"@typescript-eslint\", \"react\" ], \"rules\": { \"arrow-parens\": [ \"error\", \"as-needed\" ], \"object-curly-spacing\": [ 1, \"always\" ], \"@typescript-eslint/explicit-function-return-type\": [ \"off\" ], \"@typescript-eslint/no-non-null-assertion\": [ \"off\" ] } } 根目录创建paths.json增加别名（paths） { \"compilerOptions\": { \"baseUrl\": \"./\", \"paths\": { \"@/*\": [ \"src/*\" ] } } } 继承paths.json，识别定义别名paths直接写在tsconfig.json，项目启动会被重置装饰器（experimentalDecorators）支持tsconfig.json添加以下属性 { \"extends\": \"./paths.json\", \"compilerOptions\": { ··· \"experimentalDecorators\": true, ··· } ··· } 部分代码示例 // test.tsx，test组件 import React, { Component } from 'react' import { inject, observer } from 'mobx-react' interface Props { // mobx给count赋值，引用组件不用给count传值 count?: { num: number; add: Function; }; } @inject('count') @observer // 如果包含state，则需定义interface State，Component export default class Test extends Component { render () { // 使用非空断言（mobx一定会给count赋值） const { num, add } = this.props.count! return ( num -- {num} add()}>add ) } } // ---------------------------------------------------------- // App.tsx，App页面，使用test组件 import React, { Component } from 'react' import Test from '@/test' interface StateType { name: string; } export default class App extends Component { // 如果Props为{}，可不定义interface，直接Component，此时constructor (props: {}) {} constructor (props: {}) { super(props) // 定义state this.state = { name: 'name' } } render () { return ( {/* test组件可不传值 */} ) } } 相关问题 // eslint warning // Warning: React version not specified in eslint-plugin-react settings. // 在.eslintrc中添加以下内容，指定react版本即可 \"settings\": { \"react\": { \"version\": \"detect\" } } # 控制台警告 React-Hot-Loader: react-&#x1F525;-dom patch is not detected. React 16.6+ features may not work. # 同时配置了 react-hot-loader、@hot-loader/react-dom 不会出现该警告 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"frontend/vue-cli.html":{"url":"frontend/vue-cli.html","title":"Vue Cli","keywords":"","body":"Vue Cli 根据提示完成初始化项目后可以使用vue ui命令使用GUI界面管理项目默认配置可以满足绝大多数项目，非常方便如需进一步了解可参考vue-cli官方文档 配置 在项目根目录下添加vue.config.js文件，内容如下webpack-chain配置文档说明 const path = require('path') const resolve = dir => path.join(__dirname, dir) // 项目部署基础 // 默认情况下，我们假设你的应用将被部署在域的根目录下, // 例如：https://www.my-app.com/ // 默认：'/' // 如果您的应用程序部署在子路径中，则需要在这指定子路径 // 例如：https://www.foobar.com/my-app/ // 需要将它改为'/my-app/' const BASE_URL = process.env.NODE_ENV === 'production' ? '/' : '/' module.exports = { // Project deployment base // By default we assume your app will be deployed at the root of a domain, // e.g. https://www.my-app.com/ // If your app is deployed at a sub-path, you will need to specify that // sub-path here. For example, if your app is deployed at // https://www.foobar.com/my-app/ // then change this to '/my-app/' publicPath: BASE_URL, // tweak internal webpack configuration. // see https://github.com/vuejs/vue-cli/blob/dev/docs/webpack.md // 如果你不需要使用eslint，把lintOnSave设为false即可 lintOnSave: true, // 修改webpack配置 chainWebpack: config => { // 移除 prefetch 插件 config.plugins.delete('prefetch') // 别名 config.resolve.alias .set('@', resolve('src')) // key, value自行定义，比如.set('@@', resolve('src/components')) .set('_c', resolve('src/components')) }, // 设为false打包时不生成.map文件 productionSourceMap: false, // 这里写你调用接口的基础路径，来解决跨域，如果设置了代理，那你本地开发环境的axios的baseUrl要写为 '' ，即空字符串 devServer: { open: false, // 端口 port: 8009, // 跨域 proxy: { '/api/': { target: 'http://127.0.0.1:8008/', changeOrigin: true } } } } Eslint 在项目根目录下修改.eslintrc.js文件，内容如下 module.exports = { root: true, parserOptions: { parser: 'babel-eslint' }, env: { node: true }, extends: [ 'plugin:vue/essential', '@vue/standard' ], rules: { 'no-console': process.env.NODE_ENV === 'production' ? 'warn' : 'off', 'no-debugger': process.env.NODE_ENV === 'production' ? 'warn' : 'off', // 允许obj['key']的使用 'dot-notation': 'off', // 允许object key一个字符事使用引号 'quote-props': 'off' } } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"frontend/js-utils.html":{"url":"frontend/js-utils.html","title":"Js Utils","keywords":"","body":"JS 常用工具方法 日期格式化时间转换为xx时间前顺序执行Promise隐藏手机号中间四位限制数据框内容仅为数字七牛上传滚动条滚动动画base64转filebase64转blobblob转file绑定事件解绑事件连字符转驼峰驼峰转连字符文件尺寸格式化获取指定范围内的随机数打乱数组获取Url参数切分数组两数组差集深拷贝Object合并四舍五入到指定小数位 类型判断 // 以下为更精确的判断方式，某些场景下比使用 typeof & instanceof 更高效、准确 // 判断变量是注意非undefined，toString.call(person) // person is not defined toString.call(() => {}) // [object Function] toString.call({}) // [object Object] toString.call([]) // [object Array] toString.call('str') // [object String] toString.call(123) // [object Number] toString.call(undefined) // [object undefined] toString.call(null) // [object null] toString.call(new Date()) // [object Date] toString.call(Math) // [object Math] toString.call(window) // [object Window] toString.call(document) // [object HTMLDocument] toString.call(Symbol()) // [object Symbol] 日期格式化 /** * @description 日期格式化 * @description dateFormat(new Date(), 'yyyy-MM-dd EEE HH:mm:ss') // 2020-01-02 星期四 12:12:12 * @description dateFormat(new Date(), 'yyyy-MM-dd EE HH:mm:ss') // 2020-01-02 周四 12:12:12 * * @param {Date|String|Number} date 日期 * @param {String} fmt 格式 * @returns {String} 如：2020-01-02 12:12:12 */ export const dateFormat = (date, fmt = 'yyyy-MM-dd HH:mm:ss') => { if (!date) return '' // 不为Date类型进行处理 if (toString.call(date) !== '[object Date]') { // 判断数字时间戳 if (!isNaN(date)) { // 10位时间戳转13位 date = date + '' if (date.length === 10) { date = +date * 1000 } else if (date.length === 13) { // 字符串时间戳转数字时间戳 date = +date } else { // 时间戳格式错误返回'' return '' } } else if (toString.call(date) === '[object String]') { // ios无法使用yyyy-MM-dd HH:mm:ss转换为Date，需将 - 替换为 / date = date.replace(/-/g, '/') } date = new Date(date) if (isNaN(date)) return '' } const o = { 'M+': date.getMonth() + 1, // 月份 'd+': date.getDate(), // 日 'h+': date.getHours() % 12 === 0 ? 12 : date.getHours() % 12, // 小时 'H+': date.getHours(), // 小时 'm+': date.getMinutes(), // 分 's+': date.getSeconds(), // 秒 'q+': Math.floor((date.getMonth() + 3) / 3), // 季度 'S': date.getMilliseconds() // 毫秒 } // 星期 const week = ['日', '一', '二', '三', '四', '五', '六'] if (/(y+)/.test(fmt)) { fmt = fmt.replace(RegExp.$1, (date.getFullYear() + '').substr(4 - RegExp.$1.length)) } if (/(E+)/.test(fmt)) { fmt = fmt.replace(RegExp.$1, ((RegExp.$1.length > 1) ? (RegExp.$1.length > 2 ? '星期' : '周') : '') + week[+date.getDay()]) } for (const k in o) { if (new RegExp('(' + k + ')').test(fmt)) { fmt = fmt.replace(RegExp.$1, (RegExp.$1.length === 1) ? (o[k]) : (('00' + o[k]).substr(('' + o[k]).length))) } } return fmt } 时间转换为xx时间前 /** * @description 时间转换为xx时间前 * @description getTimeInfo('2020-01-02 12:12:12') // 2月前 * * @param {Date|String|Number} date 时间 * @returns {String} 如：5天前 */ export const getTimeInfo = date => { if (!date) return '' // 不为Date类型进行处理 if (toString.call(date) !== '[object Date]') { // 判断数字时间戳 if (!isNaN(date)) { // 10位时间戳转13位 date = date + '' if (date.length === 10) { date = +date * 1000 } else if (date.length === 13) { // 字符串时间戳转数字时间戳 date = +date } else { // 时间戳格式错误返回'' return '' } } else if (toString.call(date) === '[object String]') { // ios无法使用yyyy-MM-dd HH:mm:ss转换为Date，需将 - 替换为 / date = date.replace(/-/g, '/') } date = new Date(date) if (isNaN(date)) return '' } const now = new Date() const diff = now.getTime() - date.getTime() // 现在的时间-传入的时间 = 相差的时间（单位 = 毫秒） if (diff 顺序执行Promise /** * @description 顺序执行 Promise * * function p1(){return new Promise((n,o)=>{setTimeout(()=>{console.warn(\"测试错误 1\"),o({msg:\"测试错误 1\"})},500)})} // 测试错误 1 * function p2(){return new Promise((n,o)=>{setTimeout(()=>{console.log(\"成功 2\"),n({msg:\"成功 2\"})},600)})} // 成功 2 * function p3(){return new Promise((n,o)=>{setTimeout(()=>{console.warn(\"测试错误 3\"),o({msg:\"测试错误 3\"})},300)})} // 测试错误 3 * function p4(){return new Promise((n,o)=>{setTimeout(()=>{console.log(\"成功 4\"),n({msg:\"成功 4\"})},400)})} // 成功 4 * function p5(){return new Promise((n,o)=>{setTimeout(()=>{console.warn(\"测试错误 5\"),o({msg:\"测试错误 5\"})},200)})} // 测试错误 5 * * const promises = [p1, p2, p3, p4, p5] * * promiseQueue(promises).then(console.log) * // 一次性返回结构数组 * // 0: {msg: \"测试错误 1\"} * // 1: {msg: \"成功 2\"} * // 2: {msg: \"测试错误 3\"} * // 3: {msg: \"成功 4\"} * // 4: {msg: \"测试错误 5\"} * * @param {Array} 返回Promise对象的待执行方法数组 * @returns {Array} 返回Promise对象，通过resolve获取顺序执行的结果（包含reject） */ export const promiseQueue = async promises => { const result = [] for (const promise of promises) { try { result.push(await promise()) } catch (error) { result.push(error) } } return Promise.resolve(result) } 隐藏手机号中间四位 /** * @description 手机号中间四位 * * * @param {String} phone 手机号 * @returns {String} 如：188****8888 */ export const hidePhone = phone => { if (!phone) return '' const arr = phone.split('') arr.splice(3, 4, '****') return arr.join('') } 限制数据框内容仅为数字 /** * @description 限制数据框内容仅为数字 * @description 校验、匹配规则可根据需求自定义，当前为保留正整数字符串 * * 某些情况下input[type=number]、InputNumber不能完全限制输入非数字字符使用 * * 以Element-ui Input为例，num可能为数组表单中的值，所以使用传值修改 * * inputCheck(val, formData)\" /> * * inputCheck (val, formData) { * formData.num = inputFilter(val) * } * * @param {String} val 输入字符 * @returns {String|Number} 过滤后数字字符串（正整数） */ export const inputFilter = val => { if (val) { const valArr = val.match(/[1-9]\\d*/g) if (valArr && valArr.length > 0) { val = valArr[0] } else { val = '' } } return val } /** * 整数，保留2位小数，最大100，最小0.01 * * arrangeValue (e) { * let { value } = e.target * // 此处对0 和 未输入完的小数不作处理 * if (+value === 0 || value.endsWith('.')) { * return * } * value = +inputFilter(value) * e.target.value = value * } */ const inputFilter = val => { if (+val >= 100) return 100 if (+val 0) { val = +valArr[0] } else { val = 1 } } return val } 七牛上传 import * as qiniu from 'qiniu-js' import Cookies from 'js-cookie' import uuid from 'uuid' import $http from '@/libs/request' /** * 七牛上传 * dependencies: { * qiniu-js, * uuid, * js-cookie * } * 图片处理（裁剪大小、缩略图等）https://developer.qiniu.com/dora/manual/3683/img-directions-for-use * * @param file 上传的文件 * @param next 上传中处理（进度条等） * * @param then 上传完成处理 * @param catch 上传错误处理 * * @return Promise */ // 相关参数 const UPTOKEN = '_UPTOKEN_' const REQUEST_URL = '/upload/v1/uptoken' const REGION = qiniu.region.z0 // 上传处理 const uploadHandler = (token, file, next, complete, error) => { // 文件类型 const typeArr = file.type.split('/') // uuid + .文件类型 const fileName = `${uuid()}.${typeArr[1]}` const observable = qiniu.upload(file, fileName, token, {}, { region: REGION }) observable.subscribe({ next ({ total }) { next && next(total) }, error (err) { error && error(err) }, complete (res) { complete && complete(res) } }) } // 获取token，上传 export default (file, next) => { let token = Cookies.get(UPTOKEN) return new Promise((resolve, reject) => { if (!token) { $http.request({ url: REQUEST_URL, method: 'post' }).then(({ code, data }) => { if (code === 1) { const date = new Date() date.setSeconds(date.getSeconds() + 3500) // uptoken失效前缓存 Cookies.set(UPTOKEN, data, { expires: date }) token = data uploadHandler(token, file, next, res => resolve(res), err => reject(err)) } else { reject(new Error('获取uptoken失败')) } }) } else { uploadHandler(token, file, next, res => resolve(res), err => reject(err)) } }) } 滚动条滚动动画 /** * @description 滚动条滚动动画 * @description scrollTo(window, 0, 1000) * * @param {HTMLDOM | window} el 滚动对象 * @param {Number} from 滚动开始位置 * @param {Number} to 滚动结束位置 * @param {Number} duration 间隔时间 * @param {Function} endCallback 动画结束回调 */ export const scrollTo = (el, from, to = 0, duration = 500, endCallback) => { if (!window.requestAnimationFrame) { window.requestAnimationFrame = ( window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame || function (callback) { return window.setTimeout(callback, 1000 / 60) } ) } const difference = Math.abs(from - to) const step = Math.ceil(difference / duration * 50) const scroll = (start, end, step) => { if (start === end) { endCallback && endCallback() return } let d = (start + step > end) ? end : start + step if (start > end) { d = (start - step scroll(d, end, step)) } scroll(from, to, step) } base64转file /** * @description base64转file * * @param {String} dataURL base64 * @param {String} filename 文件名（不带后缀），默认：当前时间戳 * @returns {File} 返回File对象 */ export const dataURLtoFile = (dataURL, filename = Date.now()) => { const arr = dataURL.split(',') const mime = arr[0].match(/:(.*?);/)[1] const typeArr = mime.split('/') if (typeArr && typeArr.length > 1) { filename = `${filename}.${typeArr[1]}` } const bstr = atob(arr[1]) let n = bstr.length const u8arr = new Uint8Array(n) while (n--) { u8arr[n] = bstr.charCodeAt(n) } return new File([u8arr], filename, { type: mime }) } base64转blob /** * @description base64转blob * * @param {String} dataURL base64 * @returns {Blob} 返回Blob对象 */ export const dataURLToBlob = dataURL => { const arr = dataURL.split(',') const mime = arr[0].match(/:(.*?);/)[1] const bstr = atob(arr[1]) let n = bstr.length const u8arr = new Uint8Array(n) while (n--) { u8arr[n] = bstr.charCodeAt(n) } return new Blob([u8arr], { type: mime }) } blob转file /** * @description blob转file * * @param {Blob} blob Blob对象 * @param {String} filename 文件名（不带后缀），默认：当前时间戳 * @returns {File} 返回File对象 */ export const blobToFile = (blob, filename = Date.now()) => { const typeArr = blob.type.split('/') if (typeArr && typeArr.length > 1) { filename = `${filename}.${typeArr[1]}` } return new File([blob], filename, { type: blob.type }) } 绑定事件 /** * @description 绑定事件 eventOn(element, event, handler) * @description eventOn(window, 'scroll', this.scroll) * * @param {HTMLDOM | window} element 绑定对象 * @param {String} event 事件名称，如：scroll * @param {Function} handler 事件方法 */ export const eventOn = (function () { // ssr中使用注意服务端无效 if (typeof window === 'undefined') return if (document.addEventListener) { return function (element, event, handler) { if (element && event && handler) { element.addEventListener(event, handler, false) } } } else { return function (element, event, handler) { if (element && event && handler) { element.attachEvent('on' + event, handler) } } } })() 解绑事件 /** * @description 解绑事件 eventOff(element, event, handler) * @description eventOff(window, 'scroll', this.scroll) * * @param {HTMLDOM | window} element 解绑对象 * @param {String} event 事件名称，如：scroll * @param {Function} handler 事件方法 */ export const eventOff = (function () { // ssr中使用注意服务端无效 if (typeof window === 'undefined') return if (document.removeEventListener) { return function (element, event, handler) { if (element && event) { element.removeEventListener(event, handler, false) } } } else { return function (element, event, handler) { if (element && event) { element.detachEvent('on' + event, handler) } } } })() 连字符转驼峰 /** * @description 连字符转驼峰 * @description toCamelCase('hello_world', '_') // helloWorld * * @param {String} str 连字符字符串 * @param {String} separator 分隔符，默认为'-'，可不传 * @returns {String} 如：helloWorld */ export const toCamelCase = (str = '', separator = '-') => { if (toString.call(str) !== '[object String]') { throw new Error('Argument must be a string') } if (str === '') { return str } const regExp = new RegExp(`\\\\${separator}(\\\\w)`, 'g') return str.replace(regExp, (matched, $1) => $1.toUpperCase()) } 驼峰转连字符 /** * @description 驼峰转连字符 * @description fromCamelCase('helloWorld', '_') // hello_world * * @param {String} str 驼峰字符串 * @param {String} separator 分隔符，默认为'-'，可不传 * @returns {String} 如：hello_world */ export const fromCamelCase = (str = '', separator = '-') => { if (toString.call(str) !== '[object String]') { throw new Error('Argument must be a string') } if (str === '') { return str } return str.replace(/([A-Z])/g, `${separator}$1`).toLowerCase() } 文件尺寸格式化 /** * @description 文件尺寸格式化 * @description formatSize(10240000) // 9.77MB * * @param {String | Number} size 字节数 * @returns {String} 如：9.77MB */ export const formatSize = size => { if (toString.call(size) !== '[object Number]') { throw new Error('Argument(s) is illegal !') } const unitsHash = 'B,KB,MB,GB,TB,PB,EB,ZB,YB'.split(',') let index = 0 while (size > 1024 && index 获取指定范围内的随机数 /** * @description 获取指定范围内的随机数 * @description getRandom(0, 10) // 9 * * @param {Number} min 最小范围，包含 * @param {Number} max 最大范围，包含 * @returns {Number} 如：9 */ export const getRandom = (min = 0, max = 100) => { if (toString.call(min) !== '[object Number]' || toString.call(max) !== '[object Number]') { throw new Error('Argument(s) is illegal !') } if (min > max) { [min, max] = [max, min] } return Math.floor(Math.random() * (max - min + 1) + min) } 打乱数组 /** * @description 打乱数组 * @description arrayShuffle([1, 2, 3]) // [2, 1, 3] * * @param {Array} array 待乱序数组 * @returns {Array} 如：[2, 1, 3] */ export const arrayShuffle = array => { if (!Array.isArray(array)) { throw new Error('Argument must be an array') } let end = array.length if (!end) { return array } while (end) { const start = Math.floor(Math.random() * end--); [array[start], array[end]] = [array[end], array[start]] } return array } 获取Url参数 /** * @description 获取Url参数，注意：获取的参数值均为String类型 * @description getUrlParam('f', 'https://www.baidu.com/s?ie=utf-8&f=8') // '8' * * @param {String} variable 需要获取的参数名，传空值或者null会获取参数Object * @param {String} url url，默认为当前url * @returns {Object | String | Null} 如：variable为空值或null：{ ie: 'utf-8', f: '8' }，未查找到的参数或url无参数返：null，variable有值查询具体参数返回String类型值 */ export const getUrlParam = (variable = '', url = window.location.href) => { if (url === '' || !url.includes('=')) return null const query = url.substr(url.lastIndexOf('?') + 1) const vars = query.split('&') if (!variable) { return vars.reduce((params, v) => { const pair = v.split('=') params[pair[0]] = pair[1] return params }, {}) } for (const v of vars) { const pair = v.split('=') if (pair[0] === variable) return pair[1] } return null } 切分数组 /** * @description 切分数组 * * const arr = [1, 2, 3, 4, 5, 6, 7, 8, 9] * splitArray(arr, 4) // [[1, 2, 3, 4], [5, 6, 7, 8], [9]] * * @param {Array} arr 带切分数组 * @param {Number} size 切分大小 * @returns {Array} 切分后数组 */ export const splitArray = (arr, size = 10) => Array.from({ length: Math.ceil(arr.length / size) }, (v, i) => arr.slice(i * size, i * size + size) ) 两数组差集 /** * @description 切分数组 * * arrayDiffSet([1, 2, 3], [1, 2, 4]) // [3, 4] * * @param {Array} arr1 * @param {Array} arr2 * @returns {Array} 两数组差集数组 */ export const arrayDiffSet = (a, b) => [...a, ...b].filter(x => !a.includes(x) || !b.includes(x)) 深拷贝 /** * @description 深拷贝 * * @param {any} target 需要拷贝目标，任何值 * @param cache 使用WeakSet处理循环引用，默认即可，无需传值 * @returns {any} 新拷贝结果 */ export const deepClone = (target, cache = new WeakSet()) => { const type = typeof target // 拷贝基本类型值 if (!(target !== null && (type === 'object' || type === 'function'))) return target // 如果之前已经拷贝过该对象，直接返回该对象 if (cache.has(target)) return target // 将对象添加缓存 cache.add(target) const arrayTag = '[object Array]' const objectTag = '[object Object]' const mapTag = '[object Map]' const setTag = '[object Set]' const functionTag = '[object Function]' const boolTag = '[object Boolean]' const dateTag = '[object Date]' const numberTag = '[object Number]' const stringTag = '[object String]' const errorTag = '[object Error]' const symbolTag = '[object Symbol]' const regexpTag = '[object RegExp]' const tag = Object.prototype.toString.call(target) const Ctor = target.constructor let cloneTarget switch (tag) { case boolTag: case dateTag: cloneTarget = new Ctor(+target) break case numberTag: case stringTag: case errorTag: cloneTarget = new Ctor(target) break case objectTag: case mapTag: case setTag: cloneTarget = new Ctor() break case arrayTag: { const { length } = target const result = new target.constructor(length) if (length && typeof target[0] === 'string' && Object.hasOwnProperty.call(target, 'index')) { result.index = target.index result.input = target.input } cloneTarget = result } break case symbolTag: cloneTarget = Object(Symbol.prototype.valueOf.call(target)) break case regexpTag: { const result = new target.constructor(target.source, /\\w*$/.exec(target)) result.lastIndex = target.lastIndex cloneTarget = result } break } if (tag === mapTag) { target.forEach((value, key) => { cloneTarget.set(key, deepClone(value, cache)) }) return cloneTarget } if (tag === setTag) { target.forEach(value => { cloneTarget.add(deepClone(value, cache)) }) return cloneTarget } if (tag === functionTag) return target Reflect.ownKeys(target).forEach(key => { // 递归拷贝属性 cloneTarget[key] = deepClone(target[key], cache) }) return cloneTarget } Object合并 /** * @description Object合并 * @description 后面的Object覆盖合并到前面的Object * * @param {Object} target 合并目标对象 * @param {...Object} args 任意个待合并对象 */ export const merge = (target, ...args) => { return args.reduce((acc, cur) => Object.keys(cur).reduce((subAcc, key) => { const srcVal = cur[key] if (Object.prototype.toString.call(srcVal) === '[object Object]') { subAcc[key] = merge(subAcc[key] ? subAcc[key] : {}, srcVal) } else if (Array.isArray(srcVal)) { subAcc[key] = srcVal.map((item, idx) => { if (Object.prototype.toString.call(item) === '[object Object]') { const curAccVal = subAcc[key] ? subAcc[key] : [] return merge(curAccVal[idx] ? curAccVal[idx] : {}, item) } else { return item } }) } else { subAcc[key] = srcVal } return subAcc }, acc), target) } 四舍五入到指定小数位 /** * @description 四舍五入到指定小数位 * * @param {Number} number 待转换数字 * @param {Number} decimals 小数位数 */ export const round = (number, decimals = 0) => Number(`${Math.round(`${number}e${decimals}`)}e-${decimals}`) © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2021-02-05 "},"frontend/regular.html":{"url":"frontend/regular.html","title":"正则表达式","keywords":"","body":"正则表达式 常用正则表达式 // 手机号校验 /^1[3456789]\\d{9}$/ // 邮箱校验 /^\\w+((-\\w+)|(\\.\\w+))*@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z0-9]+$/ // 身份证号校验 /^[1-9]\\d{5}(18|19|20)\\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\\d{3}[0-9Xx]$/ // URL验证 /^(((ht|f)tps?):\\/\\/)?[\\w-]+(\\.[\\w-]+)+([\\w.,@?^=%&:/~+#-]*[\\w@?^=%&/~+#-])?$/ // 非负数 /^[+]?\\d+(\\.\\d+)?$/ // emoji表情验证 /(\\ud83c[\\udf00-\\udfff])|(\\ud83d[\\udc00-\\ude4f\\ude80-\\udeff])|[\\u2600-\\u2B55]/g © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-12-31 "},"frontend/eslint.html":{"url":"frontend/eslint.html","title":"ESLint","keywords":"","body":"ESLint ESLint是一个语法规则和代码风格的检查工具。项目中使用ESLint可以避免一些低级错误、格式错误，统一项目代码风格，更有利于团队协作等。开发工具中需添加ESLint扩展，如：VSCode中ESLint插件。个人更倾向于使用standard规范，以standard规范为例。 create-react-app中使用ESLint create-react-app中使用ESLint，请参照 在Vuejs脚手架vue-cli@2.x.x 3.x.x 4.x.x中使用ESLint /** * 只需在构建项目时根据提示操作即可 */ // 1、构建项目时，Use ESLint to lint your code? Y // 2、Pick an ESLint preset，选择上下箭头选择Standard (https://github.com/standard/standard) 在Nuxtjs脚手架create-nuxt-app@2.x.x中使用ESLint // 1、构建项目时，Choose features to install，上下箭头+空格勾选Linter / Formatter这一项 // 2、去除不必要的依赖 yarn remove @nuxtjs/eslint-config -D // 3、安装依赖 yarn add eslint eslint-config-standard eslint-plugin-import eslint-plugin-node eslint-plugin-promise eslint-plugin-standard -D // 4、修改.eslintrc.js，添加、注释以下内容 module.exports = { ··· extends: [ // '@nuxtjs', ··· 'standard' ], ··· rules: { ··· // allow async-await 'generator-star-spacing': 'off', // allow debugger during development 'no-debugger': process.env.NODE_ENV === 'production' ? 'error' : 'off' } } Taro@1.3.0中使用报错 taro+typescript+mobx新版本会有解决 # 报错信息 54:22 error Parsing error: Unexpected token, expected \";\" 52 | } 53 | 54 | export default Index as ComponentType | ^ 解决方法 # 安装依赖 yarn add @typescript-eslint/eslint-plugin -D // .eslintrc中添加overrides { ··· \"overrides\": [ { \"files\": [\"**/*.ts?(x)\"], \"parser\": \"@typescript-eslint/parser\", \"parserOptions\": { \"ecmaVersion\": 2018, \"sourceType\": \"module\", \"ecmaFeatures\": { \"jsx\": true }, // typescript-eslint specific options \"warnOnUnsupportedTypeScriptVersion\": true }, \"plugins\": [\"@typescript-eslint\"], // If adding a typescript-eslint version of an existing ESLint rule, // make sure to disable the ESLint rule here. \"rules\": { // TypeScript\"s `noFallthroughCasesInSwitch` option is more robust (#6906) \"default-case\": \"off\", // \"tsc\" already handles this (https://github.com/typescript-eslint/typescript-eslint/issues/291) \"no-dupe-class-members\": \"off\", // \"tsc\" already handles this (https://github.com/typescript-eslint/typescript-eslint/issues/477) \"no-undef\": \"off\", // Add TypeScript specific rules (and turn off ESLint equivalents) \"@typescript-eslint/no-angle-bracket-type-assertion\": \"warn\", \"no-array-constructor\": \"off\", \"@typescript-eslint/no-array-constructor\": \"warn\", \"@typescript-eslint/no-namespace\": \"error\", \"no-use-before-define\": \"off\", \"@typescript-eslint/no-use-before-define\": [ \"warn\", { \"functions\": false, \"classes\": false, \"variables\": false, \"typedefs\": false } ], \"no-unused-vars\": \"off\", \"@typescript-eslint/no-unused-vars\": [ \"warn\", { \"args\": \"none\", \"ignoreRestSiblings\": true } ], \"no-useless-constructor\": \"off\", \"@typescript-eslint/no-useless-constructor\": \"warn\" } } ] } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"frontend/less.html":{"url":"frontend/less.html","title":"Less","keywords":"","body":"LESS css预处理语言 相关问题 1、less@3.x.x之后的版本，less中使用javascript报错 升级less到3.x.x的版本之后报错 // https://github.com/ant-design/ant-motion/issues/44 .bezierEasingMixin(); ^ Inline JavaScript is not enabled. Is it set in your options? in D:\\vscode\\iview-admin\\node_modules\\iview\\src\\styles\\color\\bezierEasing.less (line 110, column 0) 解决方法：开启javascript即可 { loader: \"less-loader\", options: { javascriptEnabled: true } } /** * vue-cli@3.x.x中解决方法，vue.config.js文件 */ module.exports = { css: { loaderOptions: { less: { javascriptEnabled: true } } } } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"frontend/canvas.html":{"url":"frontend/canvas.html","title":"Canvas","keywords":"","body":"Canvas Canvas签名 提供原生js版本和vue版本 1、原生JavaScript版本 利用canvas画布实现签名效果 /** * Canvas 签名 * * 使用： * new drawCanvas({ * saveCallback: function (imgBase64, clearCallback) { * document.getElementById('signImage').src = imgBase64 * // 清空canvas * // clearCallback() * } * }) * el：canvas容器id，默认：'canvas' * saveEl：保存按钮id，默认：'saveBtn' * clearEl：清除按钮id，默认：'clearBtn' * width：容器宽度，默认：浏览器宽度 * height：容器高度，默认：200 * color：画线颜色，默认：'#000' * background：容器背景颜色颜色，默认：'rgba(255, 255, 255, 0)' * borderWidth：容器边框宽度，默认：1 * borderColor：容器边框颜色颜色，默认：'#333' * imageType：图片类型，默认：image/png，可选：image/jpeg（注意修改background），image/webp（Chrome支持），其他类型均为image/png * imageQual：图片质量，当imageType为image/jpeg时生效，默认值：0.92，可选0~1之间，超出范围使用默认0.92 * saveCallback(imgBase64, clearCallback)：保存回调(base64图片，清空画布回调) */ function drawCanvas (args) { this.el = 'canvas' this.saveEl = 'saveBtn' this.clearEl = 'clearBtn' this.width = document.documentElement.clientWidth || document.body.clientWidth this.height = 200 this.lineWidth = 2 this.color = '#000' this.background = 'rgba(255, 255, 255, 0)' this.borderWidth = 1 this.borderColor = '#333' this.imageType = 'image/png' this.imageQual = 0.92 this.saveCallback = function (imgBase64, clearCallback) { } for (var k in args) { this[k] = args[k] } // 获取canvas var canvas = document.getElementById(this.el) // 设置边框 if (this.borderWidth > 0 && this.width > this.borderWidth * 2) { this.width = this.width - this.borderWidth * 2 canvas.style.border = this.borderWidth + 'px solid' + this.borderColor } // 设置宽高 canvas.width = this.width canvas.height = this.height // 获取canvas context var cxt = canvas.getContext('2d') // canvas context相关设置 cxt.fillStyle = this.background cxt.fillRect(0, 0, this.width, this.height) cxt.strokeStyle = this.color cxt.lineWidth = this.lineWidth cxt.lineCap = 'round' // 线条末端添加圆形线帽，减少线条的生硬感 cxt.lineJoin = 'round' // 线条交汇时为原型边角 // 利用阴影，消除锯齿 cxt.shadowBlur = 1 cxt.shadowColor = this.color var offsetTop = canvas.offsetTop // canvas上边距 var offsetLeft = canvas.offsetLeft // canvas左边距 var isDraw = false // 是否绘制中，用于mousemove // 开始绘制 canvas.addEventListener('touchstart', function (e) { cxt.beginPath() cxt.moveTo(e.changedTouches[0].pageX - offsetLeft, e.changedTouches[0].pageY - offsetTop) }, false) canvas.addEventListener('mousedown', function (e) { isDraw = true cxt.beginPath() cxt.moveTo(e.pageX - offsetLeft, e.pageY - offsetTop) }, false) // 绘制中 canvas.addEventListener('touchmove', function (e) { e.stopPropagation() e.preventDefault() cxt.lineTo(e.changedTouches[0].pageX - offsetLeft, e.changedTouches[0].pageY - offsetTop) cxt.stroke() }, false) canvas.addEventListener('mousemove', function (e) { if (isDraw) { e.stopPropagation() e.preventDefault() cxt.lineTo(e.pageX - offsetLeft, e.pageY - offsetTop) cxt.stroke() if (e.pageX - offsetLeft = canvas.width - this.borderWidth * 2 || e.pageY - offsetTop = canvas.height - this.borderWidth * 2) { isDraw = false } } }.bind(this), false) // 结束绘制 canvas.addEventListener('touchend', function () { cxt.closePath() }, false) canvas.addEventListener('mouseup', function () { isDraw = false cxt.closePath() }, false) // 清除画布 document.getElementById(this.clearEl) && document.getElementById(this.clearEl).addEventListener('click', function () { cxt.clearRect(0, 0, canvas.width, canvas.height) }, false) // 保存图片 document.getElementById(this.saveEl) && document.getElementById(this.saveEl).addEventListener('click', function () { var imgBase64 if (this.imageType === 'image/jpeg') { imgBase64 = canvas.toDataURL('image/jpeg', this.imageQual) } else { imgBase64 = canvas.toDataURL() } this.saveCallback(imgBase64, function () { cxt.clearRect(0, 0, canvas.width, canvas.height) }) }.bind(this), false) } 使用 生成图片 window.onload = function () { new drawCanvas({ width: 300, height: 200, imageType: 'image/jpeg', imageQual: 0.01, background: '#FFF', saveCallback: function (imgBase64, clearCallback) { document.getElementById('signImage').src = imgBase64 // 清空canvas // clearCallback() } }) } 2、Vue.js版本 vue组件直接使用npm组件yarn add vue-canvas-sign or npm i vue-canvas-sign输出base64图片，如需转为file文件，请参照base64转file borderWidth * 2 ? width - borderWidth * 2 : width\" :height=\"height\" :style=\"borderStyle\" @touchstart=\"touchstart\" @mousedown=\"mousedown\" @touchmove=\"touchmove\" @mousemove=\"mousemove\" @touchend=\"touchend\" @mouseup=\"mouseup\" > export default { name: 'CanvasSign', props: { // 画布宽 width: { type: Number, default: document.documentElement.clientWidth || document.body.clientWidth }, // 画布高 height: { type: Number, default: 200 }, // 画线粗细 lineWidth: { type: Number, default: 2 }, // 画线颜色 color: { type: String, default: '#000' }, // 画布背景色 background: { type: String, default: 'rgba(255, 255, 255, 0)' }, // 边框宽度 borderWidth: { type: Number, default: 1 }, // 边框颜色 borderColor: { type: String, default: '#333' }, // 图片类型，默认：image/png，可选：image/jpeg（注意修改background），image/webp（Chrome支持），其他类型均为image/png imageType: { type: String, default: 'image/png', validator (value) { return ['image/png', 'image/jpeg', 'image/webp'].indexOf(value) !== -1 } }, // 图片质量，当imageType为image/jpeg时生效，默认值：0.92，可选0~1之间，超出范围使用默认0.92 imageQual: { type: Number, default: 0.92, validator (value) { return value = 0 } } }, computed: { borderStyle () { if (this.borderWidth > 0 && this.width > this.borderWidth * 2) { return `border: ${this.borderWidth}px solid ${this.borderColor}` } return '' } }, data () { return { canvas: null, cxt: null, offsetTop: 0, offsetLeft: 0, isDraw: false } }, mounted () { this.$nextTick(this.init) }, methods: { // 生成图片 save (callback) { let imgBase64 if (this.imageType === 'image/jpeg') { imgBase64 = this.canvas.toDataURL('image/jpeg', this.imageQual) } else { imgBase64 = this.canvas.toDataURL(this.imageType) } callback(imgBase64) }, // 清空画布 clear () { this.cxt.clearRect(0, 0, this.canvas.width, this.canvas.height) }, // 初始化 init () { const canvas = this.$refs.canvas this.canvas = canvas this.offsetTop = canvas.offsetTop // canvas上边距 this.offsetLeft = canvas.offsetLeft // canvas左边距 // 获取canvas context const cxt = canvas.getContext('2d') // canvas context相关设置 cxt.fillStyle = this.background cxt.fillRect(0, 0, this.width, this.height) cxt.strokeStyle = this.color cxt.lineWidth = this.lineWidth cxt.lineCap = 'round' // 线条末端添加圆形线帽，减少线条的生硬感 cxt.lineJoin = 'round' // 线条交汇时为原型边角 // 利用阴影，消除锯齿 cxt.shadowBlur = 1 cxt.shadowColor = this.color this.cxt = cxt }, // 移动端触摸摁下 touchstart (e) { this.cxt.beginPath() this.cxt.moveTo(e.changedTouches[0].pageX - this.offsetLeft, e.changedTouches[0].pageY - this.offsetTop) }, // pc端鼠标点下 mousedown (e) { this.isDraw = true this.cxt.beginPath() this.cxt.moveTo(e.pageX - this.offsetLeft, e.pageY - this.offsetTop) }, // 移动端触摸滑动 touchmove (e) { e.stopPropagation() e.preventDefault() this.cxt.lineTo(e.changedTouches[0].pageX - this.offsetLeft, e.changedTouches[0].pageY - this.offsetTop) this.cxt.stroke() }, // pc端鼠标移动 mousemove (e) { e.stopPropagation() e.preventDefault() if (this.isDraw) { this.cxt.lineTo(e.pageX - this.offsetLeft, e.pageY - this.offsetTop) this.cxt.stroke() if (e.pageX - this.offsetLeft = this.canvas.width - this.borderWidth * 2 || e.pageY - this.offsetTop = this.canvas.height - this.borderWidth * 2) { this.isDraw = false } } }, // 移动端触摸抬起 touchend () { this.cxt.closePath() }, // pc端鼠标松开 mouseup () { this.isDraw = false this.cxt.closePath() } } } 使用 save clear save(saveCallback)\">save clear --> save(saveCallback)\">save clear import CanvasSign from '_c/canvas-sign' import { dataURLtoFile } from '../utils' export default { components: { CanvasSign }, data () { return { // 图片src，默认空白base64图片 imgSrc: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=' } }, methods: { // slot中save方法回调 saveCallback (imgBase64) { this.imgSrc = imgBase64 const formData = new FormData() const file = dataURLtoFile(imgBase64, '123.png') formData.append('file', file) fetch('http://192.168.0.125:8008/capital-admin/sign/test', { method: 'POST', body: formData }) }, // 不使用slot的save方法 save () { this.$refs.canvasSign.save(img => { this.imgSrc = img }) }, // 不使用slot的clear方法 clear () { this.$refs.canvasSign.clear() } } } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"frontend/debounce-throttle.html":{"url":"frontend/debounce-throttle.html","title":"防抖节流","keywords":"","body":"函数防抖(debounce)、函数节流(throttle) 函数防抖(debounce) 介绍：当调用动作n毫秒后，才会执行该动作，若在这n毫秒内又调用此动作则将重新计算执行时间场景：实时搜索（keyup）、拖拽（mousemove） /** * 未防抖 * ------------------------- * ^^^^^^^^^^^^^^^^^^^^^^^^^ * 防抖 * ------------------------- * ^ */ // ES6常用实现 const debounce = (fn, delay = 1000) => { let timer = null return () => { timer && clearTimeout(timer) timer = setTimeout(() => { fn && fn() }, delay) } } // 使用 window.onscroll = debounce(() => { console.log(document.documentElement.scrollTop) }, 500) 函数节流(throttle) 介绍：预先设定一个执行周期，当调用动作的时刻大于等于执行周期则执行该动作，然后进入下一个新周期窗口调整（resize）、页面滚动（scroll）、抢购疯狂点击（mousedown） /** * 未节流 * ------------------------- * ^^^^^^^^^^^^^^^^^^^^^^^^^ * 节流 * ------------------------- * ^ ^ ^ ^ ^ ^ ^ */ /** * ES6常用实现（1） -- 基于时间间隔 * 触发第一次，如需触发结束后时间间隔需加else setTimeout */ // 基础版 const throttle = (fn, delay = 100) => { let last = 0 return () => { const now = Date.now() if (now - last >= delay) { fn && fn() last = now } } } // 触发结束后时间间隔 const throttle = (fn, delay = 100) => { let last = 0 let timer = null return () => { const now = Date.now() timer && clearTimeout(timer) if (now - last >= delay) { fn && fn() last = now } else { timer = setTimeout(() => { fn && fn() }, delay) } } } /** * ES6常用实现（2） -- 基于setTimeout * 不会触发第一次 */ const throttle = (fn, delay = 100) => { let timer = null return () => { if (!!timer) { return false } else { timer = setTimeout(() => { fn && fn() clearTimeout(timer) timer = null }, delay) } } } // 使用 window.onscroll = throttle(() => { console.log(document.documentElement.scrollTop) }, 1000) © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"frontend/webpack.html":{"url":"frontend/webpack.html","title":"Webpack","keywords":"","body":"webpack webpack@^4.29.6为例，详细文档可以参考webpack中文文档 依赖 # babel，可以使用新版语法 @babel/core@^7.3.4 babel-loader@^8.0.5 html-webpack-plugin@^3.2.0 # webpack webpack@^4.29.6 # webpack4之前的版本webpack-cli在webpack里面，4开始，单独一个模块 webpack-cli@^3.2.3 # 开发，用于页面自动刷新 webpack-dev-server@^3.2.1 # webpack配置覆盖合并 webpack-merge@^4.2.1 webpack配置文件 const path = require('path') const HTMLWebpackPlugin = require('html-webpack-plugin') // 路径转换 function resolve(dir) { return path.join(__dirname, '.', dir) } // webpack配置 module.exports = { // webpack4必须指定模式 // 会将 process.env.NODE_ENV 的值设为 development。 // 启用 NamedChunksPlugin 和 NamedModulesPlugin mode: 'development', // 会将 process.env.NODE_ENV 的值设为 production。 // 启用 FlagDependencyUsagePlugin, FlagIncludedChunksPlugin, ModuleConcatenationPlugin, // NoEmitOnErrorsPlugin, OccurrenceOrderPlugin, SideEffectsFlagPlugin 和 UglifyJsPlugin // mode: 'production', // 入口文件 entry: resolve('src/index.js'), // 输出文件 output: { // 文件名 filename: '[name].js', // 文件目录 path: resolve('dist') }, // 模块 module: { // 处理规则 rules: [ { // 匹配js文件 test: /\\.js$/, // 使用babel处理，可以写新版js语法 use: 'babel-loader', // 匹配目录，只匹配根目录下src目录 include: resolve('src') } ] }, // 插件 plugins: [ // 用于处理html，将打包的js和css引用插入到index.html new HTMLWebpackPlugin({ // 标题 title: 'Webpack', // 模版 template: resolve('src/index.html'), // 给定的图标路径，可将其添加到输出html中 favicon: resolve('src/assets/favicon.ico') }) ], // webpack dev server 配置 devServer: { // 热替换 hot: true, // 指定使用一个 host。默认是 localhost // 如果希望服务器外部可访问\"0.0.0.0\"，但是在浏览器中会自动打开http://0.0.0.0:7890/ host: '127.0.0.1', // 端口 port: 7890, // 启动后自动在浏览器中打开 open: true } } package.json中配置相关命令 // --progress显示打包进度 --colors颜色高亮 --config制定配置文件 \"scripts\": { // 打包 \"build\": \"webpack --progress --colors --config webpack.prod.conf.js\", // 开发 \"dev\": \"webpack-dev-server --progress --colors --config webpack.dev.conf.js\" }, 运行 # 安装依赖 npm i # or cnpm i # or fast yarn # 开发运行 npm run dev # or yarn dev # 生产打包 npm run build # or yarn build 相关问题 1、使用域名访问开发阶段项目提示，如：微信公众号开发使用cpolar、natapp工具内网穿透访问Invalid Host header // 设置不检查hostname为true devServer: { disableHostCheck: true } // webpack-chain方式配置 config .devServer .disableHostCheck(true) © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"frontend/nuxtjs.html":{"url":"frontend/nuxtjs.html","title":"Nuxt.js","keywords":"","body":"Nuxt.js vue服务端渲染框架 相关问题 1、染服务器内容和客户端虚拟DOM不匹配 使用Nuxtjs时遇到的问题 [Vue warn]: The client-side rendered virtual DOM tree is not matching server-rendered content. This is likely caused by incorrect HTML markup, for example nesting block-level elements inside , or missing . Bailing hydration and performing full client-side render. /** * plugins/vue-carousel-card.js */ import Vue from 'vue' export default () => { if (!process.browser) return false // 只有在客户端渲染时引入组件并注册，问题出在此处，服务端和客户端不一致 const { CarouselCard, CarouselCardItem } = require('vue-carousel-card') Vue.component(CarouselCard.name, CarouselCard) Vue.component(CarouselCardItem.name, CarouselCardItem) } 解决方法（1） 使用包裹该组件 // Nuxt.js版本v2.9.0起使用标签 // no-ssr client-only CarouselCard(:interval=\"7000\" height=\"300px\" type=\"card\" arrow=\"always\") CarouselCardItem(v-for=\"i in 6\" :key=\"i\") h1(v-text=\"i\") 优点：方便快捷起效快，不需要对dependencies的vue组件，有特殊需求缺点：真的不会SSR 解决方法（2） 不区分服务端渲染还是客户端，直接引入并注册组件，以Nuxtjs为例 /** * @/plugins/vue-carousel-card.js */ import Vue from 'vue' import { CarouselCard, CarouselCardItem } from 'vue-carousel-card' export default () => { Vue.component(CarouselCard.name, CarouselCard) Vue.component(CarouselCardItem.name, CarouselCardItem) } /** * nuxt.config.js */ css: [ // 引入样式 'vue-carousel-card/styles/index.css' ], plugins: [ '@/plugins/vue-carousel-card' ] 但这样又会出现新的问题如：window is not defined、document is not defined 等问题需要进行判断，如果在服务端的情况下不去执行使用window或者document的代码 // 部分代码示例（1） import ResizeObserver from 'resize-observer-polyfill' const isServer = typeof window === 'undefined' const addResizeListener = el => { // 由于ResizeObserver中用到了document，此处直接跳过 if (isServer) return el.__ro__ = new ResizeObserver(resizeHandler) } // 部分代码示例（2） if(process && process.browser){ // 判断是客户端再执行 var FastClick = require('fastclick'); FastClick.attach(document.body); } 坑点在.vue文件中的样式最后经过webpack打包成js文件，会用到document（作用是将样式插入到文档） // 编译后的部分代码示例 function addStyle (obj /* StyleObjectPart */) { var update, remove var styleElement = document.querySelector('style[' + ssrIdKey + '~=\"' + obj.id + '\"]') if (styleElement) { if (isProduction) { // has SSR styles and in production mode. // simply do nothing. 解决方法，将样式分离，单独引入 优点：照样SSR缺点：对dependencies的vue组件有特殊要求 2、组件命名冲突导致内存溢出 错误信息 RangeError: Maximum call stack size exceeded at RegExp.[Symbol.replace] () at String.replace () at classify (commons.app.js:13279) at formatComponentName (commons.app.js:13317) at VueComponent.Vue._init (commons.app.js:17610) at new VueComponent (commons.app.js:17752) at createComponentInstanceForVnode (commons.app.js:15923) at init (commons.app.js:15754) at createComponent (commons.app.js:18576) at createElm (commons.app.js:18523) 相关vue组件代码，nuxt.js pages目录（相当于路由） // 引入组件 import List from '~/views/course/list' export default { name: 'List', // （1）该组件名称为List components: { List } // （2）注册于该组件同名的组件 } 因为（1）为该组件名称，引入并注册（2）使用的组件与之同名，导致（3）处使用时，会默认获取当前组件，导致服务端渲染时内存溢出 解决方法：该组件name属性和引用组件注册名称不能重名 tips: vue spa中不会导致内存溢出，如果注册组件和该组件name属性同名，优先调用该组件vue文档-name属性 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"frontend/amap-selector.html":{"url":"frontend/amap-selector.html","title":"高德vue地图选择器","keywords":"","body":"高德vue版地图选择器 UI 框架结合 iview@^3.3.0支持地址检索提示 地图配置 // 版本 // \"vue-amap\": \"^0.5.9\" // 引入 import VueAMap from 'vue-amap' // 注册 Vue.use(VueAMap) // 配置 VueAMap.initAMapApiLoader({ key: 'your key', plugin: [ 'Geocoder', 'Autocomplete', 'MarkerClusterer' ], // 默认高德 sdk 版本为 1.4.4 v: '1.4.4' }) map-selector 地图选择组件 组件使用 import MapSelector from './main' export default { components: { MapSelector }, data () { return { addr: { lng: '', lat: '', address: '' } } }, methods: { locationChange ({ address, areaCode, lat, lng }) { // 获取地图选择信息 } } } 实现代码 const dftLng = '116.403951' const dftLat = '39.913444' const dftAddr = '点击地图选择坐标' export default { name: 'mapSelector', props: { addr: Object }, data () { return { zoom: 13, center: [this.addr.lng || dftLng, this.addr.lat || dftLat], geocoder: null, autocomplete: null, placeSearch: null, keyword: '', infoVisible: true, marker: { position: [this.addr.lng || dftLng, this.addr.lat || dftLat], address: this.addr.address || dftAddr, events: { click: e => { this.infoVisible = true }, dragend: e => { this.codeToAdd([e.lnglat.lng, e.lnglat.lat], true) } } } } }, computed: { map () { return { events: { click: e => { this.codeToAdd([e.lnglat.lng, e.lnglat.lat]) } } } }, info () { let _this = this return { events: { close () { _this.infoVisible = false } } } } }, mounted () { this.$nextTick(() => { setTimeout(() => { this.geocoder = new window.AMap.Geocoder({ radius: 1000, extensions: 'all' }) this.autocomplete = new window.AMap.Autocomplete({ input: this.$refs.searchInput }) window.AMap.event.addListener(this.autocomplete, 'select', e => { this.codeToAdd([e.poi.location.lng, e.poi.location.lat]) }) }, 100) }) }, watch: { addr: { handler (val) { setTimeout(() => { if (val && !val.areaCode && val.lng && val.lat) { this.codeToAdd([val.lng, val.lat]) } }, 100) }, deep: true } }, methods: { codeToAdd (lnglat, isOffset) { this.geocoder && this.geocoder.getAddress(lnglat, (status, result) => { if (status === 'complete' && result.info === 'OK') { const rr = result.regeocode const add = rr.formattedAddress this.marker.position = [lnglat[0], lnglat[1]] this.marker.address = add this.$emit('location-info', { address: add, areaCode: rr.addressComponent.adcode, lat: lnglat[1], lng: lnglat[0] }) } }) } } } .map-container { width: 770px !important; height: 460px; padding-top: 40px; position: relative; .ivu-input-wrapper.ivu-input-type { position: absolute; top: 0 } } .amap-box { width: 100%; height: 100% } map-selector-modal 地图选择组件弹出框 组件使用 import { MapModal } from '@components/map-selector' export default { components: { MapModal }, data () { return { mapModal: false, addr: { lng: '', lat: '', address: '' } } }, methods: { locationChange ({ address, areaCode, lat, lng }) { // 获取地图选择信息 } } } 代码实现，基于上述组件 map-selector 确定 import MapSelector from './main' export default { name: 'mapModal', components: { MapSelector }, props: { value: Boolean, addr: Object }, data () { return { mapModal: this.value, location: this.addr } }, watch: { value (val) { this.mapModal = val }, mapModal (val) { this.$emit('input', val) } }, methods: { locationChange (val) { this.location = val }, confirm () { this.$emit('location-confirm', this.location) } } } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"frontend/vue-quill-editor.html":{"url":"frontend/vue-quill-editor.html","title":"VueQuillEditor","keywords":"","body":"Vue-Quill-Editor（自定义使用） 基于Vue的Quill富文本编辑器自定义toolbar1、图片拖拽上传服务器后，在文本区域内添加图片2、图片弹窗上传选择，在文本区域内添加图片3、将样式默认使用class的替换为内联样式 div quillEditor( ref=\"editorRef\" v-model=\"content\" :options=\"editorOption\" @change=\"onContentChange\") div(:id=\"[toolbar]\" slot=\"toolbar\") span.ql-formats button.ql-bold(type=\"button\") span.ql-formats button.ql-italic(type=\"button\") span.ql-formats button.ql-underline(type=\"button\") span.ql-formats button.ql-strike(type=\"button\") span.ql-formats button.ql-blockquote(type=\"button\") span.ql-formats button.ql-code-block(type=\"button\") span.ql-formats button.ql-header(value=\"1\" type=\"button\") span.ql-formats button.ql-header(value=\"2\" type=\"button\") span.ql-formats button.ql-list(value=\"ordered\" type=\"button\") span.ql-formats button.ql-list(value=\"bullet\" type=\"button\") span.ql-formats button.ql-script(value=\"sub\" type=\"button\") span.ql-formats button.ql-script(value=\"super\" type=\"button\") //- 缩进无法使用内联样式代替class样式 //span.ql-formats button.ql-indent(value=\"-1\" type=\"button\") //span.ql-formats button.ql-indent(value=\"+1\" type=\"button\") //span.ql-formats button.ql-direction(value=\"rtl\" type=\"button\") span.ql-formats //- 默认字体大小 //select.ql-size option(value=\"small\") option(selected) option(value=\"large\") option(value=\"huge\") //- 自定义字体大小，需对应修改js中SizeStyle.whitelist，以及相关样式 select.ql-size option(value=\"12px\") 12px option(selected) 14px option(value=\"16px\") 16px option(value=\"18px\") 18px option(value=\"20px\") 20px option(value=\"22px\") 22px option(value=\"24px\") 24px option(value=\"26px\") 26px option(value=\"28px\") 28px option(value=\"30px\") 30px option(value=\"32px\") 32px span.ql-formats select.ql-header option(value=\"1\") option(value=\"2\") option(value=\"3\") option(value=\"4\") option(value=\"5\") option(value=\"6\") option(selected=\"selected\") span.ql-formats select.ql-color option(selected=\"selected\") option(value=\"#e60000\") option(value=\"#ff9900\") option(value=\"#ffff00\") option(value=\"#008a00\") option(value=\"#0066cc\") option(value=\"#9933ff\") option(value=\"#ffffff\") option(value=\"#facccc\") option(value=\"#ffebcc\") option(value=\"#ffffcc\") option(value=\"#cce8cc\") option(value=\"#cce0f5\") option(value=\"#ebd6ff\") option(value=\"#bbbbbb\") option(value=\"#f06666\") option(value=\"#ffc266\") option(value=\"#ffff66\") option(value=\"#66b966\") option(value=\"#66a3e0\") option(value=\"#c285ff\") option(value=\"#888888\") option(value=\"#a10000\") option(value=\"#b26b00\") option(value=\"#b2b200\") option(value=\"#006100\") option(value=\"#0047b2\") option(value=\"#6b24b2\") option(value=\"#444444\") option(value=\"#5c0000\") option(value=\"#663d00\") option(value=\"#666600\") option(value=\"#003700\") option(value=\"#002966\") option(value=\"#3d1466\") span.ql-formats select.ql-background option(value=\"#000000\") option(value=\"#e60000\") option(value=\"#ff9900\") option(value=\"#ffff00\") option(value=\"#008a00\") option(value=\"#0066cc\") option(value=\"#9933ff\") option(selected=\"selected\") option(value=\"#facccc\") option(value=\"#ffebcc\") option(value=\"#ffffcc\") option(value=\"#cce8cc\") option(value=\"#cce0f5\") option(value=\"#ebd6ff\") option(value=\"#bbbbbb\") option(value=\"#f06666\") option(value=\"#ffc266\") option(value=\"#ffff66\") option(value=\"#66b966\") option(value=\"#66a3e0\") option(value=\"#c285ff\") option(value=\"#888888\") option(value=\"#a10000\") option(value=\"#b26b00\") option(value=\"#b2b200\") option(value=\"#006100\") option(value=\"#0047b2\") option(value=\"#6b24b2\") option(value=\"#444444\") option(value=\"#5c0000\") option(value=\"#663d00\") option(value=\"#666600\") option(value=\"#003700\") option(value=\"#002966\") option(value=\"#3d1466\") span.ql-formats //- 默认字体 //select.ql-font option(selected=\"selected\") option(value=\"serif\") option(value=\"monospace\") //- 自定义字体，需对应修改js中FontStyle.whitelist，以及相关样式 select.ql-font option(selected=\"selected\") option(value=\"宋体\") 宋体 option(value=\"黑体\") 黑体 option(value=\"楷体\") 楷体 option(value=\"微软雅黑\") 微软雅黑 option(value=\"Arial\") Arial option(value=\"Verdana\") Verdana option(value=\"Georgia\") Georgia option(value=\"Times New Roman\") Times New Roman option(value=\"Microsoft JhengHei\") Microsoft JhengHei option(value=\"Trebuchet MS\") Trebuchet MS option(value=\"Courier New\") Courier New option(value=\"Impact\") Impact option(value=\"Comic Sans MS\") Comic Sans MS option(value=\"Consolas\") Consolas span.ql-formats select.ql-align option(selected=\"selected\") option(value=\"center\") option(value=\"right\") option(value=\"justify\") span.ql-formats button.ql-clean(type=\"button\") span.ql-formats button.ql-link(type=\"button\") span.ql-formats //- 自定义图片选择器 button(type=\"button\" @click=\"imgModal = true\") svg(viewBox=\"0 0 18 18\") rect.ql-stroke(height=\"10\" width=\"12\" x=\"3\" y=\"4\") circle.ql-fill(cx=\"6\" cy=\"7\" r=\"1\") polyline.ql-even.ql-fill(points=\"5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12\") span.ql-formats button.ql-video(type=\"button\") //- 使用iview modal Modal( v-model=\"imgModal\" title=\"选择图片\" :mask-closable=\"false\") div div(style=\"text-align: center\") input( ref=\"imgFileRef\" type=\"file\" style=\"display: none !important\" :accept=\"accept\" @change=\"imgFileChange\") div( ref=\"imgRef\" :style=\"`display: inline-block; width: 300px; height: 180px; border: 2px dashed; position: relative; border-color: ${ isDropImgOver ? '#666' : '#CCC' }`\" @click=\"$refs.imgFileRef.click()\") Progress( v-if=\"percent > 0 && percent import 'quill/dist/quill.core.css' import 'quill/dist/quill.snow.css' import 'quill/dist/quill.bubble.css' import _Quill from 'quill' import { quillEditor } from 'vue-quill-editor' // 默认图片类型 const allowType = { '.png': 'image/png', '.jpg': 'image/jpeg'/* , '.jpeg': 'image/jpeg', '.bmp': 'image/bmp', '.gif': 'image/gif', '.svg': 'image/svg+xml', '.tif': 'image/tiff' */ } /** * 对Quill的自定义修改 */ const Quill = window.Quill || _Quill // 将样式默认使用class的替换为内联样式 let SizeStyle = Quill.import('attributors/style/size') let FontStyle = Quill.import('attributors/style/font') let AlignStyle = Quill.import('attributors/style/align') // 自定义字体大小尺寸，需对应修改html中下拉框，以及相关样式 SizeStyle.whitelist = ['12px', '16px', '18px', '20px', '22px', '24px', '26px', '28px', '30px', '32px'] // 自定义字体类型，需对应修改html中下拉框，以及相关样式 FontStyle.whitelist = ['宋体', '黑体', '楷体', '微软雅黑', 'Arial', 'Verdana', 'Georgia', 'Times New Roman', 'Microsoft JhengHei', 'Trebuchet MS', 'Courier New', 'Impact', 'Comic Sans MS', 'Consolas'] Quill.register(SizeStyle, true) Quill.register(FontStyle, true) Quill.register(AlignStyle, true) export default { name: 'Editor', components: { quillEditor }, props: { value: String, placeholder: String }, data () { return { content: this.value, toolbar: '', imgModal: false, imgUrl: '', netImgUrl: '', isDropImgOver: false } }, computed: { editor () { return this.$refs.editorRef.quill }, accept () { return Object.keys(allowType).join(',') }, editorOption () { // 解决同一个组件中出现多个富文本id冲突的问题 let id = 'toolbar-' + Math.random().toString(16).substring(2) this.toolbar = id // eslint-disable-line return { placeholder: this.placeholder, modules: { toolbar: '#' + id } } } }, watch: { value (val) { if (this.editor && val !== this.content) this.content = val }, modal (val) { if (!val) { this.imgUrl = '' this.netImgUrl = '' } } }, mounted () { this.$nextTick(() => { /** * 拖拽上传图片并插入富文本 */ // 获取quillEditor中的editor let editor = this.$refs.editorRef.$refs.editor editor.ondragenter = e => this.dropInsertHandler(e) editor.ondragover = e => this.dropInsertHandler(e) editor.ondragleave = e => this.dropInsertHandler(e) editor.ondrop = e => { const files = e.dataTransfer.files if (files && files.length > 0) { this.fileUpload(files[0], this.insertImg) } this.dropInsertHandler(e) } /** * 图片选择器拖拽上传 */ let imgRef = this.$refs.imgRef imgRef.ondragenter = e => this.imgDropHandler(e) imgRef.ondragover = e => this.imgDropHandler(e) imgRef.ondragleave = e => this.imgDropHandler(e, false) imgRef.ondrop = (e) => { const files = e.dataTransfer.files if (files && files.length > 0) { this.fileUpload(files[0]) } this.imgDropHandler(e, false) } }) }, methods: { fileUpload (file, callback) { // 判断格式 // 判断大小 // ... // 上传图片并返回图片访问url // this.imgUrl = imgUrl // callback && callback() }, insertImg () { if (this.imgUrl) { this.editor.focus() this.editor.insertEmbed(this.editor.getSelection().index, 'image', this.imgUrl) this.modal = false } else alert('没有可用的图片！') }, onContentChange () { this.$emit('input', this.content) }, imgFileChange ({ target: { files } }) { if (files && files.length > 0) { this.fileUpload(files[0]) } }, imgDropHandler (e, isOver = true) { this.dropInsertHandler() this.isDropImgOver = isOver } dropInsertHandler (e) { e.preventDefault() // 阻止离开时的浏览器默认行为 e.stopPropagation() // 阻止冒泡 } } } .ql-container font-size 14px .ql-snow .ql-picker &.ql-size .ql-picker-item &[data-value=\"12px\"]::before font-size 12px &[data-value=\"16px\"]::before font-size 16px &[data-value=\"18px\"]::before font-size 18px &[data-value=\"20px\"]::before font-size 20px &[data-value=\"22px\"]::before font-size 22px &[data-value=\"24px\"]::before font-size 24px &[data-value=\"26px\"]::before font-size 26px &[data-value=\"28px\"]::before font-size 28px &[data-value=\"30px\"]::before font-size 30px &[data-value=\"32px\"]::before font-size 32px &.ql-font .ql-picker-item &[data-value=\"宋体\"]::before font-family '宋体' &[data-value=\"黑体\"]::before font-family '黑体' &[data-value=\"楷体\"]::before font-family '楷体' &[data-value=\"微软雅黑\"]::before font-family '微软雅黑' &[data-value=\"Arial\"]::before font-family 'Arial' &[data-value=\"Verdana\"]::before font-family 'Verdana' &[data-value=\"Georgia\"]::before font-family 'Georgia' &[data-value=\"Times New Roman\"]::before font-family 'Times New Roman' &[data-value=\"Microsoft JhengHei\"]::before font-family 'Microsoft JhengHei' &[data-value=\"Trebuchet MS\"]::before font-family 'Trebuchet MS' &[data-value=\"Courier New\"]::before font-family 'Courier New' &[data-value=\"Impact\"]::before font-family 'Impact' &[data-value=\"Comic Sans MS\"]::before font-family 'Comic Sans MS' &[data-value=\"Consolas\"]::before font-family 'Consolas' © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"frontend/chrome-download.html":{"url":"frontend/chrome-download.html","title":"Chrome文件下载","keywords":"","body":"Chrome浏览器文件下载 图片下载 /** * src 图片链接 * filename 下载图片命名 * ext 图片格式，png jpg */ function downloadImg (src, filename, ext) { const img = new Image() const canvas = document.createElement('canvas') const ctx = canvas.getContext('2d') const link = document.createElement('a') img.setAttribute('crossOrigin', 'anonymous') // 设置允许跨域访问 img.src = src img.onload = () => { canvas.width = img.width canvas.height = img.height ctx.drawImage(img, 0, 0, img.width, img.height) link.setAttribute('href', canvas.toDataURL('image/' + ext)) link.setAttribute('target', '_blank') link.setAttribute('download', filename + '.' + ext) link.click() } } Excel下载 后端通过输出流导出Excel，前端下载文件，后端代码请点击此处参照。 // 以 axios 为例，需要设置响应参数类型为 blob axios.get(`/v1/export`, { responseType: 'blob' }).then(res => { if (res.status === 200) { const url = window.URL.createObjectURL(new Blob([res.data])) const link = document.createElement('a') link.href = url link.setAttribute('download', '导出excel.xls') link.click() // 回收URL window.URL.revokeObjectURL(url) } }) © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"index/wx.html":{"url":"index/wx.html","title":"微信开发","keywords":"","body":"微信开发 微信小程序车牌键盘 微信小程序授权 微信公众号 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"wx/weapp-vehicle-panel.html":{"url":"wx/weapp-vehicle-panel.html","title":"微信小程序车牌键盘","keywords":"","body":"微信小程序车牌键盘 微信小程序车牌键盘。 效果 目录结构 ├─ del.png # 删除按钮 ├─ index.js # js ├─ index.json # json配置 ├─ index.wxml # 视图 └─ index.wxss # 样式 del.png index.js Component({ externalClasses: ['v-panel'], properties: { isShow: { type: Boolean, value: false }, buttonBorder: { type: String, value: '1px solid #ccc' }, backgroundColor: { type: String, value: '#F5F5F5' }, value: { type: String, value: '', observer: function (newVal) { this.setData({ length: newVal.length }) } } }, data: { keyVehicle1: '京津沪渝冀豫云辽', keyVehicle2: '黑湘皖鲁新苏浙赣', keyVehicle3: '鄂桂甘晋蒙陕吉闽', keyVehicle4: '贵粤青藏川宁琼使领', keyNumber: '1234567890', keyEnInput1: 'QWERTYUIOPA', keyEnInput2: 'SDFGHJKLZXC', keyEnInput3: 'VBNM挂学警港澳', length: 0 }, methods: { vehicleTap: function (event) { let val = event.target.dataset.value switch (val) { case 'delete': this.triggerEvent('delete') break case 'ok': this.triggerEvent('ok') break default: this.triggerEvent('inputchange', val) } } } }) index.json { \"component\": true } index.wxml 删除 确定 index.wxss .vehicle-panel { width: 100%; display: flex; flex-direction: column; justify-content: center; border-top: 1px solid #EEE; font-size: 32rpx; padding-top: 10rpx } .vehicle-panel-row { display: flex; justify-content: space-between; align-items: center } .vehicle-panel-row-last { display: flex; justify-content: space-between; align-items: center } .vehicle-panel-row-button { background-color: #fff; margin: 5rpx; padding: 5rpx; width: 80rpx; height: 80rpx; text-align: center; line-height: 80rpx; border-radius: 10rpx } .vehicle-panel-row-button-number { background-color: #DDD } .vehicle-panel-row-button-last { width: 90rpx; height: 90rpx; line-height: 90rpx } .vehicle-hover { background-color: #ccc } .vehicle-panel-row-button-img { display: flex; justify-content: center; align-items: center } .vehicle-en-button-delete { width: 55rpx; height: 85rpx } .vehicle-panel-ok { background-color: #1989fa; color: #fff; width: 150rpx; height: 80rpx } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"wx/weapp-grant.html":{"url":"wx/weapp-grant.html","title":"微信小程序授权","keywords":"","body":"小程序授权相关 openid 用户唯一标识，小程序、公众号等，每个应用唯一，不同应用中不相同unionid 同平台下相等，小程序、公众号、App等，需绑定到同一开放平台下session_key 会话密钥，解析小程序中 encryptedData, iv 注意：auth.code2Session 凭证校验时，一定能获取的值 openid, session_keyunionid 需要满足特定条件才能直接获取否则需要通过 session_key 解析 encryptedData, iv 获取 问题描述 特殊性情况下，如：新账号首次注册、已注册账号首次登录等，使用 session_key 解析 encryptedData, iv 失败，无法获取 unionid 原因：小程序端需要先 wx.login 获取 code，然后通过 wx.getUserInfo 获取 encryptedData, iv如果使用小程序 Button 的 getUserInfo 提示用户授权登录 则无法先调用 wx.login 获取 code 解决办法：在授权登录页面 onLoad 生命周期中调用 wx.login 获取 code由于 code 默认有效时间为5分钟，应该设置定时任务，每 4 分钟调用 wx.login 更新 code /** 部分代码示例 **/ // wxml 获取用户信息 // js Page({ data: { code: '', timer: undefined }, onLoad () { this.getCodeFunc() var timer = setInterval(this.getCodeFunc, 4 * 60 * 1000) this.setData({ timer }) }, onUnload () { this.timer && clearInterval(this.timer) }, getCodeFunc () { var _this = this wx.login({ success (res) { if (res.code) { _this.setData({ code: res.code }) } } }) }, getUserInfo (e) { var encryptedData = e.detail.encryptedData var iv = e.detail.iv this.doLoginRequest(encryptedData, iv, this.code) }, doLoginRequest (encryptedData, iv, code) { // TODO login request } }) © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"wx/wx-mp.html":{"url":"wx/wx-mp.html","title":"微信公众号","keywords":"","body":"微信公众号 推荐使用内网穿透在开发阶段进行内网穿透，如：cpolar Vue项目中通过内容穿透域名访问报错 Invalid Host header，解决方法 // vue-cli@2.x修改webpack.dev.conf.js devServer: { disableHostCheck: true, } // vue-cli@3.x以及4.x修改vue.config.js module.exports = { devServer: { disableHostCheck: true } } 正式环境需配置域名信息 测试帐号申请，请点击 服务器配置校验TOKEN 1）将token、timestamp、nonce三个参数进行字典序排序2）将三个参数字符串拼接成一个字符串进行sha1加密3）开发者获得加密后的字符串可与signature对比，标识该请求来源于微信 import cn.hutool.crypto.SecureUtil; /** * 微信服务器配置token校验，URL处填写该接口访问路径 * springboot */ @RequestMapping(\"/common\") public class CommonController { @GetMapping(\"/v1/wx/check\") @ControllerExceptionHandler public String wxTokenCheck( @RequestParam(\"signature\") String signature, @RequestParam(\"timestamp\") String timestamp, @RequestParam(\"nonce\") String nonce, @RequestParam(\"echostr\") String echostr, HttpServletResponse response) { // 使用TreeSet字典序排序 TreeSet set = new TreeSet<>(); set.add(\"TOKEN\"); // 自己设置的TOKEN set.add(timestamp); set.add(nonce); StringBuilder sBuilder = new StringBuilder(); for (String item : set) { sBuilder.append(item); } // sha1加密 String sign = SecureUtil.sha1(sBuilder.toString()); if (signature.equalsIgnoreCase(sign)) { return echostr; } else { return String.valueOf(false); } } } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-26 "},"index/flutter.html":{"url":"index/flutter.html","title":"Flutter","keywords":"","body":"Flutter 环境 Android构建 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"flutter/env.html":{"url":"flutter/env.html","title":"环境","keywords":"","body":"Flutter 环境安装配置 国内镜像 相关链接（需科学上网） 配置环境变量解决flutter pub get卡的问题Window系统在系统环境变量中添加MacOS系统在.bash_profile中添加 # 官方提供的国内镜像 export PUB_HOSTED_URL=https://pub.flutter-io.cn export FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn # 上海交通大学提供的国内镜像 export FLUTTER_STORAGE_BASE_URL=https://mirrors.sjtug.sjtu.edu.cn/ export PUB_HOSTED_URL=https://dart-pub.mirrors.sjtug.sjtu.edu.cn/ MacOS系统 1、安装 Flutter sdk （包含 dart sdk） # https://flutter.dev/docs/get-started/install/macos # 下载并解压，将 flutter 文件夹复制到 /Users//Programs/ 目录下 # 配置 .bash_profile FLUTTER_HOME=/Users//Programs/flutter PATH=$PATH:$FLUTTER_HOME/bin export PATH 2、安装 XCode，直接从 AppStore 下载安装 # 配置Xcode命令行工具以使用新安装的Xcode版本 sudo xcode-select --switch /Applications/Xcode.app/Contents/Developer # 确保之前打开过一次Xcode并签署通过了Xcode许可协议，可以从命令行运行sudo xcodebuild -license来确认 sudo xcodebuild -license 3、安装 brew # 切换到下载目录 cd /Users//Downloads # 生成 brew 安装文件 curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install >> brew_install # 编辑 brew_install # 将 line.9 (新版本好像没有 CORE_TAP_REPO，则略过) BREW_REPO = \"https://github.com/Homebrew/brew\".freeze CORE_TAP_REPO = \"https://github.com/Homebrew/homebrew-core\".freeze # 替换为 BREW_REPO = \"https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/brew.git\".freeze CORE_TAP_REPO = \"https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.git\".freeze # 执行脚本安装 /usr/bin/ruby brew_install # 安装完后删除 brew_install 文件 rm brew_install 4、安装 cocoapods # brew install 安装前会 Updating Homebrew，速度很慢 # 替换镜像源 cd \"$(brew --repo)\" git remote set-url origin https://mirrors.ustc.edu.cn/brew.git cd \"$(brew --repo)/Library/Taps/homebrew/homebrew-core\" git remote set-url origin https://mirrors.ustc.edu.cn/homebrew-core.git # 安装 brew install cocoapods # 执行命令，此步骤速度很慢 pod setup # 使用清华大学开源镜像，该步骤解决 pod setup 速度慢的问题 cd ~/.cocoapods/repos pod repo remove master git clone https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git master # 工程的podFile第一行加上 ? 未使用，作用未知，运行 flutter doctor 命令成功 source 'https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git' 5、安装 IOS tools brew update brew install --HEAD usbmuxd brew link usbmuxd brew install --HEAD libimobiledevice brew install ideviceinstaller brew install ios-deploy 6、安装Android Studio，创建安装虚拟设备 AVD # 直接下载安装即可 Android Studio # 注意mac上可能会提示 Android Studio 使用系统日历隐私，不授权可能无法完成初始化配置 # 完成初始化配置，其中 android/sdk 目录需要配置到 .bash_profile 中 ANDROID_HOME=/Users//Programs/Android/sdk export ANDROID_HOME # 安装完成打开，在创建项目的页面，右下角，Configure -> Plugins，在 Marketplace 里面搜索 并安装 flutter 插件（自动安装 Dart 插件），重启 # Configure -> AVD Manager，创建新安卓虚拟设备 # 一般选择 Phone -> Nexus 5 -> Android 8.0（需下载） -> Finish 点击绿色三角启动虚拟设备 # 提示 Android license status unknown # 运行命令添加 Android license 即可 flutter doctor --android-licenses 7、如果使用 VS Code，需要安装 flutter 插件，自动安装 Dart 插件 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"flutter/android-package.html":{"url":"flutter/android-package.html","title":"Android构建","keywords":"","body":"Android构建 最新官方文档请点击查看（需科学上网） 1、检查 App Manifest 查看默认应用程序清单文件(位于/android/app/src/main/中的AndroidManifest.xml文件)，并验证这些值是否正确，特别是： application: 编辑 application 标签，这是应用的名称。 android 8 及以后 http/https问题 android:label=\"netease_cloud_music\" -> 安装后app名字 android:icon=\"@mipmap/ic_launcher\" -> 安装后app图标，修改图标文件(位于\\/android/app/src/main/res中的各尺寸图标文件) --> uses-permission: 权限配置。如果应用程序代码不需要Internet访问，请删除android.permission.INTERNET权限。标准模板包含此标记是为了启用Flutter工具和正在运行的应用程序之间的通信。 2、查看构建配置 查看默认[Gradle 构建文件][gradlebuild]”build.gradle”，它位于/android/app/，验证这些值是否正确，尤其是： defaultConfig: applicationId: 指定始终唯一的 (Application Id)appid。 versionCode & versionName: 指定应用程序版本号和版本号字符串。 minSdkVersion & targetSdkVersion: 指定最低的API级别以及应用程序设计运行的API级别。 4、添加启动图标、启动页 图标 当一个新的Flutter应用程序被创建时，它有一个默认的启动器图标。要自定义此图标： 1、图标尺寸： drawable-mdpi-icon: 48 x 48 drawable-hdpi-icon: 72 x 72 drawable-xhdpi-icon: 96 x 96 drawable-xxhdpi-icon: 144 x 144 drawable-xxxhdpi-icon: 192 x 192 2、在/android/app/src/main/res/目录中，将图标文件放入使用配置限定符命名的文件夹中。默认mipmap-文件夹演示正确的命名约定。3、在AndroidManifest.xml中，将application标记的android:icon属性更新为引用上一步中的图标（例如 ）。4、要验证图标是否已被替换，运行应用程序并检查应用图标。 启动页 启动页配置(位于/android/app/src/main/res/drawable/中的launch_background.xml文件) 图片尺寸，竖屏：高 x 宽，横屏：宽 x 高 drawable-port-mdpi-screen: 480 x 320 drawable-port-hdpi-screen: 800 x 480 drawable-port-xhdpi-screen: 1280 x 720 drawable-port-xxhdpi-screen: 1600 x 960 drawable-port-xxxhdpi-screen: 1920 x 1280 --> 5、app签名 （1）创建 keystore 如果有现有keystore，请跳至下一步。如果没有，请通过在运行以下命令来创建一个： # -keystore 生成目录记名字 # -keyalg 加密和数字签名的算法 # -keysize 密钥长度 # -validity 有效天数 # -alias 别名，名称最好与前面-alias的参数保持一致 keytool -genkey -v -keystore ~/appkeystore.jks -keyalg RSA -keysize 2048 -validity 20000 -alias appkeystore # next 提示输入 “ 密钥库 ” 密码、确认密码 # next 提示输入名字姓氏、组织单位名称、组织名称、城市区域名称、省、国家 # next 提示是否正确，输入 y # next 提示输入 “ 密钥 ” 密码、确认密码，如果和上面 “ 密钥库 ” 密码相同，直接摁回车键 注意：保持文件私密；不要将它加入到公共源代码控制中。注意：keytool可能不在系统路径中。它是Java JDK的一部分，它是作为Android Studio的一部分安装的。 （2）引用应用程序中的keystore 创建一个名为/android/key.properties的文件，其中包含对密钥库的引用： storePassword= keyPassword= keyAlias=appkeystore storeFile=/appkeystore.jks> 注意: 保持文件私密; 不要将它加入公共源代码控制中 （3）在gradle中配置签名 通过编辑/android/app/build.gradle文件为应用配置签名 1、替换： android { 为： def keystoreProperties = new Properties() def keystorePropertiesFile = rootProject.file('key.properties') if (keystorePropertiesFile.exists()) { keystoreProperties.load(new FileInputStream(keystorePropertiesFile)) } android { 2、替换： buildTypes { release { // TODO: Add your own signing config for the release build. // Signing with the debug keys for now, so `flutter run --release` works. signingConfig signingConfigs.debug } } 为： signingConfigs { release { keyAlias keystoreProperties['keyAlias'] keyPassword keystoreProperties['keyPassword'] storeFile file(keystoreProperties['storeFile']) storePassword keystoreProperties['storePassword'] } } buildTypes { release { signingConfig signingConfigs.release } } 应用的release版本将自动进行签名。 5、开启混淆 Flutter 1.16.2及之后版本 使用--obfuscate结合使用标记来构建发行版本--split-debug-info。该--split-debug-info标志指定Flutter可以在其中输出调试文件的目录。 # flutter build apk --obfuscate --split-debug-info= # 输出调试文件的目录使用相对路径./.debug_info flutter build apk --obfuscate --split-debug-info=./.debug_info Flutter 1.16.2之前版本 默认情况下 flutter 不会开启 Android 的混淆。 如果使用了第三方 Java 或 Android 库，或者减小 apk 文件的大小或者防止代码被逆向破解。 （1）配置混淆 创建 /android/app/proguard-rules.pro 文件，并添加以下规则： # Flutter Wrapper -keep class io.flutter.app.** { *; } -keep class io.flutter.plugin.** { *; } -keep class io.flutter.util.** { *; } -keep class io.flutter.view.** { *; } -keep class io.flutter.** { *; } -keep class io.flutter.plugins.** { *; } 上述配置只混淆了 Flutter 引擎库，任何其他库（比如 Firebase）需要添加与之对应的规则。 （2）开启混淆/压缩 打开 /android/app/build.gradle 文件，定位到 buildTypes 块。在 release 配置中将 minifyEnabled 和 useProguard 设为 true，再将混淆文件指向上一步创建的文件。 android { ... buildTypes { release { signingConfig signingConfigs.release // 压缩，默认启用 // minifyEnabled true // Gradle 3.4.0之后默认启用R8，3.2.0之前版本默认ProGuard // useProguard true // 启用资源压缩 shrinkResources true // 压缩规则 proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro' } } } 注意：开启压缩 minifyEnabled true 可能会导致无法打包，暂时不启用压缩。 貌似自v1.12.13版本已解决 7、构建一个发布版（release）APK 使用命令行: 1、cd ( 为工程目录)；2、运行flutter build apk (flutter build 默认会包含 --release选项)；3、Flutter 1.16.2及之后版本压缩混淆打包请参照。 # 输出调试文件的目录为项目根目录下debug-info flutter build apk --obfuscate --split-debug-info=./.debug_info 打包好的发布APK位于/build/app/outputs/apk/app-release.apk。 8、相关问题 Could not resolve io.flutter:flutter_ ···无法现在相关依赖导致 打开 /android/build.gradle 文件，添加maven仓库相关配置 maven { url 'http://download.flutter.io' } buildscript { repositories { maven { url 'http://download.flutter.io' } } } allprojects { repositories { maven { url 'http://download.flutter.io' } } } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"index/java.html":{"url":"index/java.html","title":"Java","keywords":"","body":"Java Java部分知识点总结。 Stream FastJson compareTo 比较大小 Java工具类 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"java/stream.html":{"url":"java/stream.html","title":"Java 8 Stream","keywords":"","body":"Java 8 Stream 部分 Stream 常用操作整理 测试对象 public class Obj { private String code; private Integer value; public Obj() { } public Obj(String code, Integer value) { this.code = code; this.value = value; } public String getCode() { return code; } public void setCode(String code) { this.code = code; } public Integer getValue() { return value; } public void setValue(Integer value) { this.value = value; } @Override public String toString() { return \"Obj{code='\" + code + '\\'' + \", value=\" + value + \"}\"; } } 测试list List strList = new ArrayList(); strList.add(\"B\"); strList.add(\"C\"); strList.add(\"E\"); strList.add(\"A\"); List objList = new ArrayList(); objList.add(new Obj(\"B\", 2)); objList.add(new Obj(\"C\", 3)); objList.add(new Obj(\"E\", 4)); objList.add(new Obj(\"A\", 1)); 类型转换 // List -> Map Map map = objList.stream().collect(Collectors.toMap(Obj::getCode, Obj::getValue)); // {A=A1, B=B1, C=C1, E=E1} // List -> Map Map objMap = objList.stream().collect(Collectors.toMap(Obj::getCode, obj -> obj)); // {A=Obj{code='A', value=1}, B=Obj{code='B', value=2}, C=Obj{code='C', value=3}, E=Obj{code='E', value=4}} // List -> List List list = objList.stream().map(obj -> obj.getCode()).collect(Collectors.toList()); // B C E A // List -> Set Set set = objList.stream().collect(Collectors.toSet()); // [Obj{code='B', value=2}, Obj{code='E', value=4}, Obj{code='C', value=3}, Obj{code='A', value=1}] // List -> String[] String[] array = objList.stream().map(obj -> obj.getCode()).toArray(String[]::new); // B C E A // List -> int[] int[] array = objList.stream().mapToInt(obj -> obj.getValue()).toArray(); // 2 3 4 1 // List -> String String join = strList.stream().collect(Collectors.joining()); // BCEA String joining = strList.stream().collect(Collectors.joining(\",\")); // B,C,E,A 排序 自然序排序，常用于基本数据类型 List list = strList.stream().sorted().collect(Collectors.toList()); // A B C E // 逆序 List list = strList.stream().sorted(Comparator.reverseOrder()).collect(Collectors.toList()); // E C B A // 不使用stream strList.sort(Comparator.comparing(String::toString)); // 逆序 strList.sort(Comparator.comparing(String::toString).reversed()); 使用Comparator排序，常用于对象类型 List list = objList.stream().sorted(Comparator.comparing(Obj::getCode)).collect(Collectors.toList()); // Obj{code='A', value=1} Obj{code='B', value=2} Obj{code='C', value=3} Obj{code='E', value=4} // 逆序 List list = objList.stream().sorted(Comparator.comparing(Obj::getCode).reversed()).collect(Collectors.toList()); // Obj{code='E', value=4} Obj{code='C', value=3} Obj{code='B', value=2} Obj{code='A', value=1} // 不使用stream objList.sort(Comparator.comparing(Obj::getCode)); // 逆序 objList.sort(Comparator.comparing(Obj::getCode).reversed()); 存在（anyMatch）、全部匹配（allMatch）、无匹配（noneMatch）、过滤（filter）、获取过滤后第一个（findFirst）、获取过滤后任意一个（findAny） // 存在（anyMatch） boolean anyMatch = objList.stream().anyMatch(obj -> \"E\".equals(obj.getCode())); // true // 全部匹配（allMatch） boolean allMatch = objList.stream().allMatch(obj -> obj.getValue() > 0); // true // 无匹配（noneMatch） boolean noneMatch = objList.stream().noneMatch(obj -> obj.getValue() > 4); // true // 过滤（filter） List collect = objList.stream().filter(obj -> obj.getValue() > 2).collect(Collectors.toList()); // [Obj{code='C', value=3}, Obj{code='E', value=4}] // 获取过滤后第一个（findFirst） Obj obj = objList.stream().filter(obj -> obj.getValue() > 2).findFirst().get(); // Obj{code='C', value=3} // 获取过滤后任意一个（findAny），对数据没有顺序上的要求，findAny的效率比findFirst要快 Obj obj = objList.stream().filter(obj -> obj.getValue() > 2).findAny().get(); // Obj{code='C', value=3} 聚合求值（reduce、Collectors.reducing） int totalVal = objList.stream().map(obj -> obj.getValue()).reduce(0, (sum, val) -> sum + val); // 10 int totalVal = objList.stream().collect(Collectors.reducing(0, Obj::getValue, (sum, val) -> sum + val)); // 10 统计（IntSummaryStatistics、LongSummaryStatistics、DoubleSummaryStatistics） IntSummaryStatistics summaryStatistics = objList.stream().collect(Collectors.summarizingInt(Obj::getValue)); double average = summaryStatistics.getAverage(); // 平均值 2.5 long count = summaryStatistics.getCount(); // 个数 4 int min = summaryStatistics.getMin(); // 最小值 1 int max = summaryStatistics.getMax(); // 最大值 4 long sum = summaryStatistics.getSum(); // 求和 10 求和 // int int totalVal = objList.stream().mapToInt(obj -> obj.getValue()).sum(); // 10 // double double totalVal = objList.stream().mapToDouble(obj -> obj.getValue().doubleValue()).sum(); // 10.0 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"java/fastjson.html":{"url":"java/fastjson.html","title":"FastJson","keywords":"","body":"FastJson springboot中配置请查看 maven依赖 com.alibaba fastjson 1.2.51 SerializerFeature 含义 SerializerFeature 含义 备注 QuoteFieldNames 输出key时是否使用双引号，默认为true UseSingleQuotes 使用单引号而不是双引号，默认为false WriteMapNullValue 是否输出值为null的字段，默认为false 常用 WriteEnumUsingToString Enum输出toString()，默认为false WriteEnumUsingName Enum输出name()，默认为false UseISO8601DateFormat Date使用ISO8601格式输出，默认为false WriteNullListAsEmpty 将Collection类型字段的字段空值输出为[] 常用 WriteNullStringAsEmpty 将字符串类型字段的空值输出为空字符串 \"\" 常用 WriteNullNumberAsZero 将数值类型字段的空值输出为0 WriteNullBooleanAsFalse 将Boolean类型字段的空值输出为false SkipTransientField 如果是true，类中的Get方法对应的Field是transient，序列化时将会被忽略。默认为true SortField 按字段名称排序后输出。默认为false WriteTabAsSpecial 把\\t做转义输出，默认为false PrettyFormat 结果是否格式化，默认为false WriteClassName 序列化时写入类型信息，默认为false。反序列化是需用到 DisableCircularReferenceDetect 消除对同一对象循环引用的问题，默认为false WriteSlashAsSpecial 对斜杠 \"/\" 进行转义 BrowserCompatible 将中文都会序列化为\\uXXXX格式，字节数会多一些，但是能兼容IE 6，默认为false WriteDateUseDateFormat 全局修改日期格式，默认为false。JSON.DEFFAULT_DATE_FORMAT = \"yyyy-MM-dd\";JSON.toJSONString(obj, SerializerFeature.WriteDateUseDateFormat); NotWriteRootClassName DisableCheckSpecialChar 一个对象的字符串属性中如果有特殊字符如双引号，将会在转成json时带有反斜杠转移符。如果不需要转义，可以使用这个属性。默认为false BeanToArray 将对象转为array输出 WriteNonStringKeyAsString NotWriteDefaultValue BrowserSecure IgnoreNonFieldGetter WriteNonStringValueAsString IgnoreErrorGetter WriteBigDecimalAsPlain MapSortField json -> 指定泛型类型 反序列化 // new TypeReference() { } HashMap> map = JSON.parseObject(json, new TypeReference>>() { }); © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"java/compare.html":{"url":"java/compare.html","title":"compareTo 比较大小","keywords":"","body":"compareTo 比较大小 字符串比较大小，按字典顺序比较对象比较大小，需实现Comparable接口可理解为数字减法，字符串是从第一个字符开始比较前者 减 后者相等 -> 0大于0 -> 1小于0 -> -1 Date类型比较 // 此处例举两个Date类型时间 Date dateA Date dateB // 比较 dateA.compareTo(dateB) // 结果 // Date dateA = // Date dateB = // 输出 0 -> dateA 与 dateB 为同一时间，两者相等 // Date dateA = // Date dateB = // 输出 1 -> dateA 晚于 dateB，前者大 // Date dateA = // Date dateB = // 输出 -1 -> dateA 早于 dateB，后者大 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"java/utils.html":{"url":"java/utils.html","title":"Java工具类","keywords":"","body":"java工具类 JWT常用工具 依赖 io.jsonwebtoken jjwt 0.9.1 /** * Jwt工具类 */ public class JwtUtil { // 日志 private static final Logger log = LoggerFactory.getLogger(JwtUtil.class); // JWT 加解密类型 private static final SignatureAlgorithm JWT_ALG = SignatureAlgorithm.HS256; // JWT 秘钥，勿暴露于前端 private static final String JWT_SECRET = \"Y29tQHNoYW5kb25nI2hvbmdlbg\"; /** * 加密 * @param subjectJson JSON * @param expire 超时时间，单位秒 * @return */ public static String buildJWT(String subjectJson, int expire) { // 生成JWT的时间 Date startDate = DateUtil.date(); // 过期时间 Date endDate = DateUtil.offset(startDate, DateField.SECOND, expire); // 为payload添加各种标准声明和私有声明 JwtBuilder builder = Jwts.builder() // new一个JwtBuilder，设置jwt的body .setId(IdUtil.simpleUUID()) // JWT的唯一标识，回避重放攻击 .setIssuedAt(startDate) // 签发时间 .setExpiration(endDate) // 过期时间 .setSubject(subjectJson) // json格式的字符串 .compressWith(CompressionCodecs.DEFLATE) .signWith(JWT_ALG, generalKey()); // 设置签名算法和密钥 return builder.compact(); } // 测试方法 public static void main(String[] args) { String buildJWT = buildJWT(\"aaaaa\", 2); System.out.println(buildJWT); System.out.println(parseJWT(buildJWT)); } /** * Jwt解析 * @param jwt 内容文本 * @return */ public static String parseJWT(String jwt) { Jws claimsJws = getClaimsJws(jwt); Claims body = claimsJws.getBody(); // 获取加密的内容JSON并返回 String subjectJson = body.getSubject(); return subjectJson; } /** * Jwt验证（true：验证通过，false：验证失败） * @param jwt 内容文本 * @return */ public static boolean checkJWT(String jwt) { return ObjectUtil.isNotNull(getClaimsJws(jwt)); } /** * parseClaimsJws * @param jwt 内容文本 * @return */ private static Jws getClaimsJws(String jwt) { Jws parseClaimsJws = null; try { SecretKey generalKey = generalKey(); JwtParser parser = Jwts.parser().setSigningKey(generalKey); parseClaimsJws = parser.parseClaimsJws(jwt); } catch (Exception e) { log.warn(\"JWT验证失败，原因：{}\", e.getMessage()); } return parseClaimsJws; } /** * 生成加密key，单例模式 * @return */ private static SecretKey generalKey() { return JwtSecretKeyHolder.instance; } private static class JwtSecretKeyHolder { // 服务端保存的jwt 秘钥 static final String str = JWT_SECRET; static final byte[] encodedKey = str.getBytes(); private static final SecretKey instance = new SecretKeySpec(encodedKey, JWT_ALG.getJcaName()); } } 返回值包装工具 异常处理参照请点击此处 /** * Result.java * 返回值包装类 * @param */ public class Result { // 状态码 private int code; // 状态信息 private String msg; // 返回值 private T data; // 默认无参构造 public Result() { } /** * 构造函数 * @param resultEnum 枚举 */ public Result(ResultEnums resultEnum) { this.code = resultEnum.getCode(); this.msg = resultEnum.getMsg(); } /** * 构造函数 * @param code 状态码 * @param msg 状态信息 */ public Result(int code, String msg) { this.code = code; this.msg = msg; } /** * 构造函数 * @param resultEnum 枚举 * @param data 返回值 */ public Result(ResultEnums resultEnum, T data) { this.code = resultEnum.getCode(); this.msg = resultEnum.getMsg(); this.data = data; } /** * 构造函数 * @param code 状态码 * @param msg 状态信息 * @param data 返回值 */ public Result(int code, String msg, T data) { this.code = code; this.msg = msg; this.data = data; } public int getCode() { return code; } public void setCode(int code) { this.code = code; } public String getMsg() { return msg; } public void setMsg(String msg) { this.msg = msg; } public T getData() { return data; } public void setData(T data) { this.data = data; } } /** * ResultUtil.java * 返回值包装工具类 */ public class ResultUtil { /** * 请求成功，无返回结果的 * @return */ public static Result success() { return new Result(ResultEnums.SUCCESS); } /** * 请求成功，通用提示 * @param resultEnums * @return */ public static Result success(ResultEnums resultEnums) { return new Result(resultEnums); } /** * 请求成功（如：保存、修改成功，返回结果可为null，提示保存成功、修改成功、删除成功等） * @param Object * @param msg * @return */ public static Result success(T Object, String msg) { return new Result(ResultEnums.SUCCESS.getCode(), msg); } /** * 请求成功 * @param object 返回值 * @return */ public static Result success(T object) { return new Result(ResultEnums.SUCCESS, object); } /** * 请求失败（Enums.FAILED，请求失败） * @return */ public static Result error() { return new Result(ResultEnums.FAILED); } /** * 请求失败（Enums中定义的错误） * @param resultEnum 枚举 * @return */ public static Result error(ResultEnums resultEnum) { return new Result(resultEnum); } /** * 请求失败（Enums.FAILED，msg自定义，如：返回一些字段验证错误信息，使用频率低没必要在Enums中定义的） * @param msg 失败信息 * @return */ public static Result error(String msg) { return new Result(ResultEnums.FAILED.getCode(), msg); } /** * 请求失败（code，msg 都是自定义，尽量现在Enums中定义错误（尤其是常用的错误），避免使用此方法） * @param code 错误码 * @param msg 错误信息 * @return */ public static Result error(int code, String msg) { return new Result(code, msg); } } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"index/spring.html":{"url":"index/spring.html","title":"Spring","keywords":"","body":"Spring 自定义异常 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"spring/exception.html":{"url":"spring/exception.html","title":"自定义异常","keywords":"","body":"自定义异常处理 基于Aspectj的自定义注解异常处理 定义业务异常类 /** * BusinessException.java * 自定义业务异常 * 继承RuntimeException，而不是Exception，否则导致spring事务无法回滚 */ public class BusinessException extends RuntimeException { private static final long serialVersionUID = 1L; // 自定义错误码 private int code; private String msg; public BusinessException(ResultEnums resultEnum) { super(resultEnum.getMsg()); this.code = resultEnum.getCode(); } public BusinessException(int code, String msg) { super(msg); this.code = code; } public int getCode() { return code; } public void setCode(int code) { this.code = code; } public String getMsg() { return msg; } public void setMsg(String msg) { this.msg = msg; } } /** * ResultEnums.java * 自定义异常枚举：返回码-->返回信息 */ public enum ResultEnums { // 常用信息 ERROR(-1, \"请求错误\"), FAILED(0, \"请求失败\"), SUCCESS(1, \"请求成功\") ; // 状态码 private int code; // 返回信息 private String msg; ResultEnums(int code, String msg) { this.code = code; this.msg = msg; } public int getCode() { return code; } public String getMsg() { return msg; } } 自定义 Service 异常注解及处理 /** * ServiceExceptionHandler.java * 自定义Service异常注解 */ @Target({ ElementType.METHOD }) @Retention(RetentionPolicy.RUNTIME) @Documented public @interface ServiceExceptionHandler { } /** * ServiceExceptionAspect.java * 自定义Service异常处理AOP */ @Component @Aspect public class ServiceExceptionAspect { private static final Logger log = LoggerFactory.getLogger(ServiceExceptionAspect.class); public ServiceExceptionAspect() {} /** * 异常通知, 在方法抛出异常之后 * pointcut：切入点是带有@ServiceExceptionHandler注解的方法 * @annotation()中填写@ServiceExceptionHandler注解位置 * @param joinPoint * @param throwable * @throws BusinessException */ @AfterThrowing( pointcut = \"@annotation(com.admin.api.config.ServiceExceptionHandler)\", throwing = \"throwable\" ) public void afterRuntimeException(JoinPoint joinPoint, Throwable throwable) throws BusinessException { // 如果是业务异常，直接抛出 if (throwable instanceof BusinessException) { throw (BusinessException) throwable; } else if (throwable instanceof RuntimeException) { // 如果是运行时异常，记录异常之后，包装成业务异常在抛出 log.error(\"service: {}\", throwable.getMessage(), throwable); throw new BusinessException(ResultEnums.ERROR); } } } 自定义 Controller 异常注解及处理 /** * ControllerExceptionHandler.java * 自定义Controller异常注解 */ @Target({ ElementType.METHOD }) @Retention(RetentionPolicy.RUNTIME) @Documented public @interface ControllerExceptionHandler { } /** * ControllerExceptionAspect.java * 自定义Controller异常处理AOP */ @Component @Aspect public class ControllerExceptionAspect { private static final Logger log = LoggerFactory.getLogger(ControllerExceptionAspect.class); /** * 环绕通知, 围绕着方法执行 * 切入点是带有@ControllerExceptionHandler注解的方法 * @annotation()中填写@ControllerExceptionHandler注解位置 * @param joinPoint * @return */ @Around(\"@annotation(com.admin.api.config.ControllerExceptionHandler)\") public Object controllerMethodHandler(ProceedingJoinPoint joinPoint) { try { return joinPoint.proceed(); } catch (Throwable throwable) { // 如果是业务异常，直接抛出 if (throwable instanceof BusinessException) { throw (BusinessException) throwable; } else { // 非业务异常，记录异常之后，包装成业务异常在抛出 log.error(\"Controller: {}\", throwable.getMessage(), throwable); throw new BusinessException(ResultEnums.ERROR); } } } } 异常处理，返回json格式的异常包装信息，而非错误页面，返回值包装类参照请点击此处 /** * ExceptionHandler.java * 全局异常处理 */ @ControllerAdvice public class ExceptionHandler { private final static Logger log = LoggerFactory.getLogger(ExceptionHandler.class); /** * 异常处理，返回json格式的异常包装信息，而非错误页面 * @param e * @return */ @org.springframework.web.bind.annotation.ExceptionHandler(value = Exception.class) @ResponseBody public Result handler(Exception e) { if (e instanceof BusinessException) { // 业务异常，响应相应错误 BusinessException be = (BusinessException) e; return ResultUtil.error(be.getCode(), be.getMessage()); } else { log.error(\"--- 系统异常 --> {}\", e); // 系统异常，相应相应错误 return ResultUtil.error(ResultEnums.ERROR.getCode(), ResultEnums.ERROR.getMsg()); } } } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"index/springboot.html":{"url":"index/springboot.html","title":"SpringBoot","keywords":"","body":"SpringBoot SpringBoot开发中遇到过的问题总结。 Put请求配置 FastJson配置 跨域配置 MyBatis Excel 启动方式 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"springboot/put-config.html":{"url":"springboot/put-config.html","title":"Put请求配置","keywords":"","body":"Put请求无法获取参数对象 SpringBoot中使用RESTful API设计规范，如果Put请求无法将参数转为对象，以下两种配置可选。springframework 版本 5.1 及之后，使用FormContentFilter替代HttpPutFormContentFilter。 @Configuration public class WebMvcConfig extends WebMvcConfigurationSupport { /** * 解决put请求无法将参数转为对象 * @return */ @Bean public FormContentFilter httpPutFormContentFilter() { return new FormContentFilter(); } } // 使用：@Component，原理一样，开启：FormContentFilter @Component public class PutFilter extends FormContentFilter { } SpringBoot中使用RESTful API设计规范，如果Put请求无法将参数转为对象，以下两种配置可选。springframework 版本从 3.1 开始，到 5.1 之前，不包含 5.1 。 @Configuration public class WebMvcConfig extends WebMvcConfigurationSupport { /** * 解决put请求无法将参数转为对象 * @return */ @Bean public HttpPutFormContentFilter httpPutFormContentFilter() { return new HttpPutFormContentFilter(); } } // 使用：@Component，原理一样，开启：HttpPutFormContentFilter @Component public class PutFilter extends HttpPutFormContentFilter { } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"springboot/fastjson-config.html":{"url":"springboot/fastjson-config.html","title":"FastJson配置","keywords":"","body":"FastJson处理响应数据 SpringBoot中使用FastJson将响应的数据转成json相关配置springframework 版本 5.2 及之后，直接使用使用MediaType.APPLICATION_JSON即可，无需专门指定charset=UTF-8。FastJeon序列化属性请查看 @Configuration public class WebMvcConfig extends WebMvcConfigurationSupport { /** * FastJson对响应数据处理的相关配置 */ @Override public void configureMessageConverters(List> converters) { FastJsonHttpMessageConverter fastConverter = new FastJsonHttpMessageConverter(); FastJsonConfig fastJsonConfig = new FastJsonConfig(); // 序列化 fastJsonConfig.setSerializerFeatures( SerializerFeature.WriteMapNullValue, SerializerFeature.WriteNullStringAsEmpty, SerializerFeature.WriteNullNumberAsZero, SerializerFeature.WriteNullListAsEmpty ); // 时间戳格式 fastJsonConfig.setDateFormat(\"yyyy-MM-dd HH:mm:ss\"); // 处理中文乱码问题 List fastMediaTypes = new ArrayList(); // fastMediaTypes.add(MediaType.APPLICATION_JSON_UTF8); // springframework 5.2后无需指定charset=UTF-8，直接使用MediaType.APPLICATION_JSON即可 fastMediaTypes.add(MediaType.APPLICATION_JSON); fastConverter.setSupportedMediaTypes(fastMediaTypes); // 设置 fastConverter.setFastJsonConfig(fastJsonConfig); converters.add(fastConverter); } } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"springboot/cors-config.html":{"url":"springboot/cors-config.html","title":"跨域配置","keywords":"","body":"跨域配置 SpringBoot添加跨域配置有以下两种配置方法 @Configuration public class WebMvcConfig extends WebMvcConfigurationSupport { /** * 跨域配置 */ @Override protected void addCorsMappings(CorsRegistry registry) { registry.addMapping(\"/**\") // 允许跨域的源 .allowedOrigins(\"*\") // 是否允许浏览器发送Cookie .allowCredentials(true) // 客户端所要访问的资源允许使用的方法或方法列表 .allowedMethods(\"OPTIONS\", \"HEAD\", \"POST\", \"GET\", \"PUT\", \"DELETE\") // 正式请求的首部信息 // x-requested-with：ajax请求 .allowedHeaders(\"X-Requested-With\") // preflight request （预检请求）的返回结果 //（即 Access-Control-Allow-Methods 和Access-Control-Allow-Headers 提供的信息） // 可以被缓存多久 .maxAge(3600); super.addCorsMappings(registry); } } /** * 跨域访问过滤器 */ @Component public class CorsFilter implements Filter { @Override public void destroy() { } @Override public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException { HttpServletResponse response = (HttpServletResponse) res; HttpServletRequest request = (HttpServletRequest) req; // 也可以使用\"*\"，最好是从request中的header中获取Origin，来做配置 response.setHeader(\"Access-Control-Allow-Origin\", request.getHeader(\"Origin\")); // 是否允许浏览器发送Cookie response.setHeader(\"Access-Control-Allow-Credentials\", \"true\"); // 客户端所要访问的资源允许使用的方法或方法列表 response.setHeader(\"Access-Control-Allow-Methods\", \"OPTIONS, HEAD, POST, GET, PUT, DELETE\"); // 正式请求的首部信息 // x-requested-with：ajax请求 response.setHeader(\"Access-Control-Allow-Headers\", \"X-Requested-With\"); // preflight request （预检请求）的返回结果 //（即 Access-Control-Allow-Methods 和Access-Control-Allow-Headers 提供的信息） // 可以被缓存多久 response.setHeader(\"Access-Control-Max-Age\", \"3600\"); chain.doFilter(req, res); } @Override public void init(FilterConfig config) throws ServletException { } } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"springboot/mybatis.html":{"url":"springboot/mybatis.html","title":"MyBatis","keywords":"","body":"MyBatis SpringBoot中使用MyBatis（maven地址）的一些问题及知识点 1、自增id，并返回新id 需要数据库表支持，相关请点击查看MySQL-自增字段PostgreSQL-自增字段 使用tk.mybatis.mapper通用mapper，com.alibaba.druid数据库连接池，相关依赖如下tk mapper maven地址druid maven地址 com.alibaba druid-spring-boot-starter 1.1.20 tk.mybatis mapper-spring-boot-starter 2.1.5 1、实体类id字段增加以下注解 @Id @KeySql(useGeneratedKeys = true) @Column(name = \"id\", insertable = false) 2、调用dao的insert方法或者insertSelective方法,执行之后都会将新的id赋值给实体类id字段，直接通过实体类getId()获取id 示例 /** * 实体类 */ @Entity @Table(name = \"t_goods\") public class Goods { @Id @KeySql(useGeneratedKeys = true) @Column(name = \"id\", insertable = false) private Integer id; private String name; // getter and setter } /** * Dao */ @Mapper public interface GoodsDao extends BaseDao { } /** * 调用dao的insert方法 * insert和insertSelective执行之后都会将新的id赋值给实体类id字段 */ @RunWith(SpringRunner.class) @SpringBootTest public class GoodsDaoTest { @Autowired private GoodsDao goodsDao; @Test public void test() { Goods goods = new Goods(); goods.setName(\"this is name\"); int row = goodsDao.insert(goods); // int row = goodsDao.insertSelective(goods); System.out.println(goods.getId()); } } 相关问题 1、使用PageHelper分页时报错 Cause: java.sql.SQLException: Parameter index out of range (5 > number of parameters, which is 4) 原因：MyBatis的mapper.xml中存在sql注释，导致PageHelper无法赋值分页条件解决方法：去掉mapper.xml中存在sql注释即可 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"springboot/excel.html":{"url":"springboot/excel.html","title":"Excel","keywords":"","body":"Excel SpringBoot 使用 POI 生成并导出 Excel。以下为后端代码，前端代码请点击此处参照。 org.apache.poi poi-ooxml 4.1.1 /** * 导出excel接口 * @param response */ @GetMapping(\"/v1/export\") public void exportExcel(HttpServletResponse response) { // 测试数据 List list = new ArrayList(); // id name age createTime list.add(new User(1, 'username 1', 18, new Date())); list.add(new User(2, 'username 2', 28, new Date())); list.add(new User(3, 'username 3', 16, new Date())); list.add(new User(4, 'username 4', 25, new Date())); // 创建文档 HSSFWorkbook workbook = new HSSFWorkbook(); // 创建sheet页 HSSFSheet personSheet = workbook.createSheet(\"sheet 1\"); // 处理excel excelHandle(workbook, personSheet, personUserList); // 流输出 try { // 设置响应内容类型 response.setContentType(\"application/vnd.ms-excel\"); // 此处导出名字可能为乱码，前后端分离下载不影响，前端生成文件名 response.setHeader(\"Content-Disposition\", \"attachment;filename=\" + new String(\"导出excel.xls\".getBytes(), StandardCharsets.UTF_8)); // 获取response的输出流 OutputStream outputStream = response.getOutputStream(); // 文档数据写入输出流 workbook.write(outputStream); outputStream.flush(); outputStream.close(); } catch (IOException ie) { // 包装异常并抛出 throw new BusinessException(ResultEnums.FAILED.getCode(), \"excel导出失败\"); } } /** * excel处理 * @param workbook excel文档 * @param sheet sheet页 * @param list 数据 */ private void excelHandle(HSSFWorkbook workbook, HSSFSheet sheet, List list) { // 设置默认行高 sheet.setDefaultRowHeightInPoints(20); // 设置列宽，第一个参数为索引，第二个参数为列宽，列宽单位为一个字符宽度的 1/256，列宽需要乘以 256 sheet.setColumnWidth(1, 12 * 256); sheet.setColumnWidth(2, 15 * 256); sheet.setColumnWidth(4, 20 * 256); // 创建第一行 HSSFRow row = sheet.createRow(0); // 设置当前行高 row.setHeightInPoints(20); //设置为居中加粗 HSSFCellStyle style = workbook.createCellStyle(); HSSFFont font = workbook.createFont(); // 粗体 font.setBold(true); // 设置居中 style.setAlignment(HorizontalAlignment.CENTER); style.setVerticalAlignment(VerticalAlignment.CENTER); style.setFont(font); // 设置列 HSSFCell cell; cell = row.createCell(0); cell.setCellValue(\"序号\"); cell.setCellStyle(style); cell = row.createCell(1); cell.setCellValue(\"ID\"); cell.setCellStyle(style); cell = row.createCell(2); cell.setCellValue(\"姓名\"); cell.setCellStyle(style); cell = row.createCell(3); cell.setCellValue(\"年龄\"); cell.setCellStyle(style); cell = row.createCell(4); cell.setCellValue(\"注册时间\"); cell.setCellStyle(style); HSSFCellStyle cellStyle = workbook.createCellStyle(); cellStyle.setAlignment(HorizontalAlignment.CENTER); cellStyle.setVerticalAlignment(VerticalAlignment.CENTER); int rowNum = 1; // 0为表头，从1开始记序号 for (User u : list) { HSSFRow r = sheet.createRow(rowNum); r.setHeightInPoints(20); HSSFCell c = r.createCell(0); c.setCellValue(rowNum); c.setCellStyle(cellStyle); c = r.createCell(1); c.setCellValue(u.getId()); c.setCellStyle(cellStyle); c = r.createCell(2); c.setCellValue(u.getName()); c.setCellStyle(cellStyle); c = r.createCell(3); c.setCellValue(u.getAge()); c.setCellStyle(cellStyle); c = r.createCell(4); c.setCellValue(DateUtil.formatDateTime(u.getCreateTime())); c.setCellStyle(cellStyle); rowNum++; } } © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"springboot/run.html":{"url":"springboot/run.html","title":"启动方式","keywords":"","body":"启动方式 jar包方式，直接启动 jar 相关脚本，linux，上传jar后可直接在项目根目录运行run.sh脚本 ├─ .jar # 项目jar包 ├─ run.sh # 运行脚本，上传jar后可直接运行该脚本 ├─ start.sh # 启动脚本 └─ stop.sh # 停用脚本 run.sh #!/bin/bash echo stop application source stop.sh echo start application source start.sh start.sh，如需配置远程调试，请参照 nohup java -Xms256m -Xmx256m -jar .jar >/dev/null 2>&1 & stop.sh #!/bin/bash PID=$(ps -ef | grep .jar | grep -v grep | awk '{ print $2 }') if [ -z \"$PID\" ] then echo Application is already stopped else echo kill -9 $PID kill -9 $PID fi © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"index/sql.html":{"url":"index/sql.html","title":"SQL","keywords":"","body":"SQL 部分sql语法、知识点总结 MySQL PostgreSQL © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"sql/mysql.html":{"url":"sql/mysql.html","title":"MySQL","keywords":"","body":"MySQL 1、根据日期获取周数 -- 按照周数统计，可能某年的最后一天为第一周，如：2019-12-30周数为第一周 SELECT WEEK (date_add('', INTERVAL 6 DAY), 2); /* 示例 SELECT WEEK (date_add('2019-12-30', INTERVAL 6 DAY), 2); */ 2、自增字段 一般用于表的自增id主键 -- 方法 1 -- 创建表的时候指定字段为自增 `` int(11) NOT NULL AUTO_INCREMENT COMMENT '字段注释' /* 示例 -- AUTO_INCREMENT=1参数表示从1开始自增 CREATE TABLE `t_goods` ( `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'id', `name` varchar(20) DEFAULT NULL, PRIMARY KEY (`id`) ) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8; */ -- 方法 2 ALTER TABLE ``.`` MODIFY COLUMN `` int(11) NOT NULL AUTO_INCREMENT COMMENT '' FIRST, AUTO_INCREMENT = ; /* 示例 ALTER TABLE `testdb`.`t_goods` MODIFY COLUMN `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'id' FIRST, AUTO_INCREMENT = 1; */ © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"sql/postgresql.html":{"url":"sql/postgresql.html","title":"PostgreSQL","keywords":"","body":"PostgreSQL 1、自增字段 一般用于表的自增id主键 -- 创建序列 -- 序列名：一般命名规则，__seq，如：t_goods_id_seq CREATE SEQUENCE \"public\".\"\" INCREMENT 1 MINVALUE 1 MAXVALUE 99999999999 START 1 CACHE 1; -- 修改序列所有者 -- 所有者：一般为该database用户 ALTER SEQUENCE \"public\".\"\" OWNER TO \"\"; /* 示例 CREATE SEQUENCE \"public\".\"t_goods_id_seq\" INCREMENT 1 MINVALUE 1 MAXVALUE 99999999999 START 1 CACHE 1; ALTER SEQUENCE \"public\".\"t_goods_id_seq\" OWNER TO \"test\"; */ -- 方法 1 -- 创建表的时候指定字段的默认值 \"\" int8 NOT NULL DEFAULT nextval(''::regclass) /* 示例 CREATE TABLE \"public\".\"t_goods\" ( \"id\" int8 NOT NULL DEFAULT nextval('t_goods_id_seq'::regclass), \"name\" varchar(20) COLLATE \"pg_catalog\".\"default\", CONSTRAINT \"t_goods_pkey\" PRIMARY KEY (\"id\") ); ALTER TABLE \"public\".\"t_goods\" OWNER TO \"test\"; COMMENT ON COLUMN \"public\".\"t_goods\".\"id\" IS 'id'; */ -- 方法 2 ALTER TABLE \"public\".\"\" ALTER COLUMN \"\" SET DEFAULT nextval(''::regclass); /* 示例 ALTER TABLE \"public\".\"t_goods\" ALTER COLUMN \"id\" SET DEFAULT nextval('t_goods_id_seq'::regclass); */ © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"index/git-svn.html":{"url":"index/git-svn.html","title":"Git/Svn","keywords":"","body":"Git Git使用过部分命令总结，详细可查看Git文档。 Git GitLab Svn © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"git-svn/git.html":{"url":"git-svn/git.html","title":"Git","keywords":"","body":"Git常用命令 需要提前下载安装Git客户端 使用配置 # 1、全局配置用户名 git config --global user.name '' # 2、全局配置邮箱 git config --global user.email '' # 3、生成密钥，与 步骤2 中邮箱相同 ssh-keygen -t rsa -C '' # (1) Enter file in which to save the key 第一次是密钥地址，输入直接回车 # (2) Enter passphrase 第二次输入是密码 # (3) Enter same passphrase again 第三次输入是确认密码 # 4、将生成的SSH公钥添加到GitLab或者GitHub或者码云等平台中 # (1) 登录之后在 用户设置页面 -> SSH密钥 # (2) 将 id_rsa.pub 中的公钥内容全部复制到 Key 文本域输入框（使用PuTTYgen生成私钥也添加到此处，PuTTYgen使用下面有介绍） # (3) 标题会自动生成也可以自行修改，添加密钥 # 5、开始使用 Git客户端工具SourcetreeC:\\Users\\\\AppData\\Local\\Atlassian\\SourceTree目录下创建accounts.json，内容如下 [ { \"$id\": \"1\", \"$type\": \"SourceTree.Api.Host.Identity.Model.IdentityAccount, SourceTree.Api.Host.Identity\", \"Authenticate\": true, \"HostInstance\": { \"$id\": \"2\", \"$type\": \"SourceTree.Host.Atlassianaccount.AtlassianAccountInstance, SourceTree.Host.AtlassianAccount\", \"Host\": { \"$id\": \"3\", \"$type\": \"SourceTree.Host.Atlassianaccount.AtlassianAccountHost, SourceTree.Host.AtlassianAccount\", \"Id\": \"atlassian account\" }, \"BaseUrl\": \"https://id.atlassian.com/\" }, \"Credentials\": { \"$id\": \"4\", \"$type\": \"SourceTree.Model.BasicAuthCredentials, SourceTree.Api.Account\", \"Username\": \"\", \"Email\": null }, \"IsDefault\": false } ] C:\\Users\\\\AppData\\Local\\Atlassian\\SourceTree.exe_Url_*****\\x.x.x.x\\user.config，在节点前添加以下内容 True 20160201 Git客户端工具TortoiseGit 使用PuTTYgen生成密钥 配置使用私钥使用，私钥文件为.ppk文件 常用操作 注意：git对文件名称大小写不敏感 ################## clone ################### # 克隆项目 git clone # 根据分支克隆 git clone -b ################### 提交 #################### # 查看状态 git status # 提交文件变化到暂存区 # 提交被修改(modified)和被删除(deleted)文件，不包括新文件(new) git add -u # 提交新文件(new)和被修改(modified)文件，不包括被删除(deleted)文件 git add . # 提交所有变化 git add -A # 提交文件至本地仓库区 git commit –m '' # 以下两条命令相同，合并操作，提交文件变化，提交本地仓库区，等价于 git add . 之后 git commit –m '' git commit –am '' git commit –a –m '' # 将本地版本库的分支推送到远程服务器 # git push git push origin master # 当只关联一个远程，只有一个分支时，可以使用 git push ################### 更新 #################### # 从远程主机的master分支拉取最新内容 git fetch origin master # 将拉取下来的最新内容合并到当前所在的分支中 git merge FETCH_HEAD # git pull :，等价于上面两步操作 git pull Github速度慢优化方法 获取github域名最快访问ip，https://github.com.ipaddress.com/ 添加到hosts文件 github.com global-ssl.fastly.Net github.global.ssl.fastly.net Linux下修改/etc/hosts文件，修改完后执行 # 在命令行中输入以下命令是hosts生效 sudo dscacheutil -flushcache Windows下修改 c:\\Windows\\System32\\drivers\\etc\\hosts文件，修改完后执行 # 在命令行中输入以下命令是hosts生效 ipconfig /flushdns 提交gh-pages分支以供展示 # _book为打包后的文件目录 git subtree push --prefix _book origin gh-pages 分支 # 显示所有参数使用方法 git branch -h # 查看所有分支，参数v显示版本号注释等附加信息，a显示所有 git branch -va # * 开头的为当前本地分支，origin为远程分支 # gh-pages 5c3cbe8 Create CNAME # * master 20575cc shouye # remotes/origin/HEAD -> origin/master # remotes/origin/gh-pages 5c3cbe8 Create CNAME # remotes/origin/master 20575cc shouye # remotes/origin/test 20575cc shouye # 创建分支 git branch # 提交分支到远程服务器 git push origin # 删除本地分支 git branch -d # 删除远程服务器分支 git push origin -d # 切换分支 git checkout # 创建并切换分支 git checkout -b git 回退版本 # 查看提交记录 git log #commit (HEAD -> master, origin/master) #Author: #Date: # # # #commit #Author: #Date: # # # 增加--pretty=oneline参数只显示commit id和commit message git log --pretty=oneline # (HEAD -> master, origin/master) # # 回退到指定commit id，这一步最好在当前代码 commit 之后操作，commit之后源代码可找回 git reset --hard # HEAD is now at xxxxxx commit # 已推送到远程仓库的代码回退后，需要强制推送到远程服务器，push时需要加--force git push origin HEAD --force # 回退被覆盖掉代码找回，查看操作记录，然后在使用 git reset --hard 找回 # 已推送到远程仓库的代码，回退被覆盖掉代码找回后，无需强制推送到远程服务器，push时不用加--force git reflog git 恢复工作区文件 # 查看更改的文件 git status # 如果add到暂存区需要reset，重置暂存区最近一次提交 # 如果已经commit，需要将文件回退到commit前 git reset HEAD # 恢复工作区文件 git checkout git log 状态下如何退出 # 方法 1 # 英文状态摁 q q # 方法 2 # git bash 可能无效 ctrl + c 统计贡献者代码行数 # --author=\"\" 为贡献者，$(git config --get user.email)表示当前用户账号 git log --author=\"$(git config --get user.email)\" --pretty=tformat: --numstat | gawk '{ add += $1; subs += $2; loc += $1 - $2 } END { printf \"增加的行数:%s 删除的行数:%s 总行数: %s\\n\", add, subs, loc }' © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-12-15 "},"git-svn/gitlab.html":{"url":"git-svn/gitlab.html","title":"GitLab","keywords":"","body":"GitLab 以Centos 7.4，GitLab 11.8.1 (ce社区版) 为例 安装 # 依赖，系统自带，可以忽略该步 #sudo yum install -y curl policycoreutils-python openssh-server # 在防火墙打开http和ssh访问 #sudo systemctl enable sshd #sudo systemctl start sshd #sudo firewall-cmd --permanent --add-service=http #sudo systemctl reload firewalld # 添加GitLab包存储库 # gitlab-ee企业版 # gitlab-ce社区版 curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | sudo bash # 安装GitLab包 yum install -y gitlab-ce 修改配置文件 # 修改配置文件 vim /etc/gitlab/gitlab.rb # 云服务器记得开放端口 # line.13，用户访问路径IP或域名 external_url 'http://gitlab.example.com:9876' # line.1021，默认nginx是80端口，防止冲突，和上面端口相同 nginx['listen_port'] = 9876 # line.677，默认端口8080，防止冲突 unicorn['port'] = 9875 # 发送邮件 # line.53 - 54 # 发件箱邮箱 gitlab_rails['gitlab_email_from'] = 'youemail@163.com' # 发件箱发件人姓名 gitlab_rails['gitlab_email_display_name'] = 'GitLab' # line.508 - 516，以163邮箱为例 gitlab_rails['smtp_enable'] = true gitlab_rails['smtp_address'] = \"smtp.163.com\" gitlab_rails['smtp_port'] = 465 # 云服务器记得开放465端口 gitlab_rails['smtp_user_name'] = \"youemail@163.com\" # 发件箱 gitlab_rails['smtp_password'] = \"stmp password\" # stmp密码 gitlab_rails['smtp_domain'] = \"163.com\" gitlab_rails['smtp_authentication'] = \"login\" gitlab_rails['smtp_enable_starttls_auto'] = true gitlab_rails['smtp_tls'] = true # 修改完配置后 # 重新装配 gitlab-ctl reconfigure # 重启服务 gitlab-ctl restart # 开机自动启动，/etc/rc.local中加入 vim /etc/rc.local gitlab-ctl start # 测试发送邮件 # 进入gitlab控制台 gitlab-rails console # 发送测试邮件 Notify.test_email('收件箱', '标题', '内容').deliver_now 运行 # 重新装配 gitlab-ctl reconfigure # 启动服务 gitlab-ctl start # 重启服务 gitlab-ctl restart # 停止服务 gitlab-ctl stop © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"git-svn/svn.html":{"url":"git-svn/svn.html","title":"Svn","keywords":"","body":"Svn 以Centos 7.4，Subversion 1.7.14 为例 安装 # 安装 yum install -y subversion # 查看版本 svnserve --version 配置 # subversion默认以/var/svn作为数据根目录 # 创建svn版本库目录 mkdir -p /opt/svn # 创建版本库 svnadmin create /opt/svn # 创建用户 vim /opt/svn/conf/passwd # 增加用户，格式：用户名 = 密码 [users] admin = admin guest = guest # 配置权限 vim /opt/svn/conf/authz # 格式：用户名 = 权限，r读取权限，w写入权限 [/] admin = rw guest = r # 最后设定snvserv.conf，使上面配置生效 vim /opt/svn/conf/svnserve.conf # 修改以下 anon-access = none # 使非授权用户无法访问 auth-access = write # 使授权用户有写权限 password-db = password authz-db = authz # 访问控制文件 realm = /opt/svn # 认证命名空间，subversion会在认证提示里显示，并且作为凭证缓存的关键字。 启动svn # 运行 svnserve -d -r /opt/svn # --listen-port指定端口 # vnserve -d -r /opt/svn --listen-port 3391 # 开机自动启动，/etc/rc.local中加入 vim /etc/rc.local svnserve -d -r /opt/svn Tips # windows系统，桌面右击菜单隐藏svn，强迫症专用 svn setting -> General -> Context Menu # 在Do not show the context menu for the following paths: # 加入桌面路径，如 D:\\users\\desktop © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"index/linux.html":{"url":"index/linux.html","title":"Linux","keywords":"","body":"Linux Linux系统下常用环境的安装以及相关配置，安装、配置、使用后总结。 命令行 yum JDK PHP Node.js Maven MySQL PostgreSQL 挂载硬盘 Nginx Tomcat Redis MongoDB Solr RabbitMQ ftp服务器 Jenkins 禅道 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/cmd.html":{"url":"linux/cmd.html","title":"命令行","keywords":"","body":"Linux命令行 用户操作 # 创建用户 useradd testuser # 设置密码，输入两遍密码即可 passwd testuser # 指定分组，如 root组 usermod -g root testuser # 设置用户root权限，修改sudoers文件可编辑 chmod -v u+w /etc/sudoers # 修改sudoers vim /etc/sudoers # line.101 增加以下内容，保存退出即可，NOPASSWD:标识不需要输入密码 #testuser ALL=(ALL) ALL testuser ALL=(ALL) NOPASSWD: ALL # 创建用户并指定登录主目录 useradd -d /www/testuser testuser # 设置密码，输入两遍密码即可 passwd testuser # 设置访问权限 chown -R testuser /www/testuser nohup后台执行命令 # nohup java -jar xxx.jar >/dev/null 2>&1 & # >/dev/null：/dev/null表示空设备文件，也可指定输出文件 # 2>&1：2表示错误输出（0：表示stdin标准输入，1：表示stdout标准输出），&1表示重定向为stdout标准输出 nohup >/dev/null 2>&1 & 查看端口占用 # 方式 1 lsof -i: # 方式 2 # -t (tcp) 仅显示tcp相关选项 # -u (udp) 仅显示udp相关选项 # -n 拒绝显示别名，能显示数字的全部转化为数字 # -l 仅列出在Listen(监听)的服务状态 # -p 显示建立相关链接的程序名 netstat -tunlp | grep 删除当前目录及其子目录下所有指定文件 # ./ 为当前目录及其子目录 # -type d 目标为文件夹 # -name \"\" 查找要删除的文件 # xargs rm -rf 执行删除 # 删除指定文件 find ./ -name \"\" | xargs rm -rf # 删除指定文件夹 find ./ -type d -name \"\" | xargs rm -rf # 如：删除所有.md文件 find ./ -name \"*.md\" | xargs rm -rf # 如：删除所有含有md的文件夹 find ./ -type d -name \"*md*\" | xargs rm -rf © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-12-04 "},"linux/yum.html":{"url":"linux/yum.html","title":"Yum","keywords":"","body":"yum 命令相关 yum，是Yellow dog Updater, Modified 的简称，是杜克大学为了提高RPM 软件包安装性而开发的一种软件包管理器。以Centos 7.4 为例 配置阿里源 # 备份原centos源 cd /etc/yum.repos.d mv CentOS-Base.repo CentOS-Base.repo_bk # 下载阿里源http://mirrors.aliyun.com/repo/Centos-7.repo # 重命名 # Centos-7.repo -> CentOS-Base.repo # 上传阿里源到/etc/yum.repos.d/ # 更新源 yum clean all yum makecache © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/jdk.html":{"url":"linux/jdk.html","title":"JDK","keywords":"","body":"Linux下JDK安装及配置 以Centos 7.4，JDK 1.8 为例 # 下载二进制压缩包https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html # jdk-8u201-linux-x64.tar.gz # 解压 tar -xzvf jdk-8u191-linux-x64.tar.gz # 修改profile vim /etc/profile # 最后面添加 export JAVA_HOME=/opt/jdk1.8.0_191 export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar export PATH=$PATH:$JAVA_HOME/bin # 重新初始化profile source /etc/profile # 查看配置结果 java -version © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/php.html":{"url":"linux/php.html","title":"PHP","keywords":"","body":"PHP（Linux环境下） 以Centos 7.4，PHP 7.1.x 为例 安装 # 配置源 rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm # 安装php71w和各种拓展 yum -y install php71w php71w-cli php71w-common php71w-devel php71w-embedded php71w-fpm php71w-gd php71w-mbstring php71w-mysqlnd php71w-opcache php71w-pdo php71w-xml # 测试 php -v 支持nginx HTTP服务 nginx linux环境安装，请参照 # 修改配置文件 vim /etc/php.ini # line.762 取消注释，修改为0 cgi.fix_pathinfo=0 # 启动fpm服务 /usr/sbin/php-fpm # 开机自动启动，/etc/rc.local中加入 vim /etc/rc.local /usr/sbin/php-fpm # nginx配置 location / { root html; index index.php index.html index.htm; } location ~* \\.php$ { fastcgi_index index.php; fastcgi_pass 127.0.0.1:9000; include fastcgi_params; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; fastcgi_param SCRIPT_NAME $fastcgi_script_name; } # 重启nginx nginx -s reload # 测试 rm /opt/nginx/html/index.html echo \"\" >> /opt/nginx/html/index.php # 使用浏览器打开，会显示 phpinfo() © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/nodejs.html":{"url":"linux/nodejs.html","title":"Node.js","keywords":"","body":"Node.js（Linux环境下） 以Centos 7.4，Node.js 10.15.3 二进制文件安装为例 安装 # 下载地址https://nodejs.org/en/download/ # 安装教程可参考https://github.com/nodejs/help/wiki/Installation # 定义node版本 VERSION=v10.15.0 # 定义系统版本 DISTRO=linux-x64 # 创建安装目录 sudo mkdir -p /usr/local/lib/nodejs # 解压到安装目录 sudo tar -xJvf node-$VERSION-$DISTRO.tar.xz -C /usr/local/lib/nodejs # 修改profile vim /etc/profile # 末尾加入以下内容 # Nodejs VERSION=10.15.3 VERSION=v DISTRO=linux-x64 export PATH=/usr/local/lib/nodejs/node-$VERSION-$DISTRO/bin:$PATH # 刷新profile source /etc/profile # 检查 node -v npm -v © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/maven.html":{"url":"linux/maven.html","title":"Maven","keywords":"","body":"Maven（Linux环境下） 以Centos 7.4，Maven 3.6.0 为例 安装 # 下载二进制文件压缩包http://mirrors.shu.edu.cn/apache/maven/maven-3/ # 或者直接下载然后通过ftp工具上传到服务器 wget http://mirrors.shu.edu.cn/apache/maven/maven-3/3.6.0/binaries/apache-maven-3.6.0-bin.tar.gz # 解压 tar -xzvf apache-maven-3.6.0-bin.tar.gz # 修改profile vim /etc/profile export M2_HOME=/opt/apache-maven-3.6.0 # 最后面添加 export PATH=$PATH:$JAVA_HOME/bin:$M2_HOME/bin # 修改PATH # 重新初始化profile source /etc/profile # 查看配置结果 mvn -v 配置 /conf/settings.xml ${user.home}/.m2/repository huaweicloud * https://mirrors.huaweicloud.com/repository/maven/ © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/mysql.html":{"url":"linux/mysql.html","title":"MySQL","keywords":"","body":"MySQL（Linux环境下） 以Centos 7.4，MySQL5.7.x为例 安装 # 1、查看已安装的mysql rpm -qa | grep -i mysql # 2、删除之前版本 yum -y remove 已安装的名称 # 如： yum -y remove mysql-community-client-5.6.38-2.el7.x86_64 # 3、更新源并安装 cd /opt wget https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm rpm -ivh mysql57-community-release-el7-11.noarch.rpm yum -y install mysql-server # 4、启动服务，必要的，不然不会生成/var/run/mysqld/mysqld.pid，导致其他错误 systemctl start mysqld 移动相关目录 移动data目录，log目录，相关操作（安装完需先启动mysql，生成数据库文件和log文件之后再进行移动操作） # 停止服务 systemctl stop mysqld # 创建目录 mkdir -p /opt/mysql/data/ # 修改属主和属组 chown -R mysql:mysql /opt/mysql/data # 复制mysql data目录 cp -a /var/lib/mysql /opt/mysql/data/ # 建立链接（如果更新data目录后无法，使用链接的方式） #ln -s /opt/mysql/data/mysql /usr/lib/mysql # 修改my.cfg vim /etc/my.cnf datadir=/opt/mysql/data/mysql # 复制mysql原有data目录可不修改此配置 #socket=/opt/mysql/data/mysql/mysql.sock # 创建目录 mkdir -p /opt/mysql/logs # 修改属主和属组 chown -R mysql:mysql /opt/mysql/logs # 移动log文件，-a带权限复制 cp -a /var/log/mysqld.log /opt/mysql/logs # 修改log目录 vim /etc/my.cnf server_id=1 expire_logs_days=10 log-error=/opt/mysql/logs/mysqld.log # 启动mysql systemctl start mysqld # 开启自动启动 systemctl enable mysqld 修改root密码 # 1、修改配置文件 vim /etc/my.cnf # 增加 skip-grant-tables # 2、重启mysql服务 systemctl restart mysqld # 3、进入mysq命令行 mysql -uroot # ERROR 2002 (HY000): Can’t connect to local MySQL server through socket ‘/var/lib/mysql/mysql.sock’ (2) #mysql -uroot -S /opt/mysql/data/mysql/mysql.sock # 4、执行sql use mysql; SET SQL_SAFE_UPDATES = 0; update mysql.user set authentication_string=password('root') where User='root'; flush privileges; SET SQL_SAFE_UPDATES = 1; # 5、修改配置文件 vim /etc/my.cnf # 去掉 skip-grant-tables # 6、重启mysql服务 systemctl restart mysqld # 7、使用新密码进入mysql mysql -uroot -p # 输入密码进入 修改mysql默认端口 # 1、修改配置文件 vim /etc/my.cnf # 2、在[mysqld]下增加 port= # 3、重启mysql服务 systemctl restart mysqld 修改mysql默认编码 # 1、修改配置文件 vim /etc/my.cnf # 2、增加 [client] default-character-set = utf8mb4 [mysqld] character-set-server=utf8mb4 collation-server=utf8mb4_unicode_ci [mysql] default-character-set = utf8mb4 # 3、重启mysql服务 systemctl restart mysqld 创建用户、数据库，授权数据库权限，远程连接 -- 1、创建用户名，%代表可以远程连接 use mysql; CREATE USER 'username'@'%' IDENTIFIED BY 'password'; -- 2、创建数据库并制定默认编码 create database testdb DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; -- 3、用户授权使用指定数据库的指定权限 GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON testdb.* TO 'username'@'%' IDENTIFIED BY 'password'; FLUSH PRIVILEGES; -- 删除用户，无需FLUSH PRIVILEGES; drop user 'username'@'%'; 常见错误 ERROR 1820 (HY000): You must reset your password using ALTER USER statement before executin -- 解决方法 -- 1、修改用户密码 set password=password(\"youpassword\"); -- 或者 alter user 'root'@'localhost' identified by 'youpassword'; -- 2、刷新权限 flush privileges; help contents; ERROR 1819 (HY000): Your password does not satisfy the current policy requirements # 密码强度太弱，建议字母大小写+数字+符号 [Err] 1055 - Expression #1 of ORDER BY clause is not in GROUP BY clause and contains nonaggregated column 'information_schema.PROFILING.SEQ' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by # 修改my.cnf vim /etc/my.cnf # 在[mysqld]添加以下配置 sql_mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION' # 重启mysql服务 systemctl restart mysqld Illegal mix of collations (utf8_general_ci,IMPLICIT) and (utf8mb4_general_ci,COERCIBLE) for operation xxx # 问题原因：emoji表情导致，MySQL 的 utf8 并不是真正的 utf8。 # 解决方法：可讲数据库 或者 数据表 或者 对应字段的编码改为utf8mb4， # 项目之初建议在数据库级别或者表级别设置编码，后期可以在对应字段修改编码。 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/pgsql.html":{"url":"linux/pgsql.html","title":"PostgreSQL","keywords":"","body":"PostgreSQL（Linux环境下） 以Centos 7.4，PostgreSQL11.x为例 安装 # 1、官网获取下载地址 # https://www.postgresql.org/download/linux/redhat/ # 2、安装存储库RPM yum install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm # 3、安装pgsql服务 yum install -y postgresql11 postgresql11-server # 4、初始化数据库 /usr/pgsql-11/bin/postgresql-11-setup initdb # 5、启动 systemctl start postgresql-11 # 6、设置自动启动 systemctl enable postgresql-11 # 7、设置postgres用户密码 # 删除原密码 sudo passwd -d postgres # 设置新密码 sudo -u postgres passwd 配置 # 1、修改配置 vim /var/lib/pgsql/11/data/postgresql.conf # 修改监听地址，允许远程访问 listen_addresses = '*' # line.59 # 修改端口，云服务器配置开放端口，默认端口：5432 port = 5432 # line.63 卸载 # 1、查询安装的包 rpm -qa | grep postgresql # 2、卸载，多个包，空格隔开 yum remove 创建数据库、用户 # 1、切换到postgres用户 su postgres # 2、启用sql shell psql -- 3、创建用户 CREATE USER WITH PASSWORD 'password'; -- 修改密码 ALTER USER WITH PASSWORD 'password'; -- 4、创建数据库 CREATE DATABASE ; -- 5、授权 GRANT ALL PRIVILEGES ON DATABASE TO ; # 6、返回shell \\q # 7、退出shell，切换回root用户 su root # 8、配置允许远程访问 vim /var/lib/pgsql/11/data/pg_hba.conf # 最末尾加入 # TYPE DATABASE USER ADDRESS METHOD host 0.0.0.0/0 md5 # 9、重启服务 systemctl restart postgresql-11 基本语法 # 查看所有数据库 \\l # 切换当前数据库 \\c # 查看当前数据库下所有表 \\d # 退出数据库返回shell \\q © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-12-04 "},"linux/mount.html":{"url":"linux/mount.html","title":"挂载硬盘","keywords":"","body":"Linux下永久挂载硬盘到指定目录 以Centos 7.4为例 # 1、查看可挂载硬盘 fdisk -l # 2、磁盘分区 fdisk /dev/vdb # 3、参数：输入 n， p， 1， 回车，回车， wq # 4、格式化硬盘 mkfs.ext4 /dev/vdb1 # 5、挂载到指定目录 mount /dev/vdb1 /opt # 6、写入分区表（自动挂载） echo '/dev/vdb1 /opt ext4 defaults 0 0' >> /etc/fstab # 7、查看挂载结果 df -h © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/nginx.html":{"url":"linux/nginx.html","title":"Nginx","keywords":"","body":"Nginx（Linux环境下） 以Centos 7.4，Nginx 1.15.8为例 安装 # 1、编译依赖 yum -y install gcc gcc-c++ # 2、nginx依赖 yum -y install zlib zlib-devel openssl openssl-devel pcre pcre-devel # 3、下载 解压nginx-1.15.8.tar.gz tar -xzvf nginx-1.15.8.tar.gz # 4、创建nginx用户 useradd -s /bin/false -M nginx # 5、编译 cd nginx-1.15.8 # 生成makefile，指定用户、组、安装路径、相关模块 ./configure --user=nginx --group=nginx --prefix=/opt/nginx-1.15.8-01/ --with-http_v2_module --with-http_ssl_module --with-http_sub_module --with-http_stub_status_module --with-http_gzip_static_module --with-pcre # 6、编译安装 make && make install # 7、创建nginx命令软链接到环境变量 ln -s /opt/nginx-1.15.8-01/sbin/* /usr/local/sbin/ # 开机自动启动，/etc/rc.local中加入 vim /etc/rc.local nginx location相关 # location表达式类型 ~ 表示执行一个正则匹配，区分大小写 ~* 表示执行一个正则匹配，不区分大小写 ^~ 表示普通字符匹配。使用前缀匹配。如果匹配成功，则不再匹配其他location。 = 进行普通字符精确匹配。也就是完全匹配。 @ 它定义一个命名的 location，使用在内部定向时，例如 error_page, try_files # location优先级 (location =) > (location 完整路径) > (location ^~ 路径) > (location ~,~* 正则顺序) > (location 部分起始路径) > (/) # 1、等号类型（=）的优先级最高。一旦匹配成功，则不再查找其他匹配项。 # 2、^~类型表达式。一旦匹配成功，则不再查找其他匹配项。 # 3、正则表达式类型（~ ~*）的优先级次之。如果有多个location的正则能匹配的话，则使用正则表达式最长的那个。 # 4、常规字符串匹配类型。按前缀匹配。 配置SSL（https） # 安装时--with-http_ssl_module，添加ssl模块 http { server { listen 443 ssl; # 此处加ssl参数，可以不用使用ssl on配置 server_name www.xxx.com; # 域名 #ssl on; ssl_certificate /opt/ssl/xxx.pem; # crt / pem 文件 ssl_certificate_key /opt/ssl/xxx.key; # key ssl_session_timeout 5m; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_prefer_server_ciphers on; location / { root html; index index.html index.htm; } } server { listen 80; server_name xxx.com www.xxx.com; rewrite ^(.*) https://$host$1 permanent; } } 接口代理跨域 http { server { location /api/ { # host 修改为真实的域名和端口 proxy_set_header Host $http_host; proxy_pass http://192.168.0.12:8080/api/; } # ^~ 表示以某前缀开头 location ^~ /admin/ { # host 修改为真实的域名和端口 proxy_set_header Host $http_host; proxy_pass http://admin; } } } HTML5 History模式 解决URL无法匹配到静态资源的问题，如：非根目录刷新原理：rewrite到index.html中，然后交给路由在处理请求资源 # 方法 1 http{ server{ location /path { root html; index index.html index.htm; if (!-e $request_filename) { rewrite ^/(.*) /path/index.html last; break; } } } } # 方法 2 http{ server{ location /path { root html; index index.html index.htm; try_files $uri $uri/ @router; } location @router { rewrite ^.*$ /path/index.html last; } } } 请求相关配置 可在http、server或location中设置，优先级location > server > http client_max_body_size：限制请求体的大小，若超过所设定的大小，返回413错误client_header_timeout：读取请求头的超时时间，若超过所设定的大小，返回408错误client_body_timeout：读取请求实体的超时时间，若超过所设定的大小，返回413错误proxy_connect_timeout：http请求无法立即被容器(tomcat, netty等)处理，被放在nginx的待处理池中等待被处理。此参数为等待的最长时间，默认为60秒，官方推荐最长不要超过75秒proxy_read_timeout：http请求被容器(tomcat, netty等)处理后，nginx会等待处理结果，也就是容器返回的response。此参数即为服务器响应时间，默认60秒proxy_send_timeout：http请求被服务器处理完后，把数据传返回给Nginx的用时，默认60秒 http{ server{ location a { client_max_body_size 10m; } } } 跨域配置 可在http、server或location中设置，优先级location > server > httpadd_header Access-Control-Allow-Methods 'PUT,POST,GET,DELETE,OPTIONS';：指定允许跨域的方法，*代表所有add_header Access-Control-Max-Age 3600;：预检命令的缓存，如果不缓存每次会发送两次请求add_header Access-Control-Allow-Credentials true;：带cookie请求需要加上这个字段，并设置为trueadd_header Access-Control-Allow-Origin $http_origin;：表示允许这个域跨域调用（客户端发送请求的域名和端口），$http_origin动态获取请求客户端请求的域 不用*的原因是带cookie的请求不支持*号add_header Access-Control-Allow-Headers $http_access_control_request_headers;：表示请求头的字段 动态获取if ($request_method = 'OPTIONS') { return 200; }：检查请求的类型是不是预检命令 http{ server{ location a { add_header Access-Control-Allow-Methods 'PUT,POST,GET,DELETE,OPTIONS'; add_header Access-Control-Max-Age 3600; add_header Access-Control-Allow-Credentials true; add_header Access-Control-Allow-Origin $http_origin; add_header Access-Control-Allow-Headers $http_access_control_request_headers; if ($request_method = 'OPTIONS'){ return 200; } } } } 负载均衡 tomcat 为例反向代理 负载均衡后获取客户端真实IP html { # 添加tomcat列表，真实应用服务器都放在这 upstream tomcat_pool { # server tomcat地址:端口号 weight表示权值，权值越大，被分配的几率越大; server 192.168.0.223:8080 weight=4 max_fails=2 fail_timeout=30s; server 192.168.0.224:8080 weight=4 max_fails=2 fail_timeout=30s; } server { # 默认请求设置 location / { # host 修改为真实的域名和端口 proxy_set_header Host $http_host; proxy_pass http://tomcat_pool; # 转向tomcat处理 proxy_cookie_domain domino_server nginx_server; # 解决反向代理后Cookie不一致的问题 } # 带有基础路径请求设置 location ^~ /api/ { # host 修改为真实的域名和端口 proxy_set_header Host $http_host; # 客户端真实ip proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; # 客户端真实协议(http/https) proxy_set_header X-Forwarded-Proto $scheme; # 负载均衡upstream proxy_pass http://tomcat_pool/api/; # 转向tomcat处理 proxy_cookie_domain domino_server nginx_server; # 解决反向代理后Cookie不一致的问题 } } } 负载均衡后获取客户端真实IP，java代码 // 负载均衡后获取客户端真实IP地址 public String getClientIp(HttpServletRequest request) { String ip = request.getHeader(\"x-forwarded-for\"); if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) { ip = request.getHeader(\"Proxy-Client-IP\"); } if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) { ip = request.getHeader(\"WL-Proxy-Client-IP\"); } if (ip == null || ip.length() == 0 || \"unknown\".equalsIgnoreCase(ip)) { ip = request.getRemoteAddr(); } if(ip.trim().contains(\",\")){ // 为什么会有这一步，因为经过多层代理后会有多个代理，取第一个ip地址就可以了 String [] ips = ip.split(\",\"); ip = ips[0]; } return ip; } gzip http { # gzip模块设置 gzip on; # 开启gzip压缩输出 gzip_min_length 1k; # 最小压缩文件大小 gzip_buffers 4 16k; # 压缩缓冲区 gzip_http_version 1.1; # 用了反向代理的话，末端通信是HTTP/1.0，默认是HTTP/1.1 gzip_comp_level 2; # 压缩等级 gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png; # 压缩类型 gzip_vary off; # 跟Squid等缓存服务有关，on的话会在Header里增加\"Vary: Accept-Encoding\" gzip_disable \"MSIE [1-6]\\.\"; # ie6不压缩 } 修改nginx.conf、html位置 # 修改nginx.conf位置 # 移动nginx.conf mv /opt/nginx-1.15.8-01/conf/nginx.conf /opt/ # 创建软连接 ln -s /opt/nginx.conf /opt/nginx-1.15.8-01/conf/nginx.conf/ # 修改html位置 # 创建目录 mkdir /opt/nginx-app # 修改配置文件 vim /opt/nginx.conf # 顶部加入 user root; html { server { location / { root /opt/nginx-app; } } } # 重启服务 nginx -s reload © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2021-01-11 "},"linux/tomcat.html":{"url":"linux/tomcat.html","title":"Tomcat","keywords":"","body":"Tomcat（Linux环境下） 以Centos 7.4，Tomcat 8.5.43为例 常用配置修改 # {tomcat-path}/config/server.xml 代表了运行在上的单个Web应用 一个可以有多个元素，每个Web应用必须有唯一的URL路径 这个URL路径在中的属性path中设定。 --> 的appBase属性的相对路径 如果Web应用采用开放目录结构，则指定Web应用的根目录 如果Web应用是个war文件，则指定war文件的路径。 --> © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/redis.html":{"url":"linux/redis.html","title":"Redis","keywords":"","body":"Redis（Linux环境下） 以Centos 7.4，redis 5.0.x 为例 安装 # 下载压缩包https://redis.io/download # /opt/redis-5.0.4.tar.gz cd /opt # 解压 tar -xzvf redis-5.0.4.tar.gz # 编译 cd /opt/redis-5.0.4 make # 安装 cd /opt/redis-5.0.4/src make install PREFIX=/usr/local/redis # 复制配置文件到安装目录 cp -a /opt/redis-5.0.4/redis.conf /usr/local/redis # 修改配置 vim /usr/local/redis/redis.conf bind 127.0.0.1 # line.69 注释掉 port # line.92 修改默认端口 daemonize yes # line.136 守护进程 yes requirepass # line.507 设置密码 maxmemory # line.566 可使用最大内存，单位字节（bytes） notify-keyspace-events Ex # line.1066 键空间通知，过期事件的监听 # 创建软连接 ln -s /usr/local/redis/bin/* /usr/local/sbin/ # 启动服务 redis-server /usr/local/redis/redis.conf # 开机自动启动，/etc/rc.local中加入 vim /etc/rc.local redis-server /usr/local/redis/redis.conf 测试连接 # 无密码 redis-cli # 有密码 redis-cli -a '' > ping pong © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/mongodb.html":{"url":"linux/mongodb.html","title":"MongoDB","keywords":"","body":"MongoDB 下载安装 MongoDB官网 -> On-Premises -> MongoDB Community Server选择 版本（4.4.0）、平台（CentOS 7.0）、包（tgz），具体可根据需要选择获取 tgz 压缩包下载链接并下载 # 解压 tar -xzvf mongodb-linux-x86_64-rhel70-4.4.0.tgz # 移动到/usr/local/下 mv /opt/mongodb-linux-x86_64-rhel70-4.4.0 /usr/local/mongodb4 # 修改/etc/profile vim /etc/profile # 添加 export MONGODB_HOME=/usr/local/mongodb4 export PATH=PATH:{MONGODB_HOME}/bin # 刷新/etc/profile source /etc/profile # 在mongodb/bin目录下添加mongodb.conf cd /usr/local/mongodb4/bin vim mongodb.conf # 添加以下内容 # mongodb 配置文件 # 端口，默认27017 port=27017 # IP，默认127.0.0.1 bind_ip=0.0.0.0 # 数据库存放 dbpath=/var/lib/mongodb/data # 日志文件 logpath=/var/lib/mongodb/logs/mongodb.log # 错误日志采用追加模式，配置这个选项后mongodb的日志会追加到现有的日志文件，而不是从新创建一个新文件 logappend=true # 启用日志文件，默认启用 journal=true # 这个选项可以过滤掉一些无用的日志信息，若需要调试使用请设置为false quiet=true # 设置后台运行 fork=true # 开启认证 auth=true # 创建数据库目录和日志文件目录 mkdir -p /var/lib/mongodb/data mkdir -p /var/lib/mongodb/logs # 启动 /usr/local/mongodb4/bin/mongod -f /usr/local/mongodb4/bin/mongodb.conf # 关闭 /usr/local/mongodb4/bin/mongod -shutdown -dbpath=/var/lib/mongodb/data 创建数据库、用户 # 启用mongo /usr/local/mongodb4/bin/mongo # 选择admin库 use admin # 创建admin用户 db.createUser({user:\"admin\",pwd:\"\",roles:[{role:\"userAdminAnyDatabase\",db:\"admin\"}]}) # 用户的验证，返回1表示成功 db.auth(\"admin\", \"\") # 使用use创建数据库 use test # 创建用户 # db.createUser({user:\"\",pwd:\"\",roles:[{role:\"\",db:\"\"}]}) db.createUser({user:\"test\",pwd:\"password\",roles:[{role:\"dbOwner\",db:\"test\"}]}) © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/solr.html":{"url":"linux/solr.html","title":"Solr","keywords":"","body":"Solr（Linux环境下） 以Centos 7.4，solr 8.1 为例 安装 # 下载压缩包http://lucene.apache.org/solr/mirrors-solr-latest-redir.html # /opt/solr-8.1.0.tgz cd /opt # 解压 tar -xzvf solr-8.1.0.tgz # 创建core cd /opt/solr-8.1.0/server/solr/configsets cp -r _default ../ mv _default # 创建软连接 ln -s /opt/solr-8.1.0/bin/solr /usr/local/sbin/ # 启动服务 start：启动服务；stop：停止服务；restart：重启服务 -p 自定义端口 -m 内存 solr start -p 8398 -force -m 1g # 开机自动启动，/etc/rc.local中加入 vim /etc/rc.local solr start -p 8398 -force -m 1g 使用 基本使用 # 访问 http://:8398/solr # 菜单 -> Core Admin # 添加core，名字为上一步文件夹名（core name） 添加hanlp中文分词器，分词插件 # https://github.com/hankcs/hanlp-lucene-plugin # 下载jar包hanlp-portable-1.7.3.jar、hanlp-lucene-plugin-1.1.6.jar # 添加jar包到 cd /opt/solr-8.1.0/server/solr-webapp/webapp/WEB-INF/lib # 修改配置文件 cd /opt/solr-8.1.0/server/solr//conf vim managed-schema # 末尾标签内增加相关配置 --> # 重启solr服务 solr restart -p 8398 -force -m 1g 相关问题 # *** [WARN] *** Your Max Processes Limit is currently 7270. # It should be set to 65000 to avoid operational disruption. # If you no longer wish to see this warning, set SOLR_ULIMIT_CHECKS to false in your profile or solr.in.sh # WARNING: Starting Solr as the root user is a security risk and not considered best practice. Exiting. # Please consult the Reference Guide. To override this check, start with argument '-force' # 启动时后面加参数-force solr start -p 8398 -force -m 1g © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/rabbitmq.html":{"url":"linux/rabbitmq.html","title":"RabbitMQ","keywords":"","body":"RabbitMQ安装 下载安装 下载并安装 erlang 依赖 erlang-18.1-1.el7.centos.x86_64.rpm下载并安装 socat 依赖下载rabbitmq-server 服务 rabbitmq-server-3.6.15-1.el7.noarch.rpm # 在linux下直接执行命令命令 wget https://www.rabbitmq.com/releases/erlang/erlang-18.3.4.4-1.el7.centos.x86_64.rpm wget http://repo.iotti.biz/CentOS/7/x86_64/socat-1.7.3.2-5.el7.lux.x86_64.rpm wget https://www.rabbitmq.com/releases/rabbitmq-server/v3.6.15/rabbitmq-server-3.6.15-1.el7.noarch.rpm # 按顺序安装rpm包 yum -y install erlang-18.3.4.4-1.el7.centos.x86_64.rpm yum -y install socat-1.7.3.2-5.el7.lux.x86_64.rpm yum -y install rabbitmq-server-3.6.15-1.el7.noarch.rpm 配置 # 将配置文件复制到/etc/rabbitmq/下 cp -a /usr/share/doc/rabbitmq-server-3.6.15/rabbitmq.config.example /etc/rabbitmq/ # 重命名配置文件 cd /etc/rabbitmq/ mv rabbitmq.config.example rabbitmq.config # 启用rabbitmq的管理平台插件，会在/etc/rabbitmq 目录下多出一个 enabled_plugins cd /etc/rabbitmq/ rabbitmq-plugins enable rabbitmq_management # 启动 rabbitmq-server start # 后台启动，无法使用rabbitmq-server stop停止，直接kill进行 rabbitmq-server -detached # 停止 rabbitmq-server stop # 开机自动启动 chkconfig rabbitmq-server on 用户管理 # 需在rabbitmq-server启动状态下操作 # 添加用户 # rabbitmqctl add_user rabbitmqctl add_user admin admin # 设置权限，可以远程访问 # rabbitmqctl set_permissions -p \"/\" \".*\" \".*\" \".*\" rabbitmqctl set_permissions -p \"/\" admin \".*\" \".*\" \".*\" # 设置角色tags # rabbitmqctl set_user_tags rabbitmqctl set_user_tags admin administrator # 查看用户列表 rabbitmqctl list_users # 查看用户权限 rabbitmqctl list_permissions -p / # 删除用户 # rabbitmqctl delete_user rabbitmqctl delete_user admin © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/ftp.html":{"url":"linux/ftp.html","title":"ftp服务器","keywords":"","body":"FTP服务器（Linux环境下） 以Centos 7.4 为例 安装 # 查询是否安装vsftpd rpm -qa | grep vsftpd # 安装 yum install -y vsftpd # 创建ftp主目录 #mkdir /opt/www # 创建ftp用户 useradd -d /opt/www -m ftpuser # 设置新用户密码 passwd ftpuser # 更改用户权限 usermod -s /sbin/nologin ftpuser # 限定用户ftpuser不能telnet，只能ftp # usermod -s /sbin/bash ftpuser # 用户ftpuser恢复正常 # usermod -d /opt/www ftpuser # 更改用户ftpuser的主目录为/opt/www # 文件授权给ftp用户 chown -R ftpuser /opt/www # 进入vsftpd目录 cd /etc/vsftpd # 创建chroot_list并写入ftp用户 echo 'ftpuser' > chroot_list # 在user_list中加入ftp用户 vim /etc/vsftpd/user_list # 修改配置文件 vim /etc/vsftpd/vsftpd.conf anonymous_enable=NO # line.12 禁止匿名用户 chroot_local_user=YES # line.101 chroot_list_enable=NO # line.102 禁止chroot_list中用户切换目录 chroot_list_file=/etc/vsftpd/chroot_list # line.104 定义不能更改用户主目录的文件，该文件需自己创建，默认被注释 listen=YES # line.115 监听ipv4 listen_ipv6=NO # line.124 不监听ipv6 userlist_enable=YES # line.127 启用白名单 userlist_deny=NO # line.128 禁用黑名单 local_root=/opt/www # 新增，ftp根目录 pasv_max_port=5510 # 新增，被动端口 pasv_min_port=5500 # 新增，被动端口 allow_writeable_chroot=YES # 新增，支持chroot_list中的用户write权限 # 启动服务器 systemctl start vsftpd # 开机自动启的 systemctl enable vsftpd 相关问题 云服务器设置安全组后需要开放相关接口 # 20 - 22 # 被动端口 5500 - 5510 331 Please specify the password. # 可能性较大的原因是密码强度太低，不影响登录 500 OOPS: cannot change directory:/opt/www/images # 原因，文件权限导致 # 只设置了images目录的ftp的用户权限，需要设置www的用户权限 cd /opt chown -R ftpuser www/ cd /opt/www chown -R ftpuser images/ # 特殊情况！如果与ftpuser同一用户组用户test也需要访问/opt/www，需要给www文件夹设置权限 chmod 770 www 530 Login incorrect. # 确认密码正确的情况下报530 vim /etc/pam.d/vsftpd # 注释掉以下两行 #%PAM-1.0 session optional pam_keyinit.so force revoke #auth required pam_listfile.so item=user sense=deny file=/etc/vsftpd/ftpusers onerr=succeed #auth required pam_shells.so auth include password-auth account include password-auth session required pam_loginuid.so session include password-auth # 重启服务 systemctl restart vsftpd SFTP服务器 # 创建用户组 groupadd sftp # 创建用户，指定用户组，限定只能ftp登录 useradd -d /opt/www -g sftp -s /sbin/nologin sftpuser # 设置密码 passwd sftpuser # 修改ssh配置文件 vim /etc/ssh/sshd_config # 注释掉 X11Forwarding yes # line.102 Subsystem sftp /usr/libexec/openssh/sftp-server # line.102 # 在sshd_config末尾添加 Subsystem sftp internal-sftp Match Group sftp ChrootDirectory /opt/www/ ForceCommand internal-sftp AllowTcpForwarding no X11Forwarding no # 设置文件权限 # ChrootDirectory /opt/www 目录所有者必须为root，设置sftp用户组 # /opt/www 及 /opt/www/assets 目录权限不能超过755 chown -R root:sftp /opt/www chmod -R 755 /opt/www cd /opt/www mkdir assets chown -R sftpuser:sftp /opt/www/assets chmod -R 755 /opt/www/assets # 重启ssh服务 systemctl restart sshd 上传尺寸限制、静态资源访问跨域问题 请点击此处参照Springboot 相关配置 # 设置servlet最大请求尺寸 spring.servlet.multipart.max-request-size = 10MB # 设置servlet最大文件上传尺寸 spring.servlet.multipart.max-file-size = 10MB © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2021-01-11 "},"linux/jenkins.html":{"url":"linux/jenkins.html","title":"Jenkins","keywords":"","body":"Jenkins安装 Jenkins安装前需先安装JDK，可参照JDK安装及配置 安装 方式1，推荐 # 添加yum源 sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo # 导入密钥 sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key # 安装 sudo yum install -y jenkins 方式2，下载离线安装包安装 以Centos 7.4 为例，下载jenkins-2.150.3-1.1.noarch.rpm rpm -ih jenkins-2.150.3-1.1.noarch.rpm 修改java目录 vim /etc/init.d/jenkins # 大约75行，添加java目录 candidates=\" /opt/jdk1.8.0_191/bin/java ... \" # 保存后运行一下命令，重新加载 systemctl daemon-reload # 启动 systemctl start jenkins 开机启动 # 由于Jenkins不是Native Service，所以需要用chkconfig命令而不是systemctl命令 sudo /sbin/chkconfig jenkins on 修改默认端口号 vim /etc/sysconfig/jenkins # 大约56行，将默认端口8080修改即可 JENKINS_PORT=\"8765\" # 重启服务 systemctl restart jenkins © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"linux/zentao.html":{"url":"linux/zentao.html","title":"禅道","keywords":"","body":"禅道安装（Linux环境下） 以Centos 7.4，ZenTaoPMS.11.4.1 为例需要提前安装以下依赖，可点击链接参考 nginx，mysql，php # nginx中新建项目根目录html_zen_tao（和html同级） # 配置nginx.conf server { listen 8888; server_name 140.143.232.110; location / { root html_zen_tao; index index.php index.html index.htm; } location ~* \\.php$ { fastcgi_index index.php; fastcgi_pass 127.0.0.1:9000; include fastcgi_params; # fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; # 自定义项目根目录后需用绝对路径方式配置SCRIPT_FILENAME # 否则访问php文件会显示 No input file specified. fastcgi_param SCRIPT_FILENAME /opt/nginx/html_zen_tao/$fastcgi_script_name; fastcgi_param SCRIPT_NAME $fastcgi_script_name; } } # 下载禅道项目管理软件源码 https://www.zentao.net/download/80131.html # ZenTaoPMS.11.4.1.zip # 解压到html_zen_tao unzip ZenTaoPMS.11.4.1.zip # 通过IP地址访问http://IP:PORT/zentaopms/www/index.php # 根据提示进行安装 常见问题 PDO扩展、PDO_MySQL扩展、MBSTRING扩展 未加载 # 修改配置文件 vim /etc/php.ini # line.725，修改并添加 extension_dir = \"/usr/lib64/php/modules\" extension=pdo_mysqlnd.so extension=mbstring.so extension=pdo.so # 重启php-fpm ps aux | grep php-fpm kill -9 xxxx # 你懂得 /usr/sbin/php-fpm © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"index/windows.html":{"url":"index/windows.html","title":"Windows","keywords":"","body":"Windows DOS © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"windows/dos.html":{"url":"windows/dos.html","title":"DOS","keywords":"","body":"DOS命令行 删除所有指定文件 :: 删除当前目录下所有具有的文件，包括下级目录 :: del /f/s/q \"\" :: 如：所有.md的文件 del /f/s/q \"*.md\" 使用WinSCP上传文件到Linux系统 1、WinSCP下载地址2、安装后需将winscp.exe的所在目录配置到环境变量3、创建运行脚本upload.txt option confirm off open username:password@host put C:\\test\\a.zip /home/test/a.zip close exit 4、运行脚本upload.bat winscp.exe /console /script=upload.txt /log=log.txt 执行upload.bat会自动上传，初次会有登录提示，英文输入法状态下输入Y即可。注意：1、用户名、密码不能出现特殊符号；2、权限问题可参照。 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"index/ide.html":{"url":"index/ide.html","title":"开发工具","keywords":"","body":"开发工具 常用开发工具配置、插件等。 VSCode IDEA EditorConfig © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"ide/vscode.html":{"url":"ide/vscode.html","title":"VSCode","keywords":"","body":"VSCode 配置 { \"breadcrumbs.enabled\": false, \"dart.debugExternalLibraries\": true, \"dart.debugSdkLibraries\": false, \"diffEditor.ignoreTrimWhitespace\": false, \"editor.minimap.enabled\": true, \"editor.fontSize\": 17, \"editor.formatOnPaste\": true, \"editor.multiCursorModifier\": \"ctrlCmd\", \"editor.snippetSuggestions\": \"top\", \"editor.tabSize\": 2, \"emmet.includeLanguages\": { \"wxml\": \"html\" }, \"eslint.validate\": [\"javascript\", \"javascriptreact\", \"typescript\", \"typescriptreact\", \"vue\", \"html\"], \"explorer.autoReveal\": false, \"files.associations\": { \"*.cjson\": \"jsonc\", \"*.wxss\": \"css\", \"*.wxs\": \"javascript\" }, \"javascript.implicitProjectConfig.experimentalDecorators\": true, \"minapp-vscode.disableAutoConfig\": true, \"terminal.integrated.fontSize\": 17, \"terminal.integrated.shell.windows\": \"C:\\\\Program Files\\\\Git\\\\bin\\\\bash.exe\", \"update.enableWindowsBackgroundUpdates\": false, \"update.mode\": \"none\", \"vsicons.dontShowNewVersionMessage\": true, \"vetur.validation.template\": true, \"workbench.colorTheme\": \"Monokai\", \"workbench.iconTheme\": \"vscode-icons\", \"workbench.startupEditor\": \"newUntitledFile\", \"workbench.sideBar.location\": \"left\", \"window.zoomLevel\": 0 } 常用插件 # 中文 Chinese (Simplified) Language Pack for Visual Studio Code # 编辑器代码格式化 EditorConfig for VS Code # js格式校验 ESLint # git忽略 gitignore # 路径自动补全 Path Intellisense # sublime键位 Sublime Text Keymap # 资源管理器图标 vscode-icons # () [] {} 匹配高亮区分 Bracket Pair Colorizer 2 # markdown文件预览 Markdown Preview Enhanced # svn SVN # vue Vetur # react Simple React Snippets # css预编译stylus language-stylus # flutter开发插件，自动安装dart插件 Flutter # flutter 模版 Flutter Widget Snippets # px2rem.rootFontSize 默认设计稿宽750px，默认使用iphone7 设备宽375px 开发，按照index.js[x]中的rem自适应计算方法为 50 # 详细配置查看该插件说明 px2rem 部分快捷键配置 # 1、代码提示 # 原快捷键 Ctrl + space，与系统冲突，修改即可 # 文件 -> 首选项 -> 键盘快捷方式，搜索“触发建议”，修改为 Alt + / ，按enter键保存即可 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2021-02-19 "},"ide/idea.html":{"url":"ide/idea.html","title":"IDEA","keywords":"","body":"IDEA 远程调试 jar包方式启动java项目，可以使用idea进行远程调试1、远程服务器启动项目2、IDEA run Debug 3、IDEA 断点调试 nohup java -Xms256m -Xmx256m -jar -Xdebug -Xrunjdwp:transport=dt_socket,suspend=n,server=y,address= .jar >/dev/null 2>&1 & # IDEA 设置 run -> Edit Configurations -> + -> Remote Name: Host: Port: 常用插件 File -> Settings -> Plugins # 社区版Spring支持 Spring Assistant # Flutter相关，自动安装Dart Flutter # JRebel IDEA上热部署 JRebel and XRebel for IntelliJ # 破解 # 1、生成GUID：https://www.guidgen.com/ # 2、Help -> JRebel -> Activation -> Team URL分别填写 https://jrebel.qekang.com/ # 3、 勾选协议，Activate JRebel # 4、next enable JRebel -> I agree # 5、重启IDEA，JRebel setup guide按照提示操作 # Mybatis扩展支持 Free Mybatis plugin 常用设置 路径等配置 # 字体及大小 File -> Settings -> Editor -> Font Font: Consolas Size: 16 Line Spacing: 1.2 # Maven，使用本地Maven File -> Settings -> Build, Execution, Deployment -> Build Tools -> Maven Maven home directory: User settings file: # JDK设置，一般系统会自动设置，无需手动设置 File -> Settings -> Build, Execution, Deployment -> Build Tools -> Maven -> Runner JRE: # Flutter SDK路径设置，配置后，Dart会自动配置 File -> Settings -> Languages & Frameworks -> Flutter Flutter SDK path: # 关闭Idea版本自动更新 File -> Settings -> Appearance & Behavior -> System Settings -> Updates # 关闭启动后自动打开项目 File -> Settings -> Appearance & Behavior -> System Settings # 取消代码重复提示 File -> Settings -> Editor -> Inspections -> General -> Duplicated Code # 注释模版，java方法 File -> Settings -> Editor -> Live Templates 1、右侧 + 选择 Template Group 填写名字 2、右侧 + 选择 Live Template 3、设置 （1）Abbreviation: （2）Description: （3）Template text: * * $target$ $param$ * @return $return$ */ （4）下方Applicable相关: （5）Expand with: （6）Edit variables: param: groovyScript(\"def result=''; def params=\\\"${_1}\\\".replaceAll('[\\\\\\\\[|\\\\\\\\]|\\\\\\\\s]', '').split(',').toList(); for(i = 0; i Settings -> Editor -> File and Code Templates 1、选中Files -> Class 2、选择Includes -> File Header /** * ${ClassName} * @author * @since ${YEAR}-${MONTH}-${DAY} ${HOUR}:${MINUTE}:00 */ 快捷键 # 代码补全，Eclipse中Alt + / File -> Settings -> Keymap -> Main menu -> Code -> Code Completion # 删除占用 Cyclic Expand Word: Cyclic Expand Word (Backward): # 添加 Basic: © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"ide/editorconfig.html":{"url":"ide/editorconfig.html","title":"EditorConfig","keywords":"","body":"EditorConfig 项目根目录中添加.editorconfig文件，并在开发工具中安装相应插件，如：VSCode安装EditorConfig for Visual Studio Code # editorconfig.org root = true [*] indent_style = space indent_size = 2 end_of_line = lf charset = utf-8 trim_trailing_whitespace = true insert_final_newline = true # markdown文件不去掉结尾空格 [*.md] trim_trailing_whitespace = false © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"index/markdown.html":{"url":"index/markdown.html","title":"MarkDown","keywords":"","body":"MarkDown MarkDown部分语法。 转义字符 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"markdown/ascii.html":{"url":"markdown/ascii.html","title":"转义字符","keywords":"","body":"转义字符 ASCII转义字符 结果 描述 实体编号 space &#32; ! exclamation mark &#33; \" quotation mark &#34; # number sign &#35; $ dollar sign &#36; % percent sign &#37; & ampersand &#38; ' apostrophe &#39; ( left parenthesis &#40; ) right parenthesis &#41; * asterisk &#42; + plus sign &#43; , comma &#44; - hyphen &#45; . period &#46; / slash &#47; 0 digit 0 &#48; 1 digit 1 &#49; 2 digit 2 &#50; 3 digit 3 &#51; 4 digit 4 &#52; 5 digit 5 &#53; 6 digit 6 &#54; 7 digit 7 &#55; 8 digit 8 &#56; 9 digit 9 &#57; : colon &#58; ; semicolon &#59; less-than &#60; = equals-to &#61; > greater-than &#62; ? question mark &#63; @ at sign &#64; A uppercase A &#65; B uppercase B &#66; C uppercase C &#67; D uppercase D &#68; E uppercase E &#69; F uppercase F &#70; G uppercase G &#71; H uppercase H &#72; I uppercase I &#73; J uppercase J &#74; K uppercase K &#75; L uppercase L &#76; M uppercase M &#77; N uppercase N &#78; O uppercase O &#79; P uppercase P &#80; Q uppercase Q &#81; R uppercase R &#82; S uppercase S &#83; T uppercase T &#84; U uppercase U &#85; V uppercase V &#86; W uppercase W &#87; X uppercase X &#88; Y uppercase Y &#89; Z uppercase Z &#90; [ left square bracket &#91; \\ backslash &#92; ] right square bracket &#93; ^ caret &#94; _ underscore &#95; ` grave accent &#96; a lowercase a &#97; b lowercase b &#98; c lowercase c &#99; d lowercase d &#100; e lowercase e &#101; f lowercase f &#102; g lowercase g &#103; h lowercase h &#104; i lowercase i &#105; j lowercase j &#106; k lowercase k &#107; l lowercase l &#108; m lowercase m &#109; n lowercase n &#110; o lowercase o &#111; p lowercase p &#112; q lowercase q &#113; r lowercase r &#114; s lowercase s &#115; t lowercase t &#116; u lowercase u &#117; v lowercase v &#118; w lowercase w &#119; x lowercase x &#120; y lowercase y &#121; z lowercase z &#122; { left curly brace &#123; | vertical bar &#124; } right curly brace &#125; ~ tilde &#126; © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"index/others.html":{"url":"index/others.html","title":"其它","keywords":"","body":"其它 操作系统 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"others/sys.html":{"url":"others/sys.html","title":"操作系统","keywords":"","body":"操作系统 iso系统镜像 CentOS系统镜像下载请点击Windows系统镜像下载请点击 iso镜像校验 # 使用Windows下certutil工具，打开命令提示符使用以下命令 # Windows iso镜像需要SHA1 # CentOS iso镜像需要SHA256 certutil -hashfile MD5 certutil -hashfile SHA1 certutil -hashfile SHA256 使用Rufus创建USB安装盘 Rufus下载地址请点击 CentOS USB安装盘示例 Windows USB安装盘示例 CentOS安装 1、进入CentOS安装界面，按TAB键进入配置编辑（根据提示，uefi是按E键）2、将配置改为vmlinuz initrd=initrd.img inst.stage2=hd......quiet改为vmlinuz initrd=initrd.img linux dd quiet3、修改之后回车系统会进入磁盘设备列表，查看U盘的设备名，记住设备名（如下图所示，如：sdb4）4、按CTRL + ALT + DEL重启，进入安装界面5、按TAB编辑配置，改为vmlinuz initrd=initrd.img inst.stage2=hd:/dev/sdb4 quiet6、sdb4对应U盘的设备名，然后按回车进入图形安装界面 Windows安装 注意：DELL ChengMing3980 8代CPU，系统应为：UEFI+GPT+WIN10 Windows10删除3D对象 注册表中删除{0DB7E03F-FC29-4DC6-9020-FF41B59E513A} 计算机\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer\\NameSpace 计算机\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer\\Namespace © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "},"index/collection.html":{"url":"index/collection.html","title":"文章收藏","keywords":"","body":"文章收藏 文档 [JavaScript] ES6 入门教程[JavaScript] MDN[JavaScript] 现代 JavaScript 教程[JavaScript] 30 秒就能理解的 JavaScript 代码片段 前端 Html [GitHub] HTML 面试知识点总结 JavaScript [掘金] JavaScript 那些写出来会被同事揍的骚操作[掘金] 移动端300ms延迟以及点击穿透[掘金] 由浅入深，66条JavaScript面试知识点[掘金] 吊打 JavaScript 之从原型到原型链[掘金] (查缺补漏)送你 54 道 JavaScript 面试题[掘金] 从Vue源码中学到的28个编程好习惯[掘金] 这些前端基础题你能答对几道？(测试你的基础掌握,附答案解析)[掘金] [建议👍]再来100道JS输出题酸爽继续（共1.8W字+巩固JS基础）[掘金] [诚意满满✍]带你填一些JS容易出错的坑[掘金] 你不知道的 WebSocket[掘金] 「一劳永逸」送你21道高频JavaScript手写面试题[掘金] [译] 你不知道的 console 命令[掘金] 编写高质量可维护的代码之优化逻辑判断[GitHub] JavaScript 面试知识点总结[掘金] 进阶必读：深入理解 JavaScript 原型[掘金] Javascript中常用的13种设计模式[掘金] 「多图预警」那些年，被blob虐过的程序猿觉醒了！[开源中国] 基于vue的h5文件切片上传（获取文件md5，实现秒传、进度条实现） CSS [掘金] 一篇全面的CSS布局学习指南 [译][掘金] 一文梳理CSS必会知识点[掘金] CSS Viewport 单位，很多人还不知道使用它来快速布局！[掘金] 你可能不知道的Animation动画技巧与细节[掘金] 每天一个小技巧：纯CSS实现瀑布流（Masonry）[掘金] 每天一个小技巧：变形汉堡按钮（Hamburger Menu）[掘金] 每天一个小技巧：CSS clip-path 的妙用[掘金] 【收藏】你不知道的css技巧[掘金] 令人头疼的skew()倾斜函数之我见[掘金] 『真香警告』这33个超级好用的CSS选择器，你可能见都没见过。[掘金] css篇--100道近两万字帮你巩固css知识点[掘金] 最强大的 CSS 布局 —— Grid 布局[阮一峰] Flex 布局教程：语法篇[阮一峰] CSS Grid 网格布局教程[GitHub] CSS 面试知识点总结[Others] You-need-to-know-css[掘金] CSS 奇思妙想边框动画[掘金] 灵活运用CSS开发技巧 TypeScript [掘金] 你可能不知道的 TypeScript 高级技巧[掘金] 一份不可多得的 TS 学习指南（1.8W字） Vue [掘金] 揭秘 Vue.js 九个性能优化技巧[掘金] 史上最强vue总结---面试开发全靠它了[掘金] 实战技巧，Vue原来还可以这样写[掘金] 前方高能，这是最新的一波Vue实战技巧，不用则已，一用惊人[掘金] 10个简单的技巧让你的 vue.js 代码更优雅🍊[掘金] 一万字教你怎么用 Vue[掘金] 一个合格的中级前端工程师应该掌握的 20 个 Vue 技巧 其它 [掘金] 1.4万字 | 玩转前端 Video 播放器[掘金] 「查缺补漏」送你18道浏览器面试题[掘金] 14期-连肝7个晚上，总结了计算机网络的知识点！（共66条）[掘金] 脱离996，Chrome DevTools 面板全攻略！！！[掘金] 那些前端开发必不可少的生产力工具[SegmentFault 思否] 关于移动端适配，你必须要知道的[掘金] 前端10个灵魂拷问 吃透这些你就能摆脱初级前端工程师！[掘金] 「查缺补漏」巩固你的HTTP知识体系[掘金] 「一劳永逸」由浅入深配置webpack4[掘金] 前端一键自动部署工具🛠[GitHub] 算法知识总结[GitHub] 计算机网络知识总结[GitHub] 半小时搞懂 HTTP、HTTPS和HTTP2[掘金] 整理一批正在学、正在看、正在用，前端工具[掘金] 拯救你的年底KPI：前端性能优化[掘金] 中高级前端必须注意的40条移动端H5坑位指南 | 网易三年实践 微信开发 公众号 [SegmentFault 思否] vue使用微信JS-SDK实现分享功能 Flutter [掘金] flutter好用的轮子推荐一-列表动画[掘金] flutter好用的轮子推荐二-点赞按钮动画[掘金] flutter好用的轮子推荐三-超强轮播图Swiper[掘金] flutter好用的轮子推荐四-可定制的图片预览查看器photo_view[掘金] flutter好用的轮子推荐五-列表左右滑动带出按钮选项[掘金] flutter好用的轮子推荐六-超好用的全局toast （ 同类型组件fluttertoast ）[掘金] flutter好用的轮子推荐七-flutter圆形或线型进度条[掘金] flutter好用的轮子推荐八-flutter一个超酷动画的底部tab栏[掘金] flutter好用的轮子推荐九-flutter可定制的上下滑出抽屉[掘金] flutter好用的轮子推荐十-flutter拖动排序元素[掘金] flutter好用的轮子推荐十一-flutter文字动效组件[掘金] flutter好用的轮子推荐十二-flutter一个全屏动效的抽屉组件[掘金] flutter好用的轮子推荐十三-flutter可展开选项的浮动按钮[掘金] flutter好用的轮子推荐十四-flutter将widget裁剪成各种自定义形状[掘金] flutter好用的轮子推荐十五-flutter给滚动内容添加粘性header组件[掘金] flutter好用的轮子推荐十六-flutter可自定义的评分组件[掘金] flutter好用的轮子推荐十七-flutter可翻转的卡片组件[掘金] flutter好用的轮子推荐十八-flutter液体效果的页面切换组件[掘金] flutter好用的轮子推荐十九-flutter水波效果的进度器[掘金] flutter好用的轮子推荐二十一-flutter制作刮刮卡效果[掘金] Flutter Candies 一桶天下[掘金] flutter开发之Dart[必读篇]💯 Git [掘金] 三年 Git 使用心得 & 常见问题整理[掘金] 「一劳永逸」一张脑图带你掌握Git命令 SQL MySQL [掘金] MySQL的四种事务隔离级别 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2021-02-19 "},"index/delicious.html":{"url":"index/delicious.html","title":" ","keywords":"","body":"A magic page! var container = document.getElementsByClassName('body-inner')[0] container.style.overflow = 'hidden' document.getElementById('a-magic-page').ondblclick = function () { container.style.overflow = '' } 吕座酸菜鱼秘籍 鱼的选择酸菜鱼主要用草鱼和黑鱼两种（推荐后者）；草鱼便宜并且肉质鲜嫩，但是刺多；黑鱼没有毛刺，肉质紧实； 酸菜包的选择一般选用海底捞或者好人家； 配料葱、姜、蒜、花椒、盐、料酒、白胡椒、淀粉、鸡蛋清； 鱼的处理1、将鱼肉和鱼骨分离，鱼肉切薄片；2、用腌鱼料包腌制鱼片，约20分钟（没有料包就手动：盐、胡椒粉、淀粉、鸡蛋清）；3、鱼头和鱼骨放料酒腌制； 制作1、起锅烧油，推荐使用花生油，放鱼头和鱼骨煎炒，三分钟后加入葱姜蒜爆香，然后加入酸菜煸炒，加入料酒；2、加入开水约1200毫升，烧开后煮5~8分钟，汤色泛白酸菜出味，加入调味料（可用料包的，或者自己加盐也可以），再煮三分钟；3、将鱼骨和酸菜捞出至盆中备用，锅内留汤；4、将鱼片下入汤锅，滑1分钟（开锅即可）；5、将鱼片和汤倒盆中，然后把花椒、蒜末或者蒜苗放在鱼片上面；6、烧一勺油，稍微冒烟，浇到花椒、蒜苗上面，即制作完成； PS喜欢吃配菜，可以焯点豆芽放在锅底。 © 2020 www.wdg.pub all right reserved，powered by Gitbook该文件修订时间： 2020-11-23 "}}